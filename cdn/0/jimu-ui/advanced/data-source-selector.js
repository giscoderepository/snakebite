System.register(["jimu-core","jimu-ui","jimu-ui/basic/item-selector","jimu-arcgis","jimu-layouts/layout-runtime","jimu-core/data-source"],(function(e){var t,n,a,o,r,s;return{setters:[function(e){t=e},function(e){n=e},function(e){a=e},function(e){o=e},function(e){r=e},function(e){s=e}],execute:function(){e(function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=963)}({0:function(e,n){e.exports=t},1:function(e,t){e.exports=n},101:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7 1a6 6 0 100 12A6 6 0 007 1zm0 13a7 7 0 115.621-2.828l-.222.284 3.405 3.404a.668.668 0 01-.944.944L11.456 12.4A6.974 6.974 0 017 14z" fill="#000" fill-rule="evenodd"></path></svg>'},105:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M5.5 5.5v-5a.5.5 0 011 0v5h5a.5.5 0 010 1h-5v5a.5.5 0 01-1 0v-5h-5a.5.5 0 010-1h5z" fill="#000" fill-rule="nonzero"></path></svg>'},117:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M8.5 0a.5.5 0 01.5.5V1h2a1 1 0 011 1v9a1 1 0 01-1 1H1a1 1 0 01-1-1V2a1 1 0 011-1h2V.5a.5.5 0 011 0V1h4V.5a.5.5 0 01.5-.5zM11 5H1v6h10V5zM8.5 8.5a.5.5 0 010 1h-5a.5.5 0 010-1h5zm0-2a.5.5 0 010 1h-5a.5.5 0 010-1h5zM3 2H1v2h10V2H9v.5a.5.5 0 01-1 0V2H4v.5a.5.5 0 01-1 0V2z" fill="#000" fill-rule="nonzero"></path></svg>'},126:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M6 0a6 6 0 110 12A6 6 0 016 0zm0 1a5 5 0 100 10A5 5 0 006 1zm4 4.5v1H2v-1h8z" fill="#000" fill-rule="nonzero"></path></svg>'},127:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M6 0a6 6 0 110 12A6 6 0 016 0zm0 1a5 5 0 100 10A5 5 0 006 1zm.5 1v3.5H10v1H6.5V10h-1V6.5H2v-1h3.5V2h1z" fill="#000" fill-rule="nonzero"></path></svg>'},128:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M7.185 0c.105 0 .195.118.232.24l.013.062.245 1.567c.294.145.588.29.85.465l.19.138 1.53-.603c.154-.05.264-.016.332.031l.036.03 1.224 2.11c.051.1.06.201-.01.302l-.05.06-1.286 1.025c.061.181.061.362.061.603 0 .181-.034.328-.052.467l-.01.136 1.409.965c.105.052.12.192.083.307l-.022.055-1.224 2.11c-.053.104-.195.163-.312.14l-.056-.019-1.53-.603a4.796 4.796 0 01-.82.494l-.22.109-.245 1.568c0 .103-.135.207-.25.234L7.246 12H4.798c-.157 0-.27-.089-.298-.19l-.253-1.619c-.293-.145-.587-.29-.85-.465l-.19-.138-1.53.603c-.153.05-.264.017-.332-.03l-.036-.03L.085 8.02c-.05-.101-.06-.202.01-.302l.051-.06 1.286-1.026c-.061-.18-.061-.362-.061-.603 0-.18.034-.328.051-.466l.01-.137-1.286-.965c-.104-.103-.164-.25-.14-.329L1.247 1.99c.102-.1.204-.16.342-.141l.087.02 1.469.603.419-.281c.135-.09.268-.17.407-.236l.214-.086.245-1.628c0-.103.135-.207.25-.234L4.738 0h2.448zm-.658 1h-1.2l-.243 1.627-.586.192a1.42 1.42 0 00-.3.154l-.503.335-.441.29-1.439-.593-.59 1.017 1.207.905v.5c0 .088-.003.147-.013.228l-.044.31a.577.577 0 00-.004.065l.005.26.005.027.223.66L1.258 8.05l.581 1.001 1.536-.604.45.356c.162.126.334.226.712.416l.618.304.23 1.476h1.274l.23-1.476.751-.371c.206-.106.342-.182.453-.258l.126-.091.451-.356 1.506.595.587-1.01-1.272-.872v-.607l.009-.117.048-.341.003-.035v-.18l-.003-.098-.004-.034-.225-.665 1.345-1.073-.581-1.002-1.535.605-.451-.355-.126-.092a5.312 5.312 0 00-.59-.326l-.614-.303L6.527 1zM6 3.75a2.25 2.25 0 110 4.5 2.25 2.25 0 010-4.5zm0 1a1.25 1.25 0 100 2.5 1.25 1.25 0 000-2.5z" fill="#000" fill-rule="nonzero"></path></svg>'},13:function(e,t){e.exports=a},14:function(e,t){e.exports=o},167:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M6 11.943l4 1.711V4.057L6 2.346v9.597zm-1 .17V2.494l-4 1.48v9.619l4-1.48zm6 1.393l4-1.48V2.407l-4 1.48v9.619zM0 15V3.307L5.75 1.18l4.528 1.937L16 1v11.693l-5.75 2.127-4.528-1.937L0 15z" fill="#000" fill-rule="nonzero"></path></svg>'},168:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7.5 4V1.39C6.402 2.12 5.565 2.99 4.985 4H7.5zm0 3.5V5H4.512a8.13 8.13 0 00-.5 2.5H7.5zm0 3.5V8.5H4.012a8.13 8.13 0 00.5 2.5H7.5zm0 3.61V12H4.985c.58 1.01 1.417 1.88 2.515 2.61zm2.543.087A7.014 7.014 0 0013.745 12h-1.6a8.278 8.278 0 01-2.102 2.697zM11.015 12H8.5v2.61c1.098-.73 1.935-1.6 2.515-2.61zm1.974-3.5a9.328 9.328 0 01-.441 2.5h1.778c.365-.767.594-1.61.656-2.5H12.99zm-1.001 0H8.5V11h2.988a8.13 8.13 0 00.5-2.5zm.56-3.5c.254.775.401 1.609.441 2.5h1.993a6.957 6.957 0 00-.656-2.5h-1.778zm-1.06 0H8.5v2.5h3.488a8.13 8.13 0 00-.5-2.5zm-1.445-3.697c.91.78 1.611 1.68 2.102 2.697h1.6a7.014 7.014 0 00-3.702-2.697zM8.5 4h2.515c-.58-1.01-1.417-1.88-2.515-2.61V4zm-.527 12a8 8 0 11.055-16 8 8 0 01-.055 16zM5.957 1.302A7.014 7.014 0 002.255 4h1.6a8.278 8.278 0 012.102-2.697zM3.011 7.5c.04-.891.187-1.725.441-2.5H1.674a6.957 6.957 0 00-.656 2.5H3.01zm.441 3.5a9.328 9.328 0 01-.441-2.5H1.018c.062.89.291 1.733.656 2.5h1.778zm2.505 3.697A8.278 8.278 0 013.855 12h-1.6a7.014 7.014 0 003.702 2.697z" fill="#000" fill-rule="nonzero"></path></svg>'},169:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0l8 6-8 6-8-6 8-6zM1.887 6L8 10.82 14.113 6 8 1.18 1.887 6zM.563 9L8 14.775 15.437 9l.563.81L8 16 0 9.81.563 9z" fill="#000" fill-rule="nonzero"></path></svg>'},170:function(e,t){e.exports='<svg viewBox="0 0 12 8" xmlns="http://www.w3.org/2000/svg"><path d="M6 5.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3zm0 1a2.5 2.5 0 110-5 2.5 2.5 0 010 5zM6 1c-2.124 0-3.714.967-4.867 3C2.286 6.033 3.876 7 6 7s3.714-.967 4.867-3C9.714 1.967 8.124 1 6 1zm0 7C3.333 8 1.333 6.667 0 4c1.333-2.667 3.333-4 6-4s4.667 1.333 6 4c-1.333 2.667-3.333 4-6 4z"></path></svg>'},171:function(e,t){e.exports='<svg viewBox="0 0 12 10" xmlns="http://www.w3.org/2000/svg"><path d="M6.62 6.366L4.635 4.379a1.5 1.5 0 001.987 1.987zm.746-.745a1.5 1.5 0 00-1.987-1.987l1.987 1.987zM3.899 3.644l-.825-.825C2.322 3.314 1.678 4.038 1.133 5 2.286 7.033 3.876 8 6 8c.702 0 1.345-.106 1.934-.32L7.356 7.1A2.5 2.5 0 013.9 3.645zm.745-.745A2.5 2.5 0 018.1 6.355l.826.826c.752-.495 1.396-1.219 1.941-2.181C9.714 2.967 8.124 2 6 2c-.702 0-1.345.106-1.934.32l.578.579zM2.354 2.1L1.155.9A.527.527 0 011.9.154l1.4 1.4C4.107 1.184 5.008 1 6 1c2.667 0 4.667 1.333 6 4-.634 1.268-1.419 2.235-2.355 2.9l1.2 1.2a.527.527 0 01-.745.746l-1.4-1.4C7.893 8.816 6.992 9 6 9 3.333 9 1.333 7.667 0 5c.634-1.268 1.419-2.235 2.355-2.9z"></path></svg>'},172:function(e,t){e.exports='<svg viewBox="0 0 80 71" xmlns="http://www.w3.org/2000/svg"><path d="M63.86 24a4 4 0 013.327 1.781l12.141 18.211a4 4 0 01.672 2.22V67a4 4 0 01-4 4H4a4 4 0 01-4-4V46.211a4 4 0 01.672-2.219l12.14-18.21A4 4 0 0116.142 24h47.718zm0 4H16.14L4.808 44.999H29a2 2 0 012 2V47c0 .687.077 1.357.223 2l-27.224-.001L4 67h72l-.001-18.001H48.777A9.03 9.03 0 0049 47a2 2 0 012-2.001h23.585L63.859 28zM31.222 49a9.003 9.003 0 0017.554 0h4.07C51.885 55.23 46.499 60 40 60c-6.5 0-11.885-4.77-12.847-11h4.07zm36.42-42.128a2.5 2.5 0 01.307 3.522l-7.07 8.426a2.5 2.5 0 01-3.83-3.214l7.07-8.426a2.5 2.5 0 013.522-.308zM15.88 7.18l7.07 8.426a2.5 2.5 0 01-3.83 3.214l-7.07-8.426a2.5 2.5 0 013.83-3.214zM40 0a2.5 2.5 0 012.5 2.5v14a2.5 2.5 0 11-5 0v-14A2.5 2.5 0 0140 0z" fill="#6A6A6A" fill-rule="evenodd"></path></svg>'},252:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M1.5 16a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm0-13a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm13 13a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm0-13a1.5 1.5 0 110-3 1.5 1.5 0 010 3zM8 9.5a1.5 1.5 0 110-3 1.5 1.5 0 010 3z" fill-rule="nonzero"></path></svg>'},253:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2.147 13.146l11-11a1.5 1.5 0 11.707.707l-11 11a1.5 1.5 0 11-.707-.707z" fill-rule="nonzero"></path></svg>'},254:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2.915 14h10.17c.05-.14.12-.271.207-.389l-2.204-4.114a1.5 1.5 0 110-2.995l2.204-4.113A1.496 1.496 0 0113.085 2H2.915c-.151.426-.489.764-.915.915v10.17c.426.151.764.489.915.915zm0 1A1.5 1.5 0 111 13.085V2.915A1.5 1.5 0 112.915 1h10.17a1.5 1.5 0 111.276 1.994l-2.272 3.975a1.495 1.495 0 010 2.063l2.272 3.974A1.5 1.5 0 1113.086 15H2.914z" fill-rule="nonzero"></path></svg>'},255:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M0 11V1h12v10H0zm1-.833l2-.001V9H1v1.167zM7 9H4v1.166h3V9zm4 0H8v1.166h3V9zm0-1V7H8v1h3zM1 8h2V7H1v1zm6-1H4v1h3V7zm4-1V5H8v1h3zM1 6h2V5H1v1zm6-1H4v1h3V5zm4-3.167H1V4h10V1.833z" fill="#000" fill-rule="nonzero"></path></svg>'},256:function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 9l-2-9H2L0 9l.36.087c2.18.507 3.893.547 5.14.121V11H2v1h8v-1H6.5V8.792c1.315-.45 3.148-.38 5.5.208zM2.802 1h6.395l1.489 6.701-.227-.037c-2.03-.316-3.662-.18-4.906.442l-.159.073c-.926.394-2.309.433-4.14.077l-.062-.013L2.802 1zM6 2H5v3H3v1h2v1h1V4h3V3H6V2z" fill="#000"></path></svg>'},257:function(e,t){e.exports='<svg viewBox="0 0 13 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.5 0l2 9c-2.352-.588-4.185-.657-5.5-.208V11h3.5v1h-8v-1H6V9.208c-1.247.426-2.96.386-5.14-.121L.5 9l2-9h8zM8.87 1H3.505c.084.58.207 1.325.61 1.991.294.486.75.95 1.503 1.253.257-.828.9-1.543 1.56-2.098C7.72 1.69 8.323 1.302 8.87 1zm.966.625l1.144 5.15a5.006 5.006 0 00-.988-.9c-.868-.614-2.063-1.143-3.408-1.368.177-.53.62-1.077 1.238-1.596a10.147 10.147 0 012.014-1.286zM3.26 3.51a4.578 4.578 0 01-.354-.727L1.692 8.243l.062.013c1.831.356 3.214.317 4.14-.077l.159-.073c1.113-.557 2.538-.724 4.28-.527a1.968 1.968 0 00-.077-.108 3.856 3.856 0 00-.842-.78c-.746-.528-1.8-.998-2.996-1.198C4.776 5.22 3.815 4.427 3.26 3.51z" fill="#000"></path></svg>'},258:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M12 0v12H0V0h12zm-1 1H1v10h3L1 9l3-2 3 2-3 2h7V1zM4 8.202L2.803 9 4 9.797 5.196 9 4 8.202zM8 4l3 2-3 2-3-2 3-2zm0 1.202L6.803 6 8 6.797 9.196 6 8 5.202zM4 1l3 2-3 2-3-2 3-2zm0 1.202L2.803 3 4 3.797 5.196 3 4 2.202z" fill="#000" fill-rule="nonzero"></path></svg>'},259:function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 9l-2-9H2L0 9l.36.087c2.18.507 3.893.547 5.14.121V11H2v1h8v-1H6.5V8.792c1.315-.45 3.148-.38 5.5.208zM2.802 1h6.395l1.489 6.701-.227-.037c-2.03-.316-3.662-.18-4.906.442l-.159.073c-.926.394-2.309.433-4.14.077l-.062-.013L2.802 1zM4 3.78V6h2V3.28l-2 .5zm2-1.53L3 3v4h6V4H7V2l-1 .25zM8 6H7V5h1v1z" fill="#000"></path></svg>'},260:function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6 1H1v10h5V1zM1 0H0v12h12V5H7V0H1zm6 6v5h4V6H7zM2 2h3v1H2V2zm3 2H2v1h3V4zm3 3h2v1H8V7zm2 2H8v1h2V9zM2 6h3v1H2V6z" fill="#000"></path></svg>'},261:function(e,t){e.exports='<svg viewBox="0 0 14 16" xmlns="http://www.w3.org/2000/svg"><path d="M1 5.304V6.5C1 7.692 3.615 9 7 9s6-1.308 6-2.5V5.304C11.775 6.32 9.546 7 7 7s-4.775-.68-6-1.696zM14 3.5v9c0 1.933-3.134 3.5-7 3.5s-7-1.567-7-3.5v-9C0 1.567 3.134 0 7 0s7 1.567 7 3.5zm-1 4.804C11.775 9.32 9.546 10 7 10s-4.775-.68-6-1.696V9.5C1 10.692 3.615 12 7 12s6-1.308 6-2.5V8.304zm0 3C11.775 12.32 9.546 13 7 13s-4.775-.68-6-1.696V12.5C1 13.692 3.615 15 7 15s6-1.308 6-2.5v-1.196zM7 6c3.385 0 6-1.308 6-2.5S10.385 1 7 1 1 2.308 1 3.5 3.615 6 7 6z" fill="#000" fill-rule="nonzero"></path></svg>'},262:function(e,t){e.exports='<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zm0 2C4.477 20 0 15.523 0 10S4.477 0 10 0s10 4.477 10 10-4.477 10-10 10zm8.282-1.718a.961.961 0 011.359 0l4.077 4.077a.961.961 0 01-1.359 1.36l-4.077-4.078a.961.961 0 010-1.36z" fill="#000" fill-rule="nonzero"></path></svg>'},263:function(e,t){e.exports='<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13.462 12l10.235 10.235a1.034 1.034 0 11-1.462 1.462L12 13.462 1.765 23.697a1.034 1.034 0 11-1.462-1.462L10.538 12 .303 1.765A1.034 1.034 0 111.765.303L12 10.538 22.235.303a1.034 1.034 0 111.462 1.462L13.462 12z" fill="#000" fill-rule="nonzero"></path></svg>'},264:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M6.262 6.972l-.893-.893a.5.5 0 010-.707l.003-.003a.5.5 0 01.707 0l.893.893.709-.709a1.003 1.003 0 000-1.419L4.844 1.297a1.003 1.003 0 00-1.419 0L1.297 3.425a1.003 1.003 0 000 1.419L4.134 7.68a1.003 1.003 0 001.419 0l.71-.71zm1.419 0l1.347 1.347.71-.71a2.006 2.006 0 012.837 0l2.837 2.838a2.006 2.006 0 010 2.837l-2.128 2.128a2.006 2.006 0 01-2.837 0L7.61 12.575a2.006 2.006 0 010-2.837l.709-.71-1.347-1.347-.71.71a2.006 2.006 0 01-2.837 0L.588 5.552a2.006 2.006 0 010-2.837L2.716.588a2.006 2.006 0 012.837 0L8.39 3.425a2.006 2.006 0 010 2.837l-.709.71zm2.057 2.056l.599.6a.5.5 0 010 .707l-.002.002a.5.5 0 01-.707 0l-.6-.6-.709.71a1.003 1.003 0 000 1.419l2.837 2.837a1.003 1.003 0 001.419 0l2.128-2.128a1.003 1.003 0 000-1.419L11.866 8.32a1.003 1.003 0 00-1.419 0l-.71.71z" fill="#000" fill-rule="nonzero"></path></svg>'},265:function(e,t){e.exports='<svg viewBox="0 0 8 8" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 3.5v-3a.5.5 0 011 0v3h3a.5.5 0 010 1h-3v3a.5.5 0 01-1 0v-3h-3a.5.5 0 010-1h3z" fill-rule="evenodd"></path></svg>'},266:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 3h11a1 1 0 011 1v11a1 1 0 01-1 1H4a1 1 0 01-1-1V4a1 1 0 011-1zm0 1v11h11V4H4zm-4 7.5V1a1 1 0 011-1h9.5a.5.5 0 010 1H1v10.5a.5.5 0 01-1 0z" fill-rule="nonzero"></path></svg>'},267:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M9 6V2.333C9 .939 10.408 0 12 0h8c1.592 0 3 .939 3 2.333V6h8a1 1 0 010 2h-3l-1.858 22.153A2 2 0 0124.148 32H7.852a2 2 0 01-1.994-1.847L4 8H1a1 1 0 010-2h8zm2 0h10V2c0-.078-10-.078-10 0v4zM6.006 8l1.846 22h16.296l1.846-22H6.006zM13 12a1 1 0 011 1v12a1 1 0 01-2 0V13a1 1 0 011-1zm6 0a1 1 0 011 1v12a1 1 0 01-2 0V13a1 1 0 011-1z"></path></svg>'},268:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M9.5 6.25a1.25 1.25 0 112.5 0 1.25 1.25 0 01-2.5 0zm-4.75 0a1.25 1.25 0 112.5 0 1.25 1.25 0 01-2.5 0zM0 6.25a1.25 1.25 0 112.5 0 1.25 1.25 0 01-2.5 0z" fill="#000"></path><path d="M0 0h12v12H0z"></path></g></svg>'},269:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M11 0v6h-1V1H1v10h5v1H0V0h11zM8.5 6a2.5 2.5 0 012.099 3.859l1.248 1.25a.522.522 0 11-.739.738l-1.25-1.248A2.5 2.5 0 118.5 6zm0 1a1.5 1.5 0 10.84 2.742l-.03.019.031-.02.034-.024.028-.02c.021-.015.041-.031.06-.048l-.057.045.082-.065a1.51 1.51 0 00.214-.23l.039-.057.001-.001.015-.024.014-.022.003-.005.008-.012.034-.058.003-.006A1.5 1.5 0 008.5 7zM5 7v1H2V7h3zm1-2v1H2V5h4zm3-2v1H2V3h7z" fill-rule="nonzero" fill="#000"></path></svg>'},270:function(e,t){e.exports='<svg viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><path d="M12.8 8L14 9l-7 5-7-5 1.2-1L7 12l5.8-4zM7 0l7 5-7 5-7-5 7-5z" fill-rule="evenodd"></path></svg>'},271:function(e,t){e.exports='<svg viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><path d="M7.25 8.201V14h5.8V8.201h-5.8zM0 14h5.8V8.201H0V14zM0 .953v5.799h5.8V.953H0zM9.9 0L5.8 4.103 9.9 8.2 14 4.103 9.9 0z" fill-rule="nonzero"></path></svg>'},272:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M6 0a6 6 0 110 12A6 6 0 016 0zm0 1a5 5 0 100 10A5 5 0 006 1zm.5 3.5v4H7a.5.5 0 110 1H5a.5.5 0 110-1h.5v-3H5a.5.5 0 110-1h1.5zm-.5-2a.5.5 0 110 1 .5.5 0 010-1z" fill="#FFF" fill-rule="nonzero"></path></svg>'},273:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M1.6 4.23L.553 5.238 0 4.558l1.687-1.46h.86v5.804H1.6V4.23zm2.035 3.63l2.168-2.18L6 5.471c.068-.073.13-.151.185-.233.055-.082.101-.168.138-.258a.741.741 0 00.055-.283.729.729 0 00-.244-.558.786.786 0 00-.256-.151.9.9 0 00-.312-.054.822.822 0 00-.583.214.918.918 0 00-.276.573l-.993-.082c.02-.267.082-.504.185-.709.102-.205.235-.375.398-.512.163-.137.352-.24.568-.311A2.23 2.23 0 015.566 3c.253 0 .488.034.706.102.218.069.409.17.572.304.163.134.291.304.386.512.095.208.142.45.142.73 0 .366-.08.681-.24.946-.16.265-.367.518-.62.758L4.786 8.016h2.586v.886H3.635V7.86zm5.952-2.426h.245c.136 0 .27-.008.398-.024a.999.999 0 00.347-.107.64.64 0 00.248-.237.8.8 0 00.095-.418.73.73 0 00-.22-.55.794.794 0 00-.576-.213.828.828 0 00-.509.168.948.948 0 00-.327.472l-1.002-.28c.064-.212.153-.398.269-.556.115-.159.252-.289.41-.39.157-.1.33-.176.52-.225.19-.05.386-.074.591-.074.242 0 .47.033.686.098.216.066.405.163.568.291a1.412 1.412 0 01.536 1.16c0 .312-.084.589-.252.832a1.177 1.177 0 01-.702.48v.016c.357.055.628.213.812.475.184.263.276.574.276.935 0 .279-.051.524-.154.738-.102.213-.24.392-.414.536a1.786 1.786 0 01-.603.328 2.31 2.31 0 01-.713.111c-.232 0-.45-.026-.655-.078a1.805 1.805 0 01-.556-.242 1.602 1.602 0 01-.43-.422A1.91 1.91 0 018.2 7.64l1.009-.278c.058.24.16.426.307.557.148.131.347.197.6.197a.986.986 0 00.658-.25.855.855 0 00.205-.287.906.906 0 00.075-.373.822.822 0 00-.114-.455.781.781 0 00-.292-.27 1.225 1.225 0 00-.398-.128 2.95 2.95 0 00-.434-.032h-.229v-.886z" fill="#000" fill-rule="nonzero"></path></svg>'},274:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M1.804 3.145h.638l1.786 5.71h-.843L3 7.548H1.2L.826 8.855H0l1.804-5.71zm.937 3.532l-.639-2.322-.65 2.322h1.289zm1.95-3.532h1.616c.157 0 .31.026.463.077.152.05.288.134.407.25.12.115.216.265.29.447.074.183.111.404.111.662 0 .322-.066.588-.199.798-.133.21-.306.36-.521.452v.016a.871.871 0 01.36.149c.111.078.206.177.284.298.078.121.14.261.185.42.045.158.067.329.067.512 0 .312-.045.571-.135.778-.09.207-.208.374-.354.5a1.308 1.308 0 01-.504.27c-.189.054-.381.08-.577.08H4.691V3.146zm.738 2.323h.673c.246 0 .43-.066.554-.198a.731.731 0 00.184-.52c0-.247-.063-.431-.19-.552-.127-.121-.33-.182-.612-.182H5.43v1.452zm0 2.516h.68c.093 0 .194-.008.301-.024a.675.675 0 00.518-.367.96.96 0 00.088-.448c0-.3-.071-.51-.214-.629-.142-.118-.364-.177-.664-.177h-.709v1.645zm5.903-3.5c-.152-.226-.3-.376-.442-.452a.914.914 0 00-.43-.113c-.215 0-.41.053-.583.158-.174.104-.323.25-.448.435a2.203 2.203 0 00-.29.65 2.988 2.988 0 00-.102.798c0 .306.034.588.102.846.068.259.165.482.29.67.125.188.274.336.448.443.174.108.368.162.583.162.168 0 .33-.055.489-.166.158-.11.305-.286.442-.528l.609.597c-.187.355-.416.613-.685.774-.27.161-.557.242-.861.242-.32 0-.614-.071-.882-.214a2.064 2.064 0 01-.69-.605 3.012 3.012 0 01-.454-.94 4.241 4.241 0 01-.164-1.217c0-.457.054-.872.164-1.246.109-.373.26-.692.453-.955.194-.264.424-.467.691-.61.268-.142.562-.213.882-.213.281 0 .542.069.782.206.24.137.463.37.67.697l-.574.58z" fill="#000" fill-rule="nonzero"></path></svg>'},31:function(e,t){e.exports=r},35:function(e,t){e.exports=s},36:function(e,t){e.exports='<svg viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M7.745 7l4.1 4.1a.527.527 0 01-.745.746L7 7.746l-4.1 4.1a.527.527 0 01-.746-.746l4.1-4.1-4.1-4.1a.527.527 0 01.746-.746l4.1 4.1 4.1-4.1a.527.527 0 01.746.746L7.746 7z" fill="#000"></path><path d="M1 1h12v12H1z"></path></g></svg>'},59:function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0)"><path fill-rule="evenodd" clip-rule="evenodd" d="M.146 3.146a.5.5 0 01.708 0L6 8.5l5.146-5.354a.5.5 0 01.708.708l-5.5 5.707a.5.5 0 01-.708 0l-5.5-5.707a.5.5 0 010-.708z" fill="#000"></path></g><defs><clipPath id="clip0"><path fill="#fff" d="M0 0h12v12H0z"></path></clipPath></defs></svg>'},65:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 32"><path d="M16.492 0c-8.837 0-16 7.163-16 16s7.163 16 16 16 16-7.163 16-16-7.163-16-16-16zm0 21.333a2 2 0 11.001 3.999 2 2 0 01-.001-3.999zm0-2.666a2 2 0 01-2-2v-8a2 2 0 114 0v8a2 2 0 01-2 2z"></path></svg>'},91:function(e,t){e.exports='<svg viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M.5 13a.5.5 0 010-1h4a.5.5 0 010 1h-4zM0 8.5a.5.5 0 00.5.5h7a.5.5 0 000-1h-7a.5.5 0 00-.5.5zM.5 5a.5.5 0 010-1h11a.5.5 0 010 1H.5zM.5 1a.5.5 0 110-1h15a.5.5 0 010 1H.5z" fill="#000"></path></svg>'},92:function(e,t){e.exports='<svg viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M.5 0a.5.5 0 000 1h4a.5.5 0 000-1h-4zM0 4.5A.5.5 0 01.5 4h7a.5.5 0 010 1h-7a.5.5 0 01-.5-.5zM.5 8a.5.5 0 000 1h11a.5.5 0 000-1H.5zM.5 12a.5.5 0 000 1h15a.5.5 0 000-1H.5z" fill="#000"></path></svg>'},93:function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0)"><path fill-rule="evenodd" clip-rule="evenodd" d="M.146 9.56a.5.5 0 00.708 0L6 4.208l5.146 5.354a.5.5 0 00.708-.708l-5.5-5.707a.5.5 0 00-.708 0l-5.5 5.707a.5.5 0 000 .708z" fill="#000"></path></g><defs><clipPath id="clip0"><path fill="#fff" d="M0 0h12v12H0z"></path></clipPath></defs></svg>'},94:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2.212 9.936L2 12.27l2.333-.212L13.27 3.12 11.149 1 2.212 9.936zm-.707-.707L10.441.293a1 1 0 011.415 0l2.12 2.121a1 1 0 010 1.414l-8.935 8.937a1 1 0 01-.617.289l-2.333.212a1 1 0 01-1.087-1.087l.212-2.333a1 1 0 01.289-.617zm7.434-6.497l2.829 2.829-.707.707-2.829-2.829.707-.707zM.5 15h15a.5.5 0 010 1H.5a.5.5 0 010-1z" fill="#000" fill-rule="nonzero"></path></svg>'},963:function(e,t,n){"use strict";n.r(t),n.d(t,"DataSourceSelector",(function(){return On})),n.d(t,"DataSourceList",(function(){return Xt})),n.d(t,"ExternalDataSourceSelector",(function(){return pt})),n.d(t,"DataSourceItem",(function(){return An})),n.d(t,"DataSourceErrorItem",(function(){return Pn})),n.d(t,"FieldSelector",(function(){return ha})),n.d(t,"DataViewPriority",(function(){return qn})),n.d(t,"MainDataAndViewSelector",(function(){return oa})),n.d(t,"DataViewSettingPopup",(function(){return pn})),n.d(t,"DataSourceRemoveWarningPopup",(function(){return nn})),n.d(t,"AllDataSourceTypes",(function(){return U})),n.d(t,"dataComponentsUtils",(function(){return o}));var a={};n.r(a),n.d(a,"DataSourceSelector",(function(){return l})),n.d(a,"DataSourceList",(function(){return d})),n.d(a,"DataSourceTree",(function(){return f})),n.d(a,"ExternalDataSourceSelector",(function(){return v})),n.d(a,"DataSourceItem",(function(){return y})),n.d(a,"DataSourceErrorItem",(function(){return x})),n.d(a,"FieldSelector",(function(){return O})),n.d(a,"MainDataAndViewSelector",(function(){return N})),n.d(a,"DataViewSettingPopup",(function(){return k})),n.d(a,"DataSourceRemoveWarningPopup",(function(){return L}));var o={};n.r(o),n.d(o,"getWidgetsUsingDsOrItsViews",(function(){return F})),n.d(o,"getWidgetsUsingDsOrItsDescendantDss",(function(){return W})),n.d(o,"getDescendantDssAndViews",(function(){return B})),n.d(o,"isFuzzySearch",(function(){return J})),n.d(o,"isFuzzyFromDsIds",(function(){return q})),n.d(o,"getOutputDssFromOriginDs",(function(){return G})),n.d(o,"getAppConfig",(function(){return Q})),n.d(o,"getDsIcon",(function(){return X})),n.d(o,"getDsTypeString",(function(){return K})),n.d(o,"getWhetherDataSourceIsInited",(function(){return Y})),n.d(o,"editDataSourceJson",(function(){return Z})),n.d(o,"getOriginalDataUrl",(function(){return $})),n.d(o,"getWidgetsUsingOutputDsFromOneWidget",(function(){return ee}));var r,s=n(0),i=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};function l(e){var t=e.theme;return Object(s.css)(r||(r=i(["\n    .component-data-source-selector{\n      .font-dark-600{\n        color: ",";\n      }\n      .dv-select-container{\n        margin-top: ",";\n        .jimu-dropdown-button{\n          .settings-icon{\n            display: none;\n          }\n        }\n      }\n      .ds-selector-button{\n        height: ",";\n        line-height: ",";\n        padding: 0;\n        border: 1px dashed ",";\n        border-radius: ",";\n        cursor: pointer;\n        color: ",";\n        font-size: ",";\n        text-decoration: none;\n        &:hover{\n          border-color: ",";\n          color: ",";\n        }\n      }\n      .ds-item.ds-error-item{\n        background-color: ",";\n        *{\n          color: "," !important;\n        }\n        .ds-thumbnail{\n          background-color: ",";\n        }\n      }\n      .ds-item{\n        &:not(:first-of-type) {\n          margin-top: ",";\n        }\n        padding: "," "," "," ",";\n        background-color: ",";\n        cursor: pointer;\n\n        .mr-30{\n          margin-right: ",";\n        }\n\n        &.disable-cursor{\n          cursor: default;\n        }\n\n        .ds-item-close{\n          height: 100%;\n          cursor: pointer;\n          margin-left: ",";\n          margin-right: -5px;\n        }\n\n        .ds-item-filter{\n          height: 100%;\n          cursor: pointer;\n        }\n\n        .ds-item-sort{\n          height: 100%;\n          cursor: pointer;\n          margin-left: ",";\n        }\n\n        .ds-thumbnail{\n          width:  ",";\n          height:  ",";\n          background-color: ",";\n        }\n        .ds-type{\n          font-size: ",";\n          color: ",";\n        }\n        .top-right-red-dot-container{\n          position: relative;\n        }\n        .top-right-red-dot{\n          position: absolute;\n          top: 0;\n          right: 0;\n          display: inline-block;\n          width: 8px;\n          height: 8px;\n          border-radius: 4px;\n          background-color: ",";\n        }\n      }\n    }\n\n  "],["\n    .component-data-source-selector{\n      .font-dark-600{\n        color: ",";\n      }\n      .dv-select-container{\n        margin-top: ",";\n        .jimu-dropdown-button{\n          .settings-icon{\n            display: none;\n          }\n        }\n      }\n      .ds-selector-button{\n        height: ",";\n        line-height: ",";\n        padding: 0;\n        border: 1px dashed ",";\n        border-radius: ",";\n        cursor: pointer;\n        color: ",";\n        font-size: ",";\n        text-decoration: none;\n        &:hover{\n          border-color: ",";\n          color: ",";\n        }\n      }\n      .ds-item.ds-error-item{\n        background-color: ",";\n        *{\n          color: "," !important;\n        }\n        .ds-thumbnail{\n          background-color: ",";\n        }\n      }\n      .ds-item{\n        &:not(:first-of-type) {\n          margin-top: ",";\n        }\n        padding: "," "," "," ",";\n        background-color: ",";\n        cursor: pointer;\n\n        .mr-30{\n          margin-right: ",";\n        }\n\n        &.disable-cursor{\n          cursor: default;\n        }\n\n        .ds-item-close{\n          height: 100%;\n          cursor: pointer;\n          margin-left: ",";\n          margin-right: -5px;\n        }\n\n        .ds-item-filter{\n          height: 100%;\n          cursor: pointer;\n        }\n\n        .ds-item-sort{\n          height: 100%;\n          cursor: pointer;\n          margin-left: ",";\n        }\n\n        .ds-thumbnail{\n          width:  ",";\n          height:  ",";\n          background-color: ",";\n        }\n        .ds-type{\n          font-size: ",";\n          color: ",";\n        }\n        .top-right-red-dot-container{\n          position: relative;\n        }\n        .top-right-red-dot{\n          position: absolute;\n          top: 0;\n          right: 0;\n          display: inline-block;\n          width: 8px;\n          height: 8px;\n          border-radius: 4px;\n          background-color: ",";\n        }\n      }\n    }\n\n  "])),t.colors.palette.dark[600],s.polished.rem(12),s.polished.rem(40),s.polished.rem(40),t.colors.palette.dark[100],s.polished.rem(2),t.colors.palette.primary[700],s.polished.rem(14),t.colors.palette.dark[400],t.colors.palette.primary[800],t.colors.palette.secondary[400],t.colors.palette.dark[400],t.colors.palette.secondary[800],s.polished.rem(8),s.polished.rem(8),s.polished.rem(10),s.polished.rem(10),s.polished.rem(10),t.colors.palette.secondary[500],s.polished.rem(30),s.polished.rem(5),s.polished.rem(5),s.polished.rem(18),s.polished.rem(18),t.colors.palette.info[400],s.polished.rem(14),t.colors.palette.dark[800],t.colors.palette.danger[700])}var c,u=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};function d(e){var t=e.theme;return Object(s.css)(c||(c=u(["\n    .component-data-source-list{\n      font-size: ",";\n      overflow: hidden;\n\n      .search{\n        position: relative;\n      }\n      .search-input{\n        height: 26px;\n        padding-left: ",";\n        border-radius: 2px;\n      }\n      .search-icon{\n        color: ",";\n        position: absolute;\n        top: 6px;\n        left: 22px;\n      }\n\n      .empty-placeholder{\n        position: absolute;\n        left: 50%;\n        top: 50%;\n        transform: translate(-50%, -50%);\n        .empty-placeholder-text, .empty-placeholder-icon{\n          display: table;\n          margin: 0 auto;\n        }\n        .empty-placeholder-text{\n          color: ",";\n          font-size: ",";\n          margin-top: 16px;\n          text-align: center;\n        }\n        .empty-placeholder-icon{\n          color: ",";\n        }\n      }\n\n      .jimu-tab{\n        height: 100%;\n        .tab-content{\n          height: calc(100% - 40px);\n        }\n        .tab-pane{\n          width: 100%;\n        }\n        .jimu-nav.nav-pills{\n            margin: 0 "," !important;\n          }\n      }\n\n      .ds-list-container{\n        height: calc(100% - 110px);\n      }\n\n      .ds-list{\n        height: calc(100% - 70px);\n        overflow: auto;\n      }\n\n      .ds-list-header{\n        width: 100%;\n      }\n\n      .ds-add-data{\n        position: absolute;\n        bottom: 0;\n        height: ",";\n        width: 100%;\n        color: ",";\n        font-size: ",";\n        border-top: 1px solid ",";\n        cursor: pointer;\n        &:hover{\n          .add-data-icon-container{\n            background-color: ",";\n          }\n          color: ",";\n        }\n        .add-data-icon-container{\n          width: ",";\n          height: ",";\n          background-color: ",";\n          border-radius: ",";\n        }\n        .add-data-icon{\n          color: ",";\n        }\n      }\n\n      .ds-list-close{\n        width: ",";\n        height: 100%;\n        cursor: pointer;\n      }\n\n      .ds-widget-back{\n        width: ",";\n        height: ",";\n        cursor: pointer;\n      }\n\n      .ds-types{\n        color: ",";\n        font-size: ",";\n        margin: "," 0;\n        padding: 0 ",";\n      }\n\n      .ds-widget-outputs{\n        padding: 0;\n      }\n\n      .ds-added-data{\n        padding: 0;\n      }\n\n      .to-use-types{\n        color: ",";\n        .types-selected{\n          max-width: ",";\n        }\n        .to-use-dp{\n          width: ",";\n          height: ",";\n        }\n      }\n\n      .ds-thumbnail{\n        width:  ",";\n        height:  ",";\n        background-color: ",";\n      }\n      .ds-type{\n        font-size: ",";\n        color: ",";\n      }\n      .ds-item.ds-error-item{\n        background-color: ",";\n        *{\n          color: "," !important;\n        }\n        .ds-thumbnail{\n          background-color: ",";\n        }\n      }\n      .ds-item{\n        border: 2px solid transparent;\n        position: relative;\n        left: -2px;\n        cursor: pointer;\n        .item{\n          height: ",";\n          background-color: ",";\n          padding-left: 0;\n          padding-right: ",";\n        }\n        .selected{\n          width:  ",";\n          height:  ",";\n          border-radius: 0 0 0 2px;\n          background-color: ",";\n          position: absolute;\n          top: 0;\n          right: 0;\n          .selected-icon{\n            color: ",";\n            margin-left: 2px;\n            margin-top: -2px;\n          }\n        }\n      }\n      .ds-item.ds-item-selected{\n        border: 2px solid ",";\n      }\n    }\n\n  "],["\n    .component-data-source-list{\n      font-size: ",";\n      overflow: hidden;\n\n      .search{\n        position: relative;\n      }\n      .search-input{\n        height: 26px;\n        padding-left: ",";\n        border-radius: 2px;\n      }\n      .search-icon{\n        color: ",";\n        position: absolute;\n        top: 6px;\n        left: 22px;\n      }\n\n      .empty-placeholder{\n        position: absolute;\n        left: 50%;\n        top: 50%;\n        transform: translate(-50%, -50%);\n        .empty-placeholder-text, .empty-placeholder-icon{\n          display: table;\n          margin: 0 auto;\n        }\n        .empty-placeholder-text{\n          color: ",";\n          font-size: ",";\n          margin-top: 16px;\n          text-align: center;\n        }\n        .empty-placeholder-icon{\n          color: ",";\n        }\n      }\n\n      .jimu-tab{\n        height: 100%;\n        .tab-content{\n          height: calc(100% - 40px);\n        }\n        .tab-pane{\n          width: 100%;\n        }\n        .jimu-nav.nav-pills{\n            margin: 0 "," !important;\n          }\n      }\n\n      .ds-list-container{\n        height: calc(100% - 110px);\n      }\n\n      .ds-list{\n        height: calc(100% - 70px);\n        overflow: auto;\n      }\n\n      .ds-list-header{\n        width: 100%;\n      }\n\n      .ds-add-data{\n        position: absolute;\n        bottom: 0;\n        height: ",";\n        width: 100%;\n        color: ",";\n        font-size: ",";\n        border-top: 1px solid ",";\n        cursor: pointer;\n        &:hover{\n          .add-data-icon-container{\n            background-color: ",";\n          }\n          color: ",";\n        }\n        .add-data-icon-container{\n          width: ",";\n          height: ",";\n          background-color: ",";\n          border-radius: ",";\n        }\n        .add-data-icon{\n          color: ",";\n        }\n      }\n\n      .ds-list-close{\n        width: ",";\n        height: 100%;\n        cursor: pointer;\n      }\n\n      .ds-widget-back{\n        width: ",";\n        height: ",";\n        cursor: pointer;\n      }\n\n      .ds-types{\n        color: ",";\n        font-size: ",";\n        margin: "," 0;\n        padding: 0 ",";\n      }\n\n      .ds-widget-outputs{\n        padding: 0;\n      }\n\n      .ds-added-data{\n        padding: 0;\n      }\n\n      .to-use-types{\n        color: ",";\n        .types-selected{\n          max-width: ",";\n        }\n        .to-use-dp{\n          width: ",";\n          height: ",";\n        }\n      }\n\n      .ds-thumbnail{\n        width:  ",";\n        height:  ",";\n        background-color: ",";\n      }\n      .ds-type{\n        font-size: ",";\n        color: ",";\n      }\n      .ds-item.ds-error-item{\n        background-color: ",";\n        *{\n          color: "," !important;\n        }\n        .ds-thumbnail{\n          background-color: ",";\n        }\n      }\n      .ds-item{\n        border: 2px solid transparent;\n        position: relative;\n        left: -2px;\n        cursor: pointer;\n        .item{\n          height: ",";\n          background-color: ",";\n          padding-left: 0;\n          padding-right: ",";\n        }\n        .selected{\n          width:  ",";\n          height:  ",";\n          border-radius: 0 0 0 2px;\n          background-color: ",";\n          position: absolute;\n          top: 0;\n          right: 0;\n          .selected-icon{\n            color: ",";\n            margin-left: 2px;\n            margin-top: -2px;\n          }\n        }\n      }\n      .ds-item.ds-item-selected{\n        border: 2px solid ",";\n      }\n    }\n\n  "])),t.typography.fontSizeBase,s.polished.rem(28),t.colors.palette.dark[600],t.colors.palette.dark[400],s.polished.rem(14),t.colors.palette.secondary[800],s.polished.rem(16),s.polished.rem(40),t.colors.palette.primary[700],s.polished.rem(14),t.colors.palette.secondary[800],t.colors.palette.primary[800],t.colors.palette.primary[800],s.polished.rem(20),s.polished.rem(20),t.colors.palette.primary[700],s.polished.rem(10),t.colors.palette.light[300],s.polished.rem(30),s.polished.rem(80),s.polished.rem(30),t.colors.black,t.typography.fontSizeBase,s.polished.rem(6),s.polished.rem(16),t.colors.black,s.polished.rem(150),s.polished.rem(120),s.polished.rem(26),s.polished.rem(26),s.polished.rem(26),t.colors.palette.info[400],s.polished.rem(14),t.colors.palette.dark[800],t.colors.palette.secondary[400],t.colors.palette.dark[400],t.colors.palette.secondary[800],s.polished.rem(26),t.colors.palette.secondary[500],s.polished.rem(10),s.polished.rem(24),s.polished.rem(24),t.colors.palette.primary[700],t.colors.palette.secondary[500],t.colors.palette.primary[700])}var p,h=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};function f(e){var t=e.theme;return Object(s.css)(p||(p=h(["\n    *{\n      margin: 0;\n      padding: 0;\n    }\n    .bg{\n      padding: "," ",";\n      background-color: ",";\n      border-top: 2px solid ",";\n    }\n    .tree-root{\n      padding-left: ",";\n      padding-right: ",";\n    }\n    .component-data-source-tree{\n      position: relative;\n      .collapse-button{\n        position: absolute;\n        left: 2px;\n        z-index: 1;\n      }\n      .collapse-content{\n        padding-left: ",";\n        padding-top: ",";\n        position: relative;\n      }\n      .collapse-button:not(.root):not(.leaf){\n        left: ",";\n      }\n      .collapse-button.leaf{\n        left: 2px;\n      }\n      .collapse-button:not(.root):before{\n        content: '';\n        position: absolute;\n        top: 50%;\n        left: -2px;\n        border-top: 1px solid ",";\n        width: ",";\n        transform: translateY(-50%);\n      }\n      .collapse-line{\n        border-left: 1px solid ",";\n        border-bottom: 1px solid ",";\n        width: ",";\n        position: absolute;\n        top: -1px;\n        left: 0;\n        z-index: 0;\n      }\n      .collapse-line:not(.root){\n        width: ",";\n        top: -2px;\n      }\n    }\n\n  "],["\n    *{\n      margin: 0;\n      padding: 0;\n    }\n    .bg{\n      padding: "," ",";\n      background-color: ",";\n      border-top: 2px solid ",";\n    }\n    .tree-root{\n      padding-left: ",";\n      padding-right: ",";\n    }\n    .component-data-source-tree{\n      position: relative;\n      .collapse-button{\n        position: absolute;\n        left: 2px;\n        z-index: 1;\n      }\n      .collapse-content{\n        padding-left: ",";\n        padding-top: ",";\n        position: relative;\n      }\n      .collapse-button:not(.root):not(.leaf){\n        left: ",";\n      }\n      .collapse-button.leaf{\n        left: 2px;\n      }\n      .collapse-button:not(.root):before{\n        content: '';\n        position: absolute;\n        top: 50%;\n        left: -2px;\n        border-top: 1px solid ",";\n        width: ",";\n        transform: translateY(-50%);\n      }\n      .collapse-line{\n        border-left: 1px solid ",";\n        border-bottom: 1px solid ",";\n        width: ",";\n        position: absolute;\n        top: -1px;\n        left: 0;\n        z-index: 0;\n      }\n      .collapse-line:not(.root){\n        width: ",";\n        top: -2px;\n      }\n    }\n\n  "])),s.polished.rem(16),s.polished.rem(2),t.colors.palette.light[200],t.colors.palette.primary[600],s.polished.rem(20),s.polished.rem(5),s.polished.rem(20),s.polished.rem(16),s.polished.rem(-18),t.colors.palette.dark[400],s.polished.rem(21),t.colors.palette.dark[400],t.colors.palette.dark[400],s.polished.rem(22),s.polished.rem(20))}var m,g=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};function v(e){var t=e.theme;return Object(s.css)(m||(m=g(["\n    .component-external-data-source-selector{\n      height: 100%;\n      overflow: hidden;\n      position: relative;\n\n      .inner-item-selector-container{\n        .item-selector-container{\n          height: calc(100% - 110px);\n        }\n      }\n\n      .hint-label{\n        font-size: ",";\n        color: ",";\n      }\n\n      .font-size-12{\n        font-size: ",";\n      }\n\n      .added-ds-item{\n        position: relative;\n        cursor: pointer;\n        margin: "," "," "," ",";\n        .ds-thumbnail{\n          width:  ",";\n          height:  ",";\n          background-color: ",";\n        }\n        .ds-type{\n          font-size: ",";\n          color: ",";\n        }\n        .item{\n          height: ",";\n        }\n      }\n\n      .added-ds-container{\n        width: ",";\n        background-color: ",";\n        box-shadow: 0 0 10px 4px ",";\n        position: absolute;\n        right: 30px;\n        bottom: 30px;\n        .added-ds-items{\n          max-height: ",";\n          overflow-y: auto;\n          overflow-x: hidden;\n        }\n        .small-done-btn{\n          max-width: ",";\n        }\n      }\n\n      .mt-30{\n        margin-top: ",";\n        margin-bottom: ",";\n      }\n\n      .selector-left{\n        @media only screen and (max-width: 1100px){\n          &{\n            width: ",";\n          }\n        }\n        @media only screen and (min-width: 1100px){\n          &{\n            width: ",";\n          }\n        }\n        @media only screen and (min-width: 1300px){\n          &{\n            width: ",";\n          }\n        }\n        background-color: ",";\n        border-right: 1px solid ",";\n        .selector-left-title{\n          padding: "," "," "," ",";\n          margin: 0;\n          font-size: ",";\n          color: ",";\n        }\n        .nav.nav-underline{\n          border: 0;\n          .nav-item{\n            .nav-link{\n              padding: 0;\n              border: 0;\n              .jimu-nav-link-wrapper{\n                display: flex;\n                justify-content: flex-start;\n                align-items: center;\n                padding: "," ",";\n                font-size: ",";\n                color: ",";\n              }\n            }\n          }\n\n          .nav-item:hover{\n            .nav-link{\n              .jimu-nav-link-wrapper{\n                color: ",";\n              }\n            }\n          }\n\n          .nav-item.active-tab{\n            background-color: ",";\n            border-left: 4px solid ",";\n            .nav-link{\n              .jimu-nav-link-wrapper{\n                color: ",";\n                font-weight: 500;\n                padding-left: ",";\n              }\n            }\n          }\n        }\n      }\n\n      .selector-right{\n        @media only screen and (max-width: 1100px){\n          &{\n            width: calc(100% - ",");\n          }\n        }\n        @media only screen and (min-width: 1100px){\n          &{\n            width: calc(100% - ",");\n          }\n        }\n        @media only screen and (min-width: 1300px){\n          &{\n            width: calc(100% - ",");\n          }\n        }\n        .selector-right-header{\n          padding: "," "," "," ",";\n        }\n        .selector-right-body{\n          height: calc(100% - 70px);\n          @media only screen and (max-width: 1100px){\n            &{\n              padding: "," ",";\n            }\n          }\n          @media only screen and (min-width: 1100px){\n            &{\n              padding: "," ",";\n            }\n          }\n          @media only screen and (min-width: 1300px){\n            &{\n              padding: "," ",";\n            }\n          }\n        }\n        .nav-item{\n          .nav-link{\n            .jimu-nav-link-wrapper{\n              font-size: ",";\n            }\n          }\n        }\n        .nav-item.active-tab{\n          .nav-link{\n            border-bottom: 3px solid ",";\n            padding: 0;\n            .jimu-nav-link-wrapper{\n              color: ",";\n              font-weight: 500;\n            }\n          }\n        }\n      }\n\n      .external-data-source-url-input{\n        .url-type-select{\n          width: ",";\n        }\n        .url-input{\n          width: ",";\n        }\n        .url-input-add-btn{\n          height: ",";\n        }\n        .url-input-label{\n          font-size: ",";\n          color: ",";\n          margin-bottom: 12px;\n          font-weight: 500;\n        }\n      }\n\n      .external-data-source-app-data{\n        .item-list{\n          display: flex;\n          flex-wrap: wrap;\n          margin-top: 2rem;\n          margin-left: -0.5rem;\n          margin-right: -0.5rem;\n          overflow-x: hidden;\n          overflow-y: auto;\n\n          .item{\n            width: ","%;\n            margin-bottom: 1rem;\n            padding: 0 0.5rem;\n\n            .item-active-border-transparent{\n              border: "," solid transparent;\n\n              &:hover{\n                border-color: ",";\n              }\n            }\n\n            .item-card-container.item-border-transparent{\n              border: "," solid transparent;\n            }\n\n            .item-card-container{\n              border: "," solid;\n              padding-bottom: ",";\n              position: relative;\n              overflow: hidden;\n\n              &:hover{\n                border-color: transparent !important;\n              }\n\n              .item-card{\n                position: absolute;\n\n                .item-card-content{\n                  padding: ",";\n                }\n\n                .item-label{\n                  max-height: ",";\n                  overflow: hidden;\n                  text-overflow: ellipsis;\n                  white-space: nowrap;\n                }\n\n                .item-logo{\n                  width: ",";\n                  height: ",";\n                }\n\n                .item-active-icon{\n                  position: absolute;\n                  top: ",";\n                  left: ",";\n\n                  .item-active-icon-container{\n                    width: ",";\n                    height: ",";\n                    line-height: ",";\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n\n      .external-data-source-item-selector{\n        .nav.nav-underline{\n          border: 0;\n          .nav-item:not(:last-child){\n            @media only screen and (max-width: 1100px){\n              &{\n                margin-right: ",";\n              }\n            }\n            @media only screen and (min-width: 1100px){\n              &{\n                margin-right: ",";\n              }\n            }\n            @media only screen and (min-width: 1300px){\n              &{\n                margin-right: ",";\n              }\n            }\n          }\n        }\n        .item-selector-search{\n          position: relative;\n          margin-left: ",";\n\n          .search-icon{\n            position: absolute;\n            left: ",";\n            padding: 0;\n            padding: 0;\n            top: 4px;\n            .jimu-icon{\n              margin: 0;\n            }\n          }\n\n          .close-icon{\n            position: absolute;\n            right: ",";\n            padding: 0;\n            padding: 0;\n            top: 4px;\n            .jimu-icon{\n              margin: 0;\n            }\n          }\n\n          @media only screen and (max-width: 1490px){\n            &,.search-input{\n              width: 100%;\n            }\n          }\n\n          @media only screen and (min-width: 1490px){\n            &{\n              width: auto;\n            }\n            .search-input{\n              width: ",";\n            }\n          }\n\n          .search-input{\n            height: ",";\n            line-height: ",";\n            background-color: ",";\n            color: ",";\n            font-size: ",";\n            padding-left: ",";\n            padding-right: ",";\n            border-radius: 2px;\n          }\n          .search-input::-ms-clear{\n            display: none;\n          }\n        }\n\n        .item-selector-sort{\n          margin-right: -",";\n          .item-selector-sort-by{\n            color: ",";\n            font-size: ",";\n            height: ",";\n            .item-selector-sort-select{\n              width: ",";\n              padding: 2px 6px;\n              font-size: ",";\n              height: ",";\n            }\n          }\n        }\n      }\n\n    }\n\n  "],["\n    .component-external-data-source-selector{\n      height: 100%;\n      overflow: hidden;\n      position: relative;\n\n      .inner-item-selector-container{\n        .item-selector-container{\n          height: calc(100% - 110px);\n        }\n      }\n\n      .hint-label{\n        font-size: ",";\n        color: ",";\n      }\n\n      .font-size-12{\n        font-size: ",";\n      }\n\n      .added-ds-item{\n        position: relative;\n        cursor: pointer;\n        margin: "," "," "," ",";\n        .ds-thumbnail{\n          width:  ",";\n          height:  ",";\n          background-color: ",";\n        }\n        .ds-type{\n          font-size: ",";\n          color: ",";\n        }\n        .item{\n          height: ",";\n        }\n      }\n\n      .added-ds-container{\n        width: ",";\n        background-color: ",";\n        box-shadow: 0 0 10px 4px ",";\n        position: absolute;\n        right: 30px;\n        bottom: 30px;\n        .added-ds-items{\n          max-height: ",";\n          overflow-y: auto;\n          overflow-x: hidden;\n        }\n        .small-done-btn{\n          max-width: ",";\n        }\n      }\n\n      .mt-30{\n        margin-top: ",";\n        margin-bottom: ",";\n      }\n\n      .selector-left{\n        @media only screen and (max-width: 1100px){\n          &{\n            width: ",";\n          }\n        }\n        @media only screen and (min-width: 1100px){\n          &{\n            width: ",";\n          }\n        }\n        @media only screen and (min-width: 1300px){\n          &{\n            width: ",";\n          }\n        }\n        background-color: ",";\n        border-right: 1px solid ",";\n        .selector-left-title{\n          padding: "," "," "," ",";\n          margin: 0;\n          font-size: ",";\n          color: ",";\n        }\n        .nav.nav-underline{\n          border: 0;\n          .nav-item{\n            .nav-link{\n              padding: 0;\n              border: 0;\n              .jimu-nav-link-wrapper{\n                display: flex;\n                justify-content: flex-start;\n                align-items: center;\n                padding: "," ",";\n                font-size: ",";\n                color: ",";\n              }\n            }\n          }\n\n          .nav-item:hover{\n            .nav-link{\n              .jimu-nav-link-wrapper{\n                color: ",";\n              }\n            }\n          }\n\n          .nav-item.active-tab{\n            background-color: ",";\n            border-left: 4px solid ",";\n            .nav-link{\n              .jimu-nav-link-wrapper{\n                color: ",";\n                font-weight: 500;\n                padding-left: ",";\n              }\n            }\n          }\n        }\n      }\n\n      .selector-right{\n        @media only screen and (max-width: 1100px){\n          &{\n            width: calc(100% - ",");\n          }\n        }\n        @media only screen and (min-width: 1100px){\n          &{\n            width: calc(100% - ",");\n          }\n        }\n        @media only screen and (min-width: 1300px){\n          &{\n            width: calc(100% - ",");\n          }\n        }\n        .selector-right-header{\n          padding: "," "," "," ",";\n        }\n        .selector-right-body{\n          height: calc(100% - 70px);\n          @media only screen and (max-width: 1100px){\n            &{\n              padding: "," ",";\n            }\n          }\n          @media only screen and (min-width: 1100px){\n            &{\n              padding: "," ",";\n            }\n          }\n          @media only screen and (min-width: 1300px){\n            &{\n              padding: "," ",";\n            }\n          }\n        }\n        .nav-item{\n          .nav-link{\n            .jimu-nav-link-wrapper{\n              font-size: ",";\n            }\n          }\n        }\n        .nav-item.active-tab{\n          .nav-link{\n            border-bottom: 3px solid ",";\n            padding: 0;\n            .jimu-nav-link-wrapper{\n              color: ",";\n              font-weight: 500;\n            }\n          }\n        }\n      }\n\n      .external-data-source-url-input{\n        .url-type-select{\n          width: ",";\n        }\n        .url-input{\n          width: ",";\n        }\n        .url-input-add-btn{\n          height: ",";\n        }\n        .url-input-label{\n          font-size: ",";\n          color: ",";\n          margin-bottom: 12px;\n          font-weight: 500;\n        }\n      }\n\n      .external-data-source-app-data{\n        .item-list{\n          display: flex;\n          flex-wrap: wrap;\n          margin-top: 2rem;\n          margin-left: -0.5rem;\n          margin-right: -0.5rem;\n          overflow-x: hidden;\n          overflow-y: auto;\n\n          .item{\n            width: ","%;\n            margin-bottom: 1rem;\n            padding: 0 0.5rem;\n\n            .item-active-border-transparent{\n              border: "," solid transparent;\n\n              &:hover{\n                border-color: ",";\n              }\n            }\n\n            .item-card-container.item-border-transparent{\n              border: "," solid transparent;\n            }\n\n            .item-card-container{\n              border: "," solid;\n              padding-bottom: ",";\n              position: relative;\n              overflow: hidden;\n\n              &:hover{\n                border-color: transparent !important;\n              }\n\n              .item-card{\n                position: absolute;\n\n                .item-card-content{\n                  padding: ",";\n                }\n\n                .item-label{\n                  max-height: ",";\n                  overflow: hidden;\n                  text-overflow: ellipsis;\n                  white-space: nowrap;\n                }\n\n                .item-logo{\n                  width: ",";\n                  height: ",";\n                }\n\n                .item-active-icon{\n                  position: absolute;\n                  top: ",";\n                  left: ",";\n\n                  .item-active-icon-container{\n                    width: ",";\n                    height: ",";\n                    line-height: ",";\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n\n      .external-data-source-item-selector{\n        .nav.nav-underline{\n          border: 0;\n          .nav-item:not(:last-child){\n            @media only screen and (max-width: 1100px){\n              &{\n                margin-right: ",";\n              }\n            }\n            @media only screen and (min-width: 1100px){\n              &{\n                margin-right: ",";\n              }\n            }\n            @media only screen and (min-width: 1300px){\n              &{\n                margin-right: ",";\n              }\n            }\n          }\n        }\n        .item-selector-search{\n          position: relative;\n          margin-left: ",";\n\n          .search-icon{\n            position: absolute;\n            left: ",";\n            padding: 0;\n            padding: 0;\n            top: 4px;\n            .jimu-icon{\n              margin: 0;\n            }\n          }\n\n          .close-icon{\n            position: absolute;\n            right: ",";\n            padding: 0;\n            padding: 0;\n            top: 4px;\n            .jimu-icon{\n              margin: 0;\n            }\n          }\n\n          @media only screen and (max-width: 1490px){\n            &,.search-input{\n              width: 100%;\n            }\n          }\n\n          @media only screen and (min-width: 1490px){\n            &{\n              width: auto;\n            }\n            .search-input{\n              width: ",";\n            }\n          }\n\n          .search-input{\n            height: ",";\n            line-height: ",";\n            background-color: ",";\n            color: ",";\n            font-size: ",";\n            padding-left: ",";\n            padding-right: ",";\n            border-radius: 2px;\n          }\n          .search-input::-ms-clear{\n            display: none;\n          }\n        }\n\n        .item-selector-sort{\n          margin-right: -",";\n          .item-selector-sort-by{\n            color: ",";\n            font-size: ",";\n            height: ",";\n            .item-selector-sort-select{\n              width: ",";\n              padding: 2px 6px;\n              font-size: ",";\n              height: ",";\n            }\n          }\n        }\n      }\n\n    }\n\n  "])),s.polished.rem(12),t.colors.palette.dark[400],s.polished.rem(12),s.polished.rem(16),s.polished.rem(8),s.polished.rem(16),s.polished.rem(10),s.polished.rem(26),s.polished.rem(26),t.colors.palette.info[400],s.polished.rem(13),t.colors.dark,s.polished.rem(26),s.polished.rem(300),t.colors.palette.light[600],s.polished.rgba(t.colors.white,.3),s.polished.rem(500),s.polished.rem(100),s.polished.rem(30),s.polished.rem(20),s.polished.rem(160),s.polished.rem(200),s.polished.rem(260),t.colors.palette.light[400],t.colors.palette.light[800],s.polished.rem(20),s.polished.rem(20),s.polished.rem(27),s.polished.rem(20),s.polished.rem(20),t.colors.palette.dark[600],s.polished.rem(7),s.polished.rem(20),s.polished.rem(16),t.colors.palette.dark[600],t.colors.black,t.colors.palette.light[500],t.colors.palette.primary[600],t.colors.black,s.polished.rem(16),s.polished.rem(160),s.polished.rem(200),s.polished.rem(260),s.polished.rem(23),s.polished.rem(20),s.polished.rem(12),s.polished.rem(20),s.polished.rem(10),s.polished.rem(25),s.polished.rem(10),s.polished.rem(45),s.polished.rem(10),s.polished.rem(65),s.polished.rem(16),t.colors.palette.primary[600],t.colors.black,s.polished.rem(250),s.polished.rem(500),s.polished.rem(30),s.polished.rem(13),t.colors.palette.dark[400],20,s.polished.rem(2),t.colors.primary,s.polished.rem(2),s.polished.rem(1),s.polished.rem(135),s.polished.rem(5),s.polished.rem(60),s.polished.rem(60),s.polished.rem(60),s.polished.rem(5),s.polished.rem(5),s.polished.rem(20),s.polished.rem(20),s.polished.rem(20),s.polished.rem(10),s.polished.rem(25),s.polished.rem(40),s.polished.rem(50),s.polished.rem(4),s.polished.rem(4),s.polished.rem(400),s.polished.rem(32),s.polished.rem(32),t.colors.palette.secondary[200],t.colors.palette.dark[400],s.polished.rem(14),s.polished.rem(28),s.polished.rem(28),s.polished.rem(16),t.colors.palette.dark[400],s.polished.rem(13),s.polished.rem(32),s.polished.rem(140),s.polished.rem(13),s.polished.rem(26))}var S,b=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};function y(e){var t=e.theme;return Object(s.css)(S||(S=b(["\n    .component-data-source-item{\n      background-color: ",";\n      font-size: ",";\n      border-radius: 2px;\n      padding: 0;\n      .font-dark-600{\n        color: "," !important;\n      }\n      .ds-item-header{\n        width: 100%;\n        height: ",";\n        padding: 0 10px;\n        background-color: ",";\n      }\n      .ds-item-body{\n        width: 100%;\n        height: 100%;\n        padding: 14px 10px 6px 10px;\n      }\n      .two-line-truncate{\n        overflow: hidden;\n        text-overflow: ellipsis;\n        display: -webkit-box;\n        -webkit-line-clamp: 2;\n        -webkit-box-orient: vertical;\n        word-break: break-word;\n        word-wrap: break-word;\n      }\n      .ds-more{\n        margin-right: ",";\n      }\n      .ds-label{\n        font-size: ",";\n        color: ",";\n      }\n      .ds-type{\n        font-size: ",";\n        color: ",";\n        max-width: ",";\n      }\n      .ds-thumbnail{\n        width:  ",";\n        height:  ",";\n        background-color: ",";\n      }\n      .ds-related-widgets, .ds-child-dss{\n        font-size: ",";\n      }\n      .warning-icon, .warning-icon>*{\n        color: ",";\n        fill: ",";\n      }\n    }\n\n    .component-data-source-item.component-data-source-item-selected-item{\n      border: "," solid ",";\n    }\n\n    .cursor-pointer{\n      cursor: pointer;\n    }\n\n  "],["\n    .component-data-source-item{\n      background-color: ",";\n      font-size: ",";\n      border-radius: 2px;\n      padding: 0;\n      .font-dark-600{\n        color: "," !important;\n      }\n      .ds-item-header{\n        width: 100%;\n        height: ",";\n        padding: 0 10px;\n        background-color: ",";\n      }\n      .ds-item-body{\n        width: 100%;\n        height: 100%;\n        padding: 14px 10px 6px 10px;\n      }\n      .two-line-truncate{\n        overflow: hidden;\n        text-overflow: ellipsis;\n        display: -webkit-box;\n        -webkit-line-clamp: 2;\n        -webkit-box-orient: vertical;\n        word-break: break-word;\n        word-wrap: break-word;\n      }\n      .ds-more{\n        margin-right: ",";\n      }\n      .ds-label{\n        font-size: ",";\n        color: ",";\n      }\n      .ds-type{\n        font-size: ",";\n        color: ",";\n        max-width: ",";\n      }\n      .ds-thumbnail{\n        width:  ",";\n        height:  ",";\n        background-color: ",";\n      }\n      .ds-related-widgets, .ds-child-dss{\n        font-size: ",";\n      }\n      .warning-icon, .warning-icon>*{\n        color: ",";\n        fill: ",";\n      }\n    }\n\n    .component-data-source-item.component-data-source-item-selected-item{\n      border: "," solid ",";\n    }\n\n    .cursor-pointer{\n      cursor: pointer;\n    }\n\n  "])),t.colors.palette.light[500],s.polished.rem(12),t.colors.palette.dark[600],s.polished.rem(38),t.colors.palette.light[700],s.polished.rem(-8),s.polished.rem(14),t.colors.palette.dark[800],s.polished.rem(13),t.colors.palette.dark[800],s.polished.rem(88),s.polished.rem(18),s.polished.rem(18),t.colors.palette.info[400],s.polished.rem(13),t.colors.palette.danger[700],t.colors.palette.danger[700],s.polished.rem(2),t.colors.primary)}var w,D=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};function x(e){var t=e.theme;return Object(s.css)(w||(w=D(["\n    .component-data-source-error-item{\n      .component-data-source-item{\n        background-color: ",";\n        *:not(.ds-badge svg){\n          color: "," !important;\n        }\n\n        .ds-origin-label{\n          max-width: 100%;\n          .ds-origin-label-link, .ds-origin-label-link:hover, .ds-origin-label-link:focus, .ds-origin-label-link:active{\n            color: ",";\n          }\n        }\n        .ds-item-header{\n          background-color: ",";\n        }\n        .ds-thumbnail{\n          background-color: ",";\n        }\n      }\n\n    }\n\n  "],["\n    .component-data-source-error-item{\n      .component-data-source-item{\n        background-color: ",";\n        *:not(.ds-badge svg){\n          color: "," !important;\n        }\n\n        .ds-origin-label{\n          max-width: 100%;\n          .ds-origin-label-link, .ds-origin-label-link:hover, .ds-origin-label-link:focus, .ds-origin-label-link:active{\n            color: ",";\n          }\n        }\n        .ds-item-header{\n          background-color: ",";\n        }\n        .ds-thumbnail{\n          background-color: ",";\n        }\n      }\n\n    }\n\n  "])),t.colors.palette.secondary[400],t.colors.palette.dark[400],t.colors.palette.dark[400],t.colors.palette.secondary[500],t.colors.palette.light[800])}var j,I=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};function O(e){var t=e.theme;return Object(s.css)(j||(j=I(["\n    .component-field-selector{\n      font-size: ",";\n      .ds-name{\n        color: ",";\n      }\n      .ds-name-label{\n        font-size: ",";\n        color: ",";\n        font-weight: 400;\n      }\n      .field-data-selected{\n        width: 70%;\n      }\n\n      .item-selector-search{\n        height: ",";\n        position: relative;\n      }\n\n      .field-list{\n        height: calc(100% - 160px);\n        overflow-y: auto;\n        .field-item.field-item-selected{\n          border: 2px solid ",";\n        }\n        .field-item{\n          border: 1px solid transparent;\n          cursor: pointer;\n          background-color: ",";\n          user-select: none;\n        }\n        .field-item:hover{\n          background-color: ",";\n        }\n        .field-item:active.field-item:hover{\n          background-color: ",";\n        }\n      }\n\n      .search-icon{\n        position: absolute;\n        top: ",";\n        left: ",";\n      }\n\n      .search-input{\n        height: ",";\n        padding-left: ",";\n      }\n\n    }\n\n  "],["\n    .component-field-selector{\n      font-size: ",";\n      .ds-name{\n        color: ",";\n      }\n      .ds-name-label{\n        font-size: ",";\n        color: ",";\n        font-weight: 400;\n      }\n      .field-data-selected{\n        width: 70%;\n      }\n\n      .item-selector-search{\n        height: ",";\n        position: relative;\n      }\n\n      .field-list{\n        height: calc(100% - 160px);\n        overflow-y: auto;\n        .field-item.field-item-selected{\n          border: 2px solid ",";\n        }\n        .field-item{\n          border: 1px solid transparent;\n          cursor: pointer;\n          background-color: ",";\n          user-select: none;\n        }\n        .field-item:hover{\n          background-color: ",";\n        }\n        .field-item:active.field-item:hover{\n          background-color: ",";\n        }\n      }\n\n      .search-icon{\n        position: absolute;\n        top: ",";\n        left: ",";\n      }\n\n      .search-input{\n        height: ",";\n        padding-left: ",";\n      }\n\n    }\n\n  "])),t.typography.fontSizeBase,t.colors.black,s.polished.rem(14),t.colors.palette.dark[400],s.polished.rem(26),t.colors.palette.primary[600],t.colors.palette.light[400],t.colors.palette.light[500],t.colors.white,s.polished.rem(5),s.polished.rem(25),s.polished.rem(26),s.polished.rem(28))}var M,C=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};function N(e){var t=e.theme;return Object(s.css)(M||(M=C(["\n    .component-main-data-and-view{\n      .option-label{\n        font-size: ",";\n        font-weight: 500;\n        color: ",";\n      }\n    }\n  "],["\n    .component-main-data-and-view{\n      .option-label{\n        font-size: ",";\n        font-weight: 500;\n        color: ",";\n      }\n    }\n  "])),s.polished.rem(13),t.colors.palette.dark[400])}var T,_=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};function k(e){var t=e.theme;return Object(s.css)(T||(T=_(["\n    .data-view-container{\n      width: ",";\n      height: ",";\n      border: 0;\n    }\n    .cicle-button{\n      width: ",";\n      height: ",";\n      border-radius: ",";\n    }\n    .w-38{\n      width: 38%;\n    }\n    .w-62{\n      width: 62%;\n    }\n    .preview-table{\n      position: relative;\n    }\n    .table-container{\n      height : 100%;\n      overflow-x: auto;\n      .table-body{\n        overflow-y: auto;\n        width: fit-content;\n      }\n      .table-header{\n        position: sticky;\n        top: 0;\n      }\n      tr{\n        border-top: 1px solid ",";\n      }\n      tr:last-child{\n        border-bottom: 1px solid ",";\n      }\n      td, th{\n        width: ",";\n        height: ",";\n        display: inline-block !important;\n        border-left: 1px solid ",";\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n        padding: 6px 4px;\n      }\n      td{\n        background-color: ",";\n      }\n      th{\n        background-color: ",";\n      }\n      td:last-child, th:last-child{\n        border-right: 1px solid ",";\n      }\n    }\n    .modal-body{\n      height: calc(100% - ",");\n      padding-bottom: ",";\n    }\n    &.modal-dialog{\n      max-width: ",";\n    }\n    .modal-header{\n      .close{\n        display: none;\n      }\n      .modal-title{\n        width: 100%;\n        display: flex !important;\n        align-items: center !important;\n      }\n    }\n\n    .jimu-nav{\n      margin-bottom: ",";\n    }\n\n    .label{\n      font-size: ",";\n      color: ",";\n    }\n\n    .header{\n      height: ",";\n    }\n\n    .tab-content{\n      height: ",";\n      overflow-y: auto;\n    }\n\n    .sql-exp-warning{\n      color: ",";\n      font-size: ",";\n      max-width: ",";\n      .sql-exp-warning-icon{\n        color: ",";\n      }\n    }\n\n  "],["\n    .data-view-container{\n      width: ",";\n      height: ",";\n      border: 0;\n    }\n    .cicle-button{\n      width: ",";\n      height: ",";\n      border-radius: ",";\n    }\n    .w-38{\n      width: 38%;\n    }\n    .w-62{\n      width: 62%;\n    }\n    .preview-table{\n      position: relative;\n    }\n    .table-container{\n      height : 100%;\n      overflow-x: auto;\n      .table-body{\n        overflow-y: auto;\n        width: fit-content;\n      }\n      .table-header{\n        position: sticky;\n        top: 0;\n      }\n      tr{\n        border-top: 1px solid ",";\n      }\n      tr:last-child{\n        border-bottom: 1px solid ",";\n      }\n      td, th{\n        width: ",";\n        height: ",";\n        display: inline-block !important;\n        border-left: 1px solid ",";\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n        padding: 6px 4px;\n      }\n      td{\n        background-color: ",";\n      }\n      th{\n        background-color: ",";\n      }\n      td:last-child, th:last-child{\n        border-right: 1px solid ",";\n      }\n    }\n    .modal-body{\n      height: calc(100% - ",");\n      padding-bottom: ",";\n    }\n    &.modal-dialog{\n      max-width: ",";\n    }\n    .modal-header{\n      .close{\n        display: none;\n      }\n      .modal-title{\n        width: 100%;\n        display: flex !important;\n        align-items: center !important;\n      }\n    }\n\n    .jimu-nav{\n      margin-bottom: ",";\n    }\n\n    .label{\n      font-size: ",";\n      color: ",";\n    }\n\n    .header{\n      height: ",";\n    }\n\n    .tab-content{\n      height: ",";\n      overflow-y: auto;\n    }\n\n    .sql-exp-warning{\n      color: ",";\n      font-size: ",";\n      max-width: ",";\n      .sql-exp-warning-icon{\n        color: ",";\n      }\n    }\n\n  "])),s.polished.rem(960),s.polished.rem(670),s.polished.rem(32),s.polished.rem(32),s.polished.rem(16),t.colors.palette.light[400],t.colors.palette.light[400],s.polished.rem(86),s.polished.rem(32),t.colors.palette.light[400],t.colors.palette.light[200],t.colors.palette.light[400],t.colors.palette.light[400],s.polished.rem(150),s.polished.rem(14),s.polished.rem(960),s.polished.rem(20),s.polished.rem(13),t.colors.palette.dark[400],s.polished.rem(54),s.polished.rem(426),t.colors.palette.danger[700],t.sizes[3],s.polished.rem(600),t.colors.palette.danger[700])}var V,E=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};function L(e){var t=e.theme;return Object(s.css)(V||(V=E(["\n    &.modal-dialog{\n      position: fixed !important;\n      top: 50% !important;\n      left: 50% !important;\n      transform: translate(-50%, -50%) !important;\n      width: 480px;\n      height: 560px;\n    }\n    .modal-content{\n      border: 0;\n    }\n    .modal-header, .modal-body{\n      padding-left: 20px;\n      padding-right: 20px;\n    }\n    .modal-footer{\n      padding-top: 0;\n      padding-bottom: 20px;\n    }\n    .font-16{\n      font-size: ",";\n    }\n    .font-14{\n      font-size: ",";\n    }\n    .font-13{\n      font-size: ",";\n    }\n    .font-dark-800{\n      color: ",";\n    }\n    .font-dark-600{\n      color: ",";\n    }\n    .related-widgets{\n      width: 100%;\n      height: ",";\n      overflow: auto;\n      background-color: ",";\n    }\n  "],["\n    &.modal-dialog{\n      position: fixed !important;\n      top: 50% !important;\n      left: 50% !important;\n      transform: translate(-50%, -50%) !important;\n      width: 480px;\n      height: 560px;\n    }\n    .modal-content{\n      border: 0;\n    }\n    .modal-header, .modal-body{\n      padding-left: 20px;\n      padding-right: 20px;\n    }\n    .modal-footer{\n      padding-top: 0;\n      padding-bottom: 20px;\n    }\n    .font-16{\n      font-size: ",";\n    }\n    .font-14{\n      font-size: ",";\n    }\n    .font-13{\n      font-size: ",";\n    }\n    .font-dark-800{\n      color: ",";\n    }\n    .font-dark-600{\n      color: ",";\n    }\n    .related-widgets{\n      width: 100%;\n      height: ",";\n      overflow: auto;\n      background-color: ",";\n    }\n  "])),s.polished.rem(16),s.polished.rem(14),s.polished.rem(13),t.colors.palette.dark[800],t.colors.palette.dark[600],s.polished.rem(160),t.colors.palette.light[200])}var A,R=n(14),z=function(){return(z=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},U=z(z({},s.DataSourceTypes),R.ArcGISDataSourceTypes),P=n(1);function F(e,t,n){if(void 0===n&&(n=!0),!e||!t)return[];var a=H(e,t,n),o=s.DataSourceManager.getInstance().getDataSource(e);if(!o)return a;var r=[];return o.getDataViews().forEach((function(e){r=r.concat(H(e.id,t,n))})),Array.from(new Set(a.concat(r)))}function W(e,t){if(!e||!t)return[];var n=F(e,t),a=s.DataSourceManager.getInstance().getDataSource(e);if(!a)return n;var o=[];return a.isDataSourceSet&&a.getChildDataSources().forEach((function(e){o=o.concat(W(e.id,t))})),Array.from(new Set(n.concat(o)))}function H(e,t,n){if(void 0===n&&(n=!1),!e||!t)return[];var a=function(e,t){if(!e||!t)return[];return function(e){if(!e)return[];var t=[];return Object.keys(e).forEach((function(n){t.push(e[n])})),t}(t).filter((function(t){return t&&!1!==t.useDataSourcesEnabled&&t.useDataSources&&t.useDataSources.some((function(t){return t.dataSourceId===e}))})).map((function(e){return e.id}))}(e,t),o=n?function(e,t){if(!e||!t)return[];var n=G(s.DataSourceManager.getInstance().getDataSource(e)),a=[],o=[];return n.forEach((function(e){e&&e.id&&(o=F(e.id,t).map((function(e){return e.id})),a=a.concat(o))})),Array.from(new Set(a))}(e,t):[];return Array.from(new Set(a.concat(o))).map((function(e){return t[e]}))}function B(e){var t,n;if(!e)return[];var a=s.DataSourceManager.getInstance().getDataSource(e);if(!a)return[e];var o=[e];return null===(t=a.getDataViews())||void 0===t||t.forEach((function(e){return o=o.concat(e.id)})),a.isDataSourceSet&&(null===(n=a.getChildDataSources())||void 0===n||n.forEach((function(e){o=o.concat(B(e.id))}))),o}function J(e,t){return!!e&&(!t||e.toLocaleLowerCase().includes(t.toLocaleLowerCase()))}function q(e,t,n){return!(!e||!e.id)&&(!t&&!n||(t?n?t.includes(e.id)&&!n(e):t.includes(e.id):!n(e)))}function G(e){if(!e||!e.id)return[];var t=Q(),n=t&&t.dataSources,a=[];return n&&Object.keys(n).forEach((function(t){n[t]&&n[t].isOutputFromWidget&&n[t].originDataSources&&n[t].originDataSources.some((function(t){return t.dataSourceId===e.id}))&&(a=a.concat(s.DataSourceManager.getInstance().getDataSource(t)))})),a}function Q(){var e=window&&window.jimuConfig&&window.jimuConfig.isBuilder?Object(s.getAppStore)().getState().appStateInBuilder:Object(s.getAppStore)().getState();return e&&e.appConfig}function X(e){var t=e&&e.type,a=s.DataSourceManager.getInstance().getDataSource(null==e?void 0:e.id);switch(function(e,t,n){switch(e){case U.WebMap:case U.WebScene:case U.MapService:case U.FeatureService:case U.GroupLayer:case U.SceneService:case U.SceneLayer:return e;case U.FeatureLayer:return n?e+"_"+s.SupportedLayerServiceTypes.Table:t?e+"_"+t:e;default:return"UNKNOWN"}}(t,function(e){if(e){if(e.toLowerCase().includes(A.Point.toLowerCase()))return A.Point;if(e.toLowerCase().includes(A.Polyline.toLowerCase()))return A.Polyline;if(e.toLowerCase().includes(A.Polygon.toLowerCase()))return A.Polygon}return null}(a?a.getGeometryType():null==e?void 0:e.geometryType),function(e){var t;if(!e)return!1;var n=s.DataSourceManager.getInstance().getDataSource(e.id);return n&&n.getLayerDefinition&&(null===(t=n.getLayerDefinition())||void 0===t?void 0:t.type)===s.SupportedLayerServiceTypes.Table}(e))){case U.WebMap:return n(167);case U.WebScene:return n(168);case U.FeatureLayer+"_"+A.Point:return n(252);case U.FeatureLayer+"_"+A.Polyline:return n(253);case U.FeatureLayer+"_"+A.Polygon:return n(254);case U.FeatureLayer+"_"+s.SupportedLayerServiceTypes.Table:return n(255);case""+U.FeatureLayer:return n(169);case""+U.FeatureService:return n(256);case""+U.MapService:return n(257);case""+U.GroupLayer:return n(258);case U.SceneService:return n(259);case U.SceneLayer:return n(260);default:return n(261)}}function K(e,t){if(!e||!t)return"";switch(e){case U.FeatureLayer:return t.formatMessage({id:"featureLayer",defaultMessage:P.defaultMessages.featureLayer});case U.FeatureService:return t.formatMessage({id:"featureService",defaultMessage:P.defaultMessages.featureService});case U.MapService:return t.formatMessage({id:"mapService",defaultMessage:P.defaultMessages.mapService});case U.GroupLayer:return t.formatMessage({id:"groupLayer",defaultMessage:P.defaultMessages.groupLayer});case U.Map:return t.formatMessage({id:"map",defaultMessage:P.defaultMessages.map});case U.SimpleLocal:return t.formatMessage({id:"simpleLocal",defaultMessage:P.defaultMessages.simpleLocal});case U.WebMap:return t.formatMessage({id:"webMap",defaultMessage:P.defaultMessages.webMap});case U.WebScene:return t.formatMessage({id:"webScene",defaultMessage:P.defaultMessages.webScene});case U.CSV:return t.formatMessage({id:"csv",defaultMessage:P.defaultMessages.csv});case U.SceneService:return t.formatMessage({id:"sceneService",defaultMessage:P.defaultMessages.sceneService});case U.SceneLayer:return t.formatMessage({id:"sceneLayer",defaultMessage:P.defaultMessages.sceneLayer});default:return""}}function Y(e,t){if(!e)return!0;if(t&&Object.keys(t).filter((function(e){return 1===e.split("-").length})).length>Object.keys(e).length)return!1;return Object.keys(e).every((function(e){var n,a;return(null===(n=t[e])||void 0===n?void 0:n.instanceStatus)===s.DataSourceStatus.Created||(null===(a=t[e])||void 0===a?void 0:a.instanceStatus)===s.DataSourceStatus.CreateError}))}function Z(e){var t=s.DataSourceManager.getInstance().getDataSource(null==e?void 0:e.id);if(!t||!e)return null;for(var n=t,a=e;n.parentDataSource;)a=n.parentDataSource.getDataSourceJson().setIn(["childDataSourceJsons",n.jimuChildId],a),n=n.parentDataSource;return function e(t){var n,a=s.DataSourceManager.getInstance().getDataSource(null==t?void 0:t.id);if(!a||!t)return null;var o=t,r=!!o.isHidden;a.isDataSourceSet&&(null===(n=a.getChildDataSources())||void 0===n?void 0:n.length)>0&&a.getChildDataSources().forEach((function(t){var n=o.getIn(["childDataSourceJsons",t.jimuChildId])||(null==t?void 0:t.getDataSourceJson());n&&(r&&(n=n.set("isHidden",!0)),o=o.setIn(["childDataSourceJsons",t.jimuChildId],e(n)))}));return o}(a)}function $(e){var t,n;if(!e)return null;if(e.itemId&&e.portalUrl)return e.portalUrl.replace(/\/$/,"")+"/home/item.html?id="+e.itemId;if(e.url){if(!!(null===(t=s.ServiceManager.getInstance().getServerInfoByServiceUrl(e.url))||void 0===t?void 0:t.owningSystemUrl)){var a=null===(n=s.SessionManager.getInstance().getSessionByUrl(e.url))||void 0===n?void 0:n.token;return a?e.url+"?token="+a:""+e.url}return""+e.url}return null}function ee(e){var t,n=[],a=Q(),o=null==a?void 0:a.widgets;if(o){var r=null===(t=o[e])||void 0===t?void 0:t.outputDataSources;r&&r.length>0&&(n=n.concat(e),r.forEach((function(e){Object.keys(o).forEach((function(t){var a,r;(null===(r=null===(a=o[t])||void 0===a?void 0:a.useDataSources)||void 0===r?void 0:r.some((function(t){return t.mainDataSourceId===e})))&&(n=n.concat(ee(t)))}))})))}return n}!function(e){e.Point="POINT",e.Polyline="POLYLINE",e.Polygon="POLYGON"}(A||(A={}));var te,ne=n(13),ae=n(35),oe=function(){return(oe=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},re=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function i(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((a=a.apply(e,t||[])).next())}))},se=function(e,t){var n,a,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function i(r){return function(i){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,i])}}};function ie(e,t){switch(e){case te.SceneLayerWithoutAssociatedLayer:return null==t?void 0:t.formatMessage({id:"addDataErrorInvalidSceneLayer",defaultMessage:P.defaultMessages.addDataErrorInvalidSceneLayer});default:return null==t?void 0:t.formatMessage({id:"invalidResourceItem",defaultMessage:s.defaultMessages.invalidResourceItem})}}function le(e,t,n){return re(this,void 0,void 0,(function(){var a,o=this;return se(this,(function(r){switch(r.label){case 0:return e&&t&&e.type&&(e.type===ne.ItemTypes.WebMap||e.type===ne.ItemTypes.WebScene)?[3,2]:[4,Promise.reject(te.ItemInaccessible)];case 1:return[2,r.sent()];case 2:return a={authentication:s.SessionManager.getInstance().getSessionByUrl(n)},[4,s.esri.restPortal.getItemData(e.id,a).then((function(a){return re(o,void 0,void 0,(function(){var o;return se(this,(function(r){switch(r.label){case 0:return a?[4,de(o=function(e,t,n){if(!e||e.type!==ne.ItemTypes.WebMap&&e.type!==ne.ItemTypes.WebScene)return null;return Object(s.Immutable)({type:e.type===ne.ItemTypes.WebMap?U.WebMap:U.WebScene,itemId:e.id,id:t,portalUrl:n})}(e,t,n),null,a,e).then((function(e){return{dsJson:o,dataSchema:e}}))]:[2,null];case 1:return[2,r.sent()]}}))}))}))];case 3:return[2,r.sent()]}}))}))}function ce(e,t,n){return re(this,void 0,void 0,(function(){var a,o=this;return se(this,(function(r){switch(r.label){case 0:return e&&t&&e.type&&e.type===ne.ItemTypes.FeatureCollection?[3,2]:[4,Promise.reject(te.ItemInaccessible)];case 1:return[2,r.sent()];case 2:return a={authentication:s.SessionManager.getInstance().getSessionByUrl(n)},[4,s.esri.restPortal.getItemData(e.id,a).then((function(a){return re(o,void 0,void 0,(function(){var o,r,i;return se(this,(function(l){switch(l.label){case 0:return a?[3,2]:[4,Promise.reject(te.ItemInaccessible)];case 1:return[2,l.sent()];case 2:return[4,de(o=1===(null===(r=a.layers)||void 0===r?void 0:r.length)?be(o=s.dataSourceUtils.getSingleDsJsonFromLayerDefinition(t,null,null===(i=a.layers[0])||void 0===i?void 0:i.layerDefinition),n,e.id):Object(s.Immutable)({type:s.DataSourceTypes.GroupLayer,itemId:e.id,id:t,portalUrl:n}),null,a,e).then((function(e){return{dsJson:o,dataSchema:e}}))];case 3:return[2,l.sent()]}}))}))}))];case 3:return[2,r.sent()]}}))}))}function ue(e){return"ArcGISFeatureLayer"===(null==e?void 0:e.layerType)||(null==e?void 0:e.type)===ae.SupportedLayerServiceTypes.FeatureLayer}function de(e,t,n,a){return re(this,void 0,void 0,(function(){var o,r,i,l,c,u,d,p,h,f,m=this;return se(this,(function(g){switch(g.label){case 0:return e&&n?[3,2]:[4,Promise.reject(te.ItemInaccessible)];case 1:return[2,g.sent()];case 2:return o={id:e.id,label:a.title,type:e.type,parentSchema:t},r=a.type===ae.SupportedItemTypes.WebMap||a.type===ae.SupportedItemTypes.WebScene,i=a.type===ae.SupportedItemTypes.FeatureCollection,l=function(e,t,n){var a,o=n.type===ae.SupportedItemTypes.WebMap||n.type===ae.SupportedItemTypes.WebScene,r=n.type===ae.SupportedItemTypes.FeatureCollection,s=[];e.type===U.WebMap||e.type===U.WebScene?s=t.operationalLayers||[]:e.type===U.GroupLayer&&(s=r?(null===(a=t.layers)||void 0===a?void 0:a.map((function(e){return e.layerDefinition})))||[]:t.layers||[]);var i=Object.values(ae.SupportedServiceTypes).concat(Object.values(ae.SupportedLayerServiceTypes)).map((function(e){return e.replace(/\s+/g,"").toLowerCase().replace("server","service")}));return s.filter((function(e){var t;return!!(""+(null==e?void 0:e.id)||(null===(t=e)||void 0===t?void 0:t.title)||(null==e?void 0:e.name))&&(ue(e)?o&&(e.type===ae.SupportedItemTypes.FeatureCollection&&e.itemId||e.featureCollection)?"route"!==e.featureCollectionType&&"notes"!==e.featureCollectionType:!!r||!!e.url:e.layerType&&i.some((function(t){return e.layerType.toLowerCase().includes(t)})))}))}(e,n,a),c=n.tables||[],u=l.concat(c),d={},p={},h={},f={},u.forEach((function(e){var t,n,a;e.url?d[s.dataSourceUtils.getFixedLayerIdByLayer(e)]=e.url.replace(/^http:/,"https:"):ue(e)?r&&e.itemId?p[s.dataSourceUtils.getFixedLayerIdByLayer(e)]=e.itemId:r&&e.featureCollection?h[s.dataSourceUtils.getFixedLayerIdByLayer(e)]=null===(n=null===(t=e.featureCollection)||void 0===t?void 0:t.layers)||void 0===n?void 0:n.map((function(e){return e.layerDefinition})):i&&(h[s.dataSourceUtils.getFixedLayerIdByLayerDefinition(e)]=[e]):f[s.dataSourceUtils.getFixedLayerIdByLayer(e)]={id:e.id,name:e.title,type:(a=e.layerType,"GroupLayer"===a?ae.SupportedLayerServiceTypes.GroupLayer:"ArcGISFeatureLayer"===a?ae.SupportedLayerServiceTypes.FeatureLayer:null)}})),0===Object.keys(d).length&&0===Object.keys(f).length&&0===Object.keys(p).length&&0===Object.keys(h).length?[2,Promise.resolve(o)]:[2,Promise.allSettled([he(d,e.itemId,e.portalUrl),pe(p,e.portalUrl)]).then((function(e){var t=e[0],n=e[1],a="fulfilled"===t.status?t.value:{};Object.keys(a).forEach((function(e){var t,n=u.find((function(t){return s.dataSourceUtils.getFixedLayerIdByLayer(t)===e}));a[e].name=(null===(t=n)||void 0===t?void 0:t.title)||a[e].name}));var r="fulfilled"===n.status?n.value:{},i={},l={},c=oe(oe({},r),h);Object.keys(c).forEach((function(e){var t,n,a,o,r=u.find((function(t){return s.dataSourceUtils.getFixedLayerIdByLayer(t)===e}));1===(null===(t=c[e])||void 0===t?void 0:t.length)?i[e]=oe(oe({},c[e][0]),{name:(null===(n=r)||void 0===n?void 0:n.title)||c[e][0].name}):(null===(a=c[e])||void 0===a?void 0:a.length)>1&&(l[e]={id:r.id,name:null===(o=r)||void 0===o?void 0:o.title,type:ae.SupportedLayerServiceTypes.GroupLayer})}));var g=oe(oe(oe(oe({},i),l),a),f);return Object.keys(g).length>0?(o.childSchemas={},Promise.allSettled(Object.keys(g).map((function(e){return re(m,void 0,void 0,(function(){var t,n,a=this;return se(this,(function(r){switch(r.label){case 0:return d[e]?[4,ve(Se(e,d[e],g[e]),o,g[e],d[e])]:[3,2];case 1:return[2,r.sent()];case 2:return p[e]||h[e]?i[e]?(t=Se(e,null,i[e]),[4,Promise.resolve({id:t.id,label:i[e].name,type:t.type,parentSchema:o})]):[3,4]:[3,7];case 3:return[2,r.sent()];case 4:return l[e]?(t=Se(e,null,l[e]),n={id:t.id,label:l[e].name,type:t.type,parentSchema:o,childSchemas:{}},[4,Promise.resolve(n)]):[3,6];case 5:return[2,r.sent()];case 6:return[3,8];case 7:if(f[e])return[2,fe(u.find((function(t){return s.dataSourceUtils.getFixedLayerIdByLayer(t)===e}))).then((function(t){return re(a,void 0,void 0,(function(){return se(this,(function(n){switch(n.label){case 0:return[4,de(Se(e,d[e],g[e]),o,t,t)];case 1:return[2,n.sent()]}}))}))}))];r.label=8;case 8:return[2]}}))}))}))).then((function(e){return e.forEach((function(e){var t="fulfilled"===e.status?e.value:null;t&&(o.childSchemas[t.id]=t)})),o}))):o}))]}}))}))}function pe(e,t){return re(this,void 0,void 0,(function(){var n,a,o=this;return se(this,(function(r){switch(r.label){case 0:return e&&0!==Object.keys(e).length?[3,2]:[4,Promise.resolve({})];case 1:return[2,r.sent()];case 2:return n={authentication:s.SessionManager.getInstance().getSessionByUrl(t)},a=Object.keys(e),[4,Promise.allSettled(a.map((function(t){return re(o,void 0,void 0,(function(){return se(this,(function(a){switch(a.label){case 0:return[4,s.esri.restPortal.getItemData(e[t],n)];case 1:return[2,a.sent()]}}))}))}))).then((function(e){var t={};return e.forEach((function(e,n){var o,r="fulfilled"===e.status?e.value:null;r&&(t[a[n]]=null===(o=r.layers)||void 0===o?void 0:o.map((function(e){return null==e?void 0:e.layerDefinition})))})),t}))];case 3:return[2,r.sent()]}}))}))}function he(e,t,n){return re(this,void 0,void 0,(function(){var a,o,r;return se(this,(function(i){switch(i.label){case 0:return e&&0!==Object.keys(e).length?[3,2]:[4,Promise.resolve({})];case 1:return[2,i.sent()];case 2:return a={},o={},Object.keys(e).forEach((function(t){s.dataSourceUtils.isSupportedSingleLayerService(e[t])?a[t]=e[t]:s.dataSourceUtils.isSupportedWholeService(e[t])&&(o[t]=e[t])})),r=oe(oe({},a),o),[2,Promise.allSettled([s.dataSourceUtils.fetchSupportedLayerDefinitionsFromUrls(Object.values(a),t,n),me(Object.values(o))]).then((function(e){var t="fulfilled"===e[0].status?e[0].value:{},n="fulfilled"===e[1].status?e[1].value:{},a=oe(oe({},t),n),o={};return Object.keys(r).forEach((function(e){a[r[e]]&&(o[e]=oe(oe({},a[r[e]]),{url:r[e]}))})),o}))]}}))}))}function fe(e){return re(this,void 0,void 0,(function(){return se(this,(function(t){switch(t.label){case 0:return(null==e?void 0:e.layers)?[4,me(e.layers.map((function(e){var t;return null===(t=e.url)||void 0===t?void 0:t.replace(/^http:/,"https:")}))).then((function(t){return oe(oe({},e),{layers:e.layers.map((function(e){var n,a=t[null===(n=e.url)||void 0===n?void 0:n.replace(/^http:/,"https:")],o=s.dataSourceUtils.getFixedLayerIdByLayerDefinition(a)||e.id;return oe(oe({},e),{id:o})}))})}))]:[3,2];case 1:return[2,t.sent()];case 2:return[2,Promise.resolve(e)]}}))}))}function me(e){return re(this,void 0,void 0,(function(){var t=this;return se(this,(function(n){switch(n.label){case 0:return e&&0!==e.length?[3,2]:[4,Promise.resolve({})];case 1:return[2,n.sent()];case 2:return[4,Promise.allSettled(e.map((function(e){return re(t,void 0,void 0,(function(){return se(this,(function(t){switch(t.label){case 0:return[4,s.ServiceManager.getInstance().fetchServiceInfo(e).then((function(e){return e.definition}))];case 1:return[2,t.sent()]}}))}))}))).then((function(t){var n,a={};return t.forEach((function(t,o){var r="fulfilled"===t.status?t.value:null;r&&(n=e[o],a[n]=r)})),a}))];case 3:return[2,n.sent()]}}))}))}function ge(e,t,n,a,o){return re(this,void 0,void 0,(function(){var r=this;return se(this,(function(i){switch(i.label){case 0:return e&&t?[3,2]:[4,Promise.reject(te.ItemInaccessible)];case 1:return[2,i.sent()];case 2:return e=e.replace(/^http:/,"https:"),[4,s.ServiceManager.getInstance().fetchServiceInfo(e).then((function(i){return re(r,void 0,void 0,(function(){var r,l,c=this;return se(this,(function(u){switch(u.label){case 0:return(r=i.definition)?[3,2]:[4,Promise.reject(te.ItemInaccessible)];case 1:return[2,u.sent()];case 2:return l=be(l=Se(t,e,r),a,o),[4,new Promise((function(e,t){return l.type===s.DataSourceTypes.SceneLayer?s.dataSourceUtils.fetchAssociatedFeatureLayerUrl(l.url,l.layerId,l.itemId,l.portalUrl).then((function(n){return n?e(null):t(te.SceneLayerWithoutAssociatedLayer)})):e(null)})).then((function(){return re(c,void 0,void 0,(function(){return se(this,(function(t){switch(t.label){case 0:return[4,ve(l,null,r,e,n).then((function(e){return{dsJson:l,dataSchema:e}}))];case 1:return[2,t.sent()]}}))}))}))];case 3:return[2,u.sent()]}}))}))}))];case 3:return[2,i.sent()]}}))}))}function ve(e,t,n,a,o){return re(this,void 0,void 0,(function(){var r,i=this;return se(this,(function(l){switch(l.label){case 0:return e&&n?[3,2]:[4,Promise.reject(te.ItemInaccessible)];case 1:return[2,l.sent()];case 2:return r={id:e.id,label:o||n.name||s.dataSourceUtils.getServiceLabelFromUrl(a),type:e.type,parentSchema:t},[4,s.dataSourceUtils.fetchSupportedLayerDefinitions(e.url,n).then((function(e){return Object.keys(e).length>0?(r.childSchemas={},Promise.allSettled(Object.keys(e).map((function(t){return re(i,void 0,void 0,(function(){var n,a;return se(this,(function(o){switch(o.label){case 0:return[4,ve(Se(s.dataSourceUtils.fixLayerId(""+((null===(n=e[t])||void 0===n?void 0:n.name)||(null===(a=e[t])||void 0===a?void 0:a.id))),t,e[t]),r,e[t],t)];case 1:return[2,o.sent()]}}))}))}))).then((function(e){return e.forEach((function(e){var t="fulfilled"===e.status?e.value:null;t&&(r.childSchemas[t.id]=t)})),r}))):r}))];case 3:return[2,l.sent()]}}))}))}function Se(e,t,n){return e&&n?((t||n.type!==ae.SupportedLayerServiceTypes.GroupLayer)&&(t||n.type!==ae.SupportedLayerServiceTypes.FeatureLayer&&n.type!==ae.SupportedLayerServiceTypes.Table)?s.dataSourceUtils.isSupportedSingleLayerService(t)?a=s.dataSourceUtils.getSingleDsJsonFromLayerDefinition(e,t,n):s.dataSourceUtils.isSupportedWholeService(t)&&(a=s.dataSourceUtils.getSingleDsJsonFromWholeServiceDefinition(e,t,n)):a=s.dataSourceUtils.getSingleDsJsonFromLayerDefinition(e,t,n),a):null;var a}function be(e,t,n){return e?(t&&(e=e.set("portalUrl",t)),n&&(e=e.set("itemId",n)),e):null}function ye(e,t){if(!e)return null;t||(t=Object(s.Immutable)({}));var n=t.set("isHidden",!!e.isHidden).set("type",e.type).set("id",function(e){if(!e)return null;for(var t=e.id;e.parentSchema;)t=s.dataSourceUtils.getChildDataSourceId(e.parentSchema.id,t),e=e.parentSchema;return t}(e));return e.childSchemas&&Object.keys(e.childSchemas).map((function(t){n.getIn(["childDataSourceJsons"])||(n=n.setIn(["childDataSourceJsons"],{}));var a=e.childSchemas[t].id;n=n.setIn(["childDataSourceJsons",a],ye(e.childSchemas[t],null==n?void 0:n.childDataSourceJsons[a]))})),n}function we(e){if(!e)return null;for(var t=e;t.parentSchema;)t=t.parentSchema;return t}function De(e,t){return e?ye(we(function e(t,n){if(!t)return null;var a=t;return a.isHidden=!!n,a.childSchemas&&Object.keys(a.childSchemas).map((function(t){a.childSchemas[t]=e(a.childSchemas[t],n)})),a}(e,!0)),t):null}function xe(e,t){return e?ye(we(function e(t,n){if(!t)return null;var a=t;return a.isHidden=!!n,a.parentSchema&&(a.parentSchema=e(a.parentSchema,n)),a}(e,!1)),t):null}!function(e){e.ItemInaccessible="ITEM_INACCESSIBLE",e.SceneLayerWithoutAssociatedLayer="SCENE_LAYER_WITHOUT_ASSOCIATED_LAYER"}(te||(te={}));var je,Ie,Oe,Me,Ce,Ne,Te=(je=function(e,t){return(je=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}je(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),_e=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function i(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((a=a.apply(e,t||[])).next())}))},ke=function(e,t){var n,a,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function i(r){return function(i){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,i])}}},Ve=null,Ee=function(e){function t(t){var n=e.call(this,t)||this;return n.__unmounted=!1,n.dataSourceUrlTypes=[{label:n.props.intl.formatMessage({id:"anArcGISServerWebService",defaultMessage:P.defaultMessages.anArcGISServerWebService})}],n.onUrlTypesClicked=function(e){n.setState({selectedDataSourceUrlType:e.target.value})},n.onInputUrl=function(e){var t=!1;(/^https:\/\//.test(e.target.value)||/^\/\//.test(e.target.value))&&s.dataSourceUtils.isSupportedService(e.target.value)&&(t=!0),n.setState({url:e.target.value,isSupported:t})},n.onAdded=function(){return _e(n,void 0,void 0,(function(){var e,t=this;return ke(this,(function(n){switch(n.label){case 0:return this.state.url?(e=this.state.url.split("?")[0])?(this.props.toggleLoadStatus(!1),[4,ge(e,this.props.getDsId()).then((function(e){t.changeDsJsons(e),t.props.toggleLoadStatus(!0)}),(function(e){console.error(e),t.props.toggleToastStatus(!0,e),t.props.toggleLoadStatus(!0)}))]):[2]:[3,2];case 1:return[2,n.sent()];case 2:return[2]}}))}))},n.changeDsJsons=function(e){(null==e?void 0:e.dsJson)?(n.props.onAdded(e),n.setState({isSupported:!0})):n.setState({isSupported:!1})},n.state={selectedDataSourceUrlType:n.dataSourceUrlTypes[0],url:"",isSupported:!0,selectDataHelpUrl:null},n}return Te(t,e),t.prototype.componentDidMount=function(){var e=this;this.__unmounted=!1,Ve||(Ve=s.moduleLoader.loadModule("jimu-for-builder").then((function(e){return e.helpUtils})).then((function(e){return e.getBuildAppsHelpLink("select-data")}))),Ve.then((function(t){e.__unmounted||e.setState({selectDataHelpUrl:t})}))},t.prototype.componentWillUnmount=function(){this.__unmounted=!0},t.prototype.render=function(){return s.React.createElement("div",{className:"external-data-source-url-input"},s.React.createElement("div",{className:"mt-3 ml-2"},s.React.createElement("h5",{className:"url-input-label"},this.props.intl.formatMessage({id:"serviceType",defaultMessage:P.defaultMessages.serviceType})),s.React.createElement(P.Select,{value:this.state.selectedDataSourceUrlType.label,title:this.state.selectedDataSourceUrlType.label,onChange:this.onUrlTypesClicked,className:"url-type-select",buttonProps:{className:"text-truncate"}},this.dataSourceUrlTypes.map((function(e){return s.React.createElement("option",{key:e.label,value:e.label},e.label)})))),s.React.createElement("div",{className:"mt-4 ml-2"},s.React.createElement("h5",{className:"url-input-label"},this.props.intl.formatMessage({id:"url",defaultMessage:P.defaultMessages.url})),s.React.createElement(P.TextInput,{placeholder:"URL",onChange:this.onInputUrl,className:"url-input",value:this.state.url}),s.React.createElement("div",{className:"d-flex"},s.React.createElement("p",{className:"mt-2 hint-label"},this.props.intl.formatMessage({id:"addDataByUrlHint",defaultMessage:P.defaultMessages.addDataByUrlHint})),this.state.selectDataHelpUrl&&s.React.createElement(P.Link,{to:this.state.selectDataHelpUrl,className:"ml-2 font-size-12",target:"_blank"},this.props.intl.formatMessage({id:"details",defaultMessage:P.defaultMessages.details})))),s.React.createElement("div",{className:"mt-3 ml-2"},s.React.createElement(P.Button,{onClick:this.onAdded,type:"primary",disabled:!this.state.url||!this.state.isSupported,className:"url-input-add-btn px-3"},this.props.intl.formatMessage({id:"add",defaultMessage:P.defaultMessages.add}))))},t}(s.React.PureComponent),Le=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Ae=function(){return(Ae=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Re=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function i(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((a=a.apply(e,t||[])).next())}))},ze=function(e,t){var n,a,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function i(r){return function(i){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,i])}}},Ue=n(262),Pe=n(36),Fe=n(91),We=n(92),He=function(e){function t(t){var n,a,o,r,i=e.call(this,t)||this;return i.__unmount=!1,i.itemCategory=((n={})[ne.ItemCategory.MyContent]=i.props.intl.formatMessage({id:"myContent",defaultMessage:P.defaultMessages.myContent}),n[ne.ItemCategory.MyGroup]=i.props.intl.formatMessage({id:"myGroup",defaultMessage:P.defaultMessages.myGroup}),n[ne.ItemCategory.MyOrganization]=i.props.intl.formatMessage({id:"myOrganization",defaultMessage:P.defaultMessages.myOrganization}),n[ne.ItemCategory.Public]=i.props.intl.formatMessage({id:"public",defaultMessage:P.defaultMessages.public}),n[ne.ItemCategory.LivingAtlas]=i.props.intl.formatMessage({id:"livingAtlas",defaultMessage:P.defaultMessages.livingAtlas}),n),i.sortField=((a={})[ne.SortField.Modified]=i.props.intl.formatMessage({id:"modified",defaultMessage:P.defaultMessages.modified}),a[ne.SortField.Title]=i.props.intl.formatMessage({id:"title",defaultMessage:P.defaultMessages.title}),a[ne.SortField.Views]=i.props.intl.formatMessage({id:"numViews",defaultMessage:P.defaultMessages.numViews}),a),i.defaultSelectedFolder={id:null,title:i.props.intl.formatMessage({id:"allMyContent",defaultMessage:P.defaultMessages.allMyContent})},i.rootFolder={id:"root",title:(null===(r=null===(o=Object(s.getAppStore)().getState())||void 0===o?void 0:o.user)||void 0===r?void 0:r.username)||i.props.intl.formatMessage({id:"rootFolder",defaultMessage:P.defaultMessages.rootFolder})},i.defaultFolders=[i.defaultSelectedFolder,i.rootFolder],i.defaultSelectedGroup={id:null,title:i.props.intl.formatMessage({id:"allMyGroupsContent",defaultMessage:P.defaultMessages.allMyGroupsContent})},i.onCategoryChange=function(e){i.setState({selectedCategory:e})},i.onSearchInputKeyDown=function(e){13===e.which?i.enterOrSearchIsClicked():i.enterOrSearchIsUnclicked()},i.enterOrSearchIsClicked=function(){i.setState({isEnterOrSearchIconClicked:!0})},i.enterOrSearchIsUnclicked=function(){i.setState({isEnterOrSearchIconClicked:!1})},i.clearSearch=function(){i.setSearchValue(""),i.enterOrSearchIsUnclicked()},i.setSearchValue=function(e){i.setState({searchValue:e})},i.onSearchChange=function(e){i.debounceSetSearchValue(e.target.value)},i.onSortFieldChange=function(e){var t=e.target.value;i.setState({sortField:t})},i.onFolderChange=function(e){var t=e.target.value,n=i.state.folders.find((function(e){return e.id===t}))||i.defaultSelectedFolder;i.setState({selectedFolder:n})},i.onGroupChange=function(e){var t=e.target.value,n=i.state.groups.find((function(e){return e.id===t}))||i.defaultSelectedGroup;i.setState({selectedGroup:n})},i.onSortOrderChange=function(){i.setState({sortOrder:i.state.sortOrder===ne.SortOrder.Desc?ne.SortOrder.Asc:ne.SortOrder.Desc})},i.onItemAdded=function(e,t){i.props.onSelect(e,t)},i.onItemRemoved=function(e,t){i.props.onRemove(e,t)},i.debounceSetSearchValue=s.lodash.debounce((function(e){return i.setSearchValue(e)}),500),i.state={searchValue:"",sortField:ne.SortField.Modified,sortOrder:ne.SortOrder.Desc,isEnterOrSearchIconClicked:!1,selectedCategory:ne.ItemCategory.MyContent,selectedFolder:i.defaultSelectedFolder,selectedGroup:i.defaultSelectedGroup,appServices:null,folders:i.defaultFolders,groups:[i.defaultSelectedGroup]},i}return Le(t,e),t.prototype.componentDidMount=function(){var e=this;this.__unmount=!1,this.setState({groups:this.getGroups()}),s.moduleLoader.loadModule("jimu-for-builder/service").then((function(t){e.__unmount||e.setState({appServices:t.appServices},(function(){e.getFolders().then((function(t){return!e.__unmount&&e.setState({folders:t})}))}))}))},t.prototype.componentWillUnmount=function(){this.__unmount=!0},t.prototype.getGroups=function(){var e,t,n=null===(t=null===(e=Object(s.getAppStore)())||void 0===e?void 0:e.getState())||void 0===t?void 0:t.user;return(null==n?void 0:n.groups)?[this.defaultSelectedGroup].concat(n.groups.asMutable({deep:!0})):[this.defaultSelectedGroup]},t.prototype.getFolders=function(){var e,t;return Re(this,void 0,void 0,(function(){var n;return ze(this,(function(a){return n=this.defaultFolders,(null===(t=null===(e=this.state)||void 0===e?void 0:e.appServices)||void 0===t?void 0:t.getFolders)?[2,this.state.appServices.getFolders({num:1}).then((function(e){return n=e?n.concat(e):n}),(function(e){return console.log("Getting user content failed: ",e),n}))]:[2,Promise.resolve(n)]}))}))},t.prototype.render=function(){var e=this,t=Object(s.getAppStore)().getState().portalSelf,n=Ae({},ne.ItemCategory);return(null==t?void 0:t.livingAtlasGroupQuery)||delete n.LivingAtlas,s.React.createElement("div",{className:"external-data-source-item-selector w-100 h-100"},Object.keys(n).map((function(t,a){var o,r;return s.React.createElement("div",{className:Object(s.classNames)("h-100 w-100",{"d-none":ne.ItemCategory[t]!==e.state.selectedCategory}),key:a},s.React.createElement("div",{className:"w-100 d-flex justify-content-between align-items-end"},s.React.createElement(P.Nav,{underline:!0},Object.keys(n).map((function(t){return s.React.createElement(P.NavItem,{key:t,title:e.itemCategory[ne.ItemCategory[t]],className:Object(s.classNames)({"active-tab":e.state.selectedCategory===ne.ItemCategory[t]})},s.React.createElement(P.NavLink,{onClick:function(){e.onCategoryChange(ne.ItemCategory[t])},active:e.state.selectedCategory===ne.ItemCategory[t],className:"w-100 text-truncate"},e.itemCategory[ne.ItemCategory[t]]))}))),s.React.createElement("div",{className:"flex-grow-1 d-flex justify-content-end"},s.React.createElement("div",{className:"item-selector-search"},s.React.createElement(P.Button,{type:"tertiary",className:"search-icon",onClick:e.enterOrSearchIsClicked,icon:!0},s.React.createElement(P.Icon,{width:16,height:16,icon:Ue})),s.React.createElement(P.TextInput,{onKeyDown:e.onSearchInputKeyDown,placeholder:e.props.intl.formatMessage({id:"search",defaultMessage:s.defaultMessages.search}),onChange:e.onSearchChange,className:"search-input",value:e.state.searchValue}),e.state.searchValue&&s.React.createElement(P.Button,{type:"tertiary",className:"close-icon",onClick:e.clearSearch,icon:!0},s.React.createElement(P.Icon,{width:16,height:16,icon:Pe}))))),s.React.createElement("div",{className:"d-flex justify-content-between mt-30 mb-20"},s.React.createElement("div",null,e.state.selectedCategory===ne.ItemCategory.MyContent&&s.React.createElement(P.Select,{value:""+e.state.selectedFolder.id,title:e.state.selectedFolder.title,onChange:e.onFolderChange,className:"d-inline-block item-selector-sort-select",buttonProps:{className:"text-truncate"}},e.state.folders.map((function(e){return s.React.createElement("option",{key:e.id,value:""+e.id},e.title)}))),e.state.selectedCategory===ne.ItemCategory.MyGroup&&s.React.createElement(P.Select,{value:""+e.state.selectedGroup.id,title:e.state.selectedGroup.title,onChange:e.onGroupChange,className:"d-inline-block item-selector-sort-select",buttonProps:{className:"text-truncate"}},e.state.groups.map((function(e){return s.React.createElement("option",{key:e.id,value:""+e.id},e.title)})))),s.React.createElement("div",{className:"d-flex justify-content-between align-items-center item-selector-sort"},s.React.createElement("div",{className:"item-selector-sort-by"},s.React.createElement("div",{className:"d-inline-block mr-2"},e.props.intl.formatMessage({id:"sortBy",defaultMessage:P.defaultMessages.sortBy})),s.React.createElement(P.Select,{value:e.state.sortField,title:e.sortField[ne.SortField[e.state.sortField]],onChange:e.onSortFieldChange,className:"d-inline-block item-selector-sort-select",buttonProps:{className:"text-truncate"}},Object.keys(ne.SortField).map((function(t){return s.React.createElement("option",{key:ne.SortField[t],value:ne.SortField[t]},e.sortField[ne.SortField[t]])})))),s.React.createElement("div",{className:"item-selector-sort-order"},e.state.sortOrder===ne.SortOrder.Desc?s.React.createElement(P.Button,{type:"tertiary",onClick:e.onSortOrderChange,title:e.props.intl.formatMessage({id:"decending",defaultMessage:P.defaultMessages.decending})},s.React.createElement(P.Icon,{width:16,height:16,icon:Fe})):s.React.createElement(P.Button,{type:"tertiary",onClick:e.onSortOrderChange,title:e.props.intl.formatMessage({id:"ascending",defaultMessage:P.defaultMessages.ascending})},s.React.createElement(P.Icon,{width:16,height:16,icon:We}))))),s.React.createElement("div",{className:"w-100 item-selector-container"},s.React.createElement(ne.ItemSelector,{category:ne.ItemCategory[t],portalUrl:e.props.portalUrl,searchValue:e.state.searchValue.length>2||0===e.state.searchValue.length||e.state.isEnterOrSearchIconClicked?e.state.searchValue:"",itemType:e.props.itemType,getDetailPosition:e.props.getItemDetailPosition,selectedItems:e.props.selectedItems,sortField:e.state.sortField,onSelect:e.onItemAdded,onRemove:e.onItemRemoved,isRadio:e.props.isRadio,partSelectedItems:e.props.partSelectedItems,sortOrder:e.state.sortOrder,folderId:null===(o=e.state.selectedFolder)||void 0===o?void 0:o.id,groupId:null===(r=e.state.selectedGroup)||void 0===r?void 0:r.id})))})))},t}(s.React.PureComponent),Be=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Je=function(){return(Je=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},qe=n(126),Ge=n(127),Qe=function(e){function t(n){var a=e.call(this,n)||this;return a.toggleChildDss=function(){a.setState({isOpen:!a.state.isOpen})},a.drawCollapseLine=function(){var e,t;if(a.collapseRef&&a.lastNodeInCollapseRef){var n=a.lastNodeInCollapseRef.querySelector("#"+a.getUniqueId())||a.lastNodeInCollapseRef,o=window&&(null===(e=window.getComputedStyle(a.lastNodeInCollapseRef))||void 0===e?void 0:e.paddingTop),r=o?parseFloat(o)+2:0,s=window&&(null===(t=window.getComputedStyle(n))||void 0===t?void 0:t.paddingTop),i=s?parseFloat(s):0;a.setState({heightOfCollapseExceptForLastNode:a.collapseRef.offsetHeight-a.lastNodeInCollapseRef.offsetHeight+r,heightOfFirstNodeOfLastNodeInCollapse:n.offsetHeight-i})}a.props.drawCollapseLine&&a.props.drawCollapseLine()},a.getUniqueId=function(){return"first_node_in_collapse-"+t.count},a.getSelectableChildNodes=function(e){return e?(a.props.getChildDataSources(e)||[]).filter((function(e){return a.props.isNodeSelectable(e)})):[]},a.getChildNodes=function(e){return e?(a.props.getChildDataSources(e)||[]).filter((function(e){return a.props.isNodeSelectable(e)||a.getChildNodes(e).length>0})):[]},a.getLabel=function(){var e=a.props.getLabel(a.props.dataSource)||a.props.dataSource.id;return a.props.label?a.props.label+" / "+e:e},a.getHideLineStyle=function(){return{height:a.state.heightOfCollapseExceptForLastNode+a.state.heightOfFirstNodeOfLastNodeInCollapse/2+"px"}},a.getWhetherUnselectableParentAndChildNodeCanJoin=function(){var e=a.getChildNodes(a.props.dataSource);return!(a.getSelectableChildNodes(a.props.dataSource).length>0)&&1===e.length},a.getRenderContent=function(){if(!a.props.dataSource)return null;var e=a.getChildNodes(a.props.dataSource),t=e.length>0,n=a.props.isNodeSelectable(a.props.dataSource);if(!n&&!t)return null;var o=a.getSelectableChildNodes(a.props.dataSource).length>0,r=a.getLabel(),i=a.getWhetherUnselectableParentAndChildNodeCanJoin(),l=!a.props.isChildTree&&i,c=e&&e.map((function(t,n){return t&&t.id?s.React.createElement("div",{key:t.id,ref:function(t){return n===e.length-1?a.lastNodeInCollapseRef=t:void 0},className:Object(s.classNames)({"pt-3":0!==n})},a.props.getChildDataSources(t).length>0?s.React.createElement(Xe,Je({},a.props,{dataSource:t,label:i?r:"",drawCollapseLine:a.drawCollapseLine,isChildTree:!l})):s.React.createElement("div",{className:"d-flex align-items-center"},s.React.createElement("div",{className:Object(s.classNames)("collapse-button leaf")}),s.React.createElement("div",{className:Object(s.classNames)("d-flex align-items-center w-100")},a.props.renderSelectableNode&&a.props.renderSelectableNode(t)))):null}));return o||n||!i?s.React.createElement("div",null,s.React.createElement("div",{className:"d-flex align-items-center"},s.React.createElement("div",{className:Object(s.classNames)("collapse-button",{root:!a.props.isChildTree})},t&&s.React.createElement(P.Button,{type:"tertiary",icon:!0,size:"sm",onClick:a.toggleChildDss,className:"w-10 px-0 d-flex align-items-center",title:a.state.isOpen?a.props.intl.formatMessage({id:"close",defaultMessage:s.defaultMessages.close}):a.props.intl.formatMessage({id:"open",defaultMessage:s.defaultMessages.open})},s.React.createElement(P.Icon,{icon:a.state.isOpen?qe:Ge,size:"12"}))),s.React.createElement("div",{className:Object(s.classNames)("d-flex align-items-center w-100"),id:a.getUniqueId()},n?a.props.renderSelectableNode&&a.props.renderSelectableNode(a.props.dataSource):a.props.renderUnselectableNode&&a.props.renderUnselectableNode(r,a.props.dataSource))),t&&s.React.createElement(P.Collapse,{isOpen:a.state.isOpen,className:"collapse-content",innerRef:function(e){return a.collapseRef=e},onEntering:a.drawCollapseLine,onExiting:a.drawCollapseLine,onEntered:a.drawCollapseLine,onExited:a.drawCollapseLine},c,s.React.createElement("div",{className:Object(s.classNames)("collapse-line",{root:!a.props.isChildTree}),style:a.getHideLineStyle()}))):t?s.React.createElement("div",null,c):null},t.count++,a.state={isOpen:!1,heightOfFirstNodeOfLastNodeInCollapse:0,heightOfCollapseExceptForLastNode:0},a}return Be(t,e),t.prototype.componentDidMount=function(){this.drawCollapseLine()},t.prototype.componentDidUpdate=function(e){this.props.isNodeSelectable!==e.isNodeSelectable&&this.drawCollapseLine()},t.prototype.render=function(){var e,t=this.getWhetherUnselectableParentAndChildNodeCanJoin(),n=!this.props.isChildTree&&t,a=!this.props.isChildTree&&!n;return s.React.createElement("div",{className:Object(s.classNames)("w-100 h-100",(e={},e[this.props.className]=!!this.props.className,e))},s.React.createElement("div",{className:Object(s.classNames)("component-data-source-tree",{bg:this.props.useDefaultBackground&&a&&this.state.isOpen,"tree-root":a})},this.getRenderContent()))},t.count=-1,t}(s.React.PureComponent),Xe=Object(s.injectIntl)(s.themeUtils.withStyles(Qe,"DataSourceTree")),Ke=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Ye=function(){return(Ye=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ze=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function i(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((a=a.apply(e,t||[])).next())}))},$e=function(e,t){var n,a,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function i(r){return function(i){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,i])}}},et=n(263),tt=n(36),nt=n(170),at=n(171),ot=n(59),rt=n(93);!function(e){e.WebMap="Web Map",e.WebScene="Web Scene",e.Layers="Layers",e.Url="URL"}(Ne||(Ne={}));var st,it=((Ie={})[Ne.WebMap]=ne.ItemTypes.WebMap,Ie[Ne.WebScene]=ne.ItemTypes.WebScene,Ie[Ne.Layers]=[ne.ItemTypes.FeatureService,ne.ItemTypes.MapService,ne.ItemTypes.SceneService,ne.ItemTypes.FeatureCollection],Ie),lt=((Oe={})[U.WebMap]=ne.ItemTypes.WebMap,Oe[U.WebScene]=ne.ItemTypes.WebScene,Oe[U.FeatureLayer]=[ne.ItemTypes.FeatureService,ne.ItemTypes.MapService,ne.ItemTypes.FeatureCollection],Oe[U.SceneLayer]=ne.ItemTypes.SceneService,Oe[U.GroupLayer]=[ne.ItemTypes.FeatureService,ne.ItemTypes.MapService,ne.ItemTypes.SceneService,ne.ItemTypes.FeatureCollection],Oe[U.FeatureService]=ne.ItemTypes.FeatureService,Oe[U.MapService]=ne.ItemTypes.MapService,Oe[U.SceneService]=ne.ItemTypes.SceneService,Oe),ct=((Me={})[U.WebMap]=Ne.WebMap,Me[U.WebScene]=Ne.WebScene,Me[U.FeatureLayer]=[Ne.Layers,Ne.Url],Me[U.SceneLayer]=[Ne.Layers,Ne.Url],Me[U.GroupLayer]=[Ne.Layers,Ne.Url],Me[U.FeatureService]=[Ne.Layers,Ne.Url],Me[U.MapService]=[Ne.Layers,Ne.Url],Me[U.SceneService]=[Ne.Layers,Ne.Url],Me),ut=((Ce={})[Ne.WebMap]=n(167),Ce[Ne.WebScene]=n(168),Ce[Ne.Layers]=n(169),Ce[Ne.Url]=n(264),Ce),dt=function(e){function t(t){var n,a=e.call(this,t)||this;return a.loadingItemNumber=0,a.tabLabel=((n={})[Ne.WebMap]=a.props.intl.formatMessage({id:"webMap",defaultMessage:P.defaultMessages.webMap}),n[Ne.WebScene]=a.props.intl.formatMessage({id:"webScene",defaultMessage:P.defaultMessages.webScene}),n[Ne.Layers]=a.props.intl.formatMessage({id:"layers",defaultMessage:P.defaultMessages.layers}),n[Ne.Url]=a.props.intl.formatMessage({id:"url",defaultMessage:P.defaultMessages.url}),n),a.getTabTypeFromDsType=function(e){return e?Array.isArray(ct[e])?ct[e]:[ct[e]]:[]},a.getTabIcon=function(e){return e?ut[e]:null},a.getTabLabel=function(e){return e?a.tabLabel[e]:null},a.getElementPosition=function(e){if(!e)return null;for(var t=e.offsetLeft,n=e.offsetTop,a=e.offsetParent;null!==a;)t+=a.offsetLeft,n+=a.offsetTop,a=a.offsetParent;return{x:t,y:n}},a.getItemDetailPosition=function(){var e,t,n;if(!a.rootDom)return null;var o=a.getElementPosition(a.rootDom),r=null===(n=null===(t=null===(e=Object(s.getAppStore)())||void 0===e?void 0:e.getState())||void 0===t?void 0:t.appContext)||void 0===n?void 0:n.isRTL,i=o.x+260;return{t:"0",b:"0",l:r?"auto":i+"px",r:r?i+"px":"auto",w:"260px",h:"auto"}},a.getConfigDsId=function(){var e=Object(s.getAppStore)().getState(),t=e&&e.appStateInBuilder&&e.appStateInBuilder.appConfig;return s.appConfigUtils.getUniqueId(t,"dataSource")},a.getNextDsId=function(){if(!a.dataSourceId)return a.dataSourceId=a.getConfigDsId(),a.dataSourceId;var e=a.dataSourceId.split("_"),t=e[1]?parseInt(e[1])+1:Object(s.uuidv1)(),n=e[0]||"dataSource";return a.dataSourceId=n+"_"+t,a.dataSourceId},a.fetchDataFromItem=function(e){return Ze(a,void 0,void 0,(function(){return $e(this,(function(t){switch(t.label){case 0:return e?[3,2]:[4,Promise.resolve(null)];case 1:return[2,t.sent()];case 2:return e.type!==ne.ItemTypes.WebMap&&e.type!==ne.ItemTypes.WebScene?[3,4]:[4,le(e,this.getNextDsId(),e.portalUrl)];case 3:return[2,t.sent()];case 4:return e.type!==ne.ItemTypes.FeatureCollection?[3,6]:[4,ce(e,this.getNextDsId(),e.portalUrl)];case 5:return[2,t.sent()];case 6:return[4,ge(e.url,this.getNextDsId(),e.title,e.portalUrl,e.id)];case 7:return[2,t.sent()]}}))}))},a.onItemAdded=function(e,t){void 0===e&&(e=[]),a.setState({selectedItems:e,partSelectedItems:a.state.partSelectedItems.filter((function(t){return!e.some((function(e){return e.id===t.id}))}))}),a.toggleLoadStatus(!1),a.fetchDataFromItem(t).then((function(e){a.onDsJsonAdded(e),a.toggleLoadStatus(!0)}),(function(n){console.error(n),a.toggleLoadStatus(!0),a.toggleToastStatus(!0,n),a.setState({selectedItems:e.filter((function(e){return e.id!==t.id}))})}))},a.onItemRemoved=function(e,t){a.setState({selectedItems:e,partSelectedItems:a.state.partSelectedItems.filter((function(e){return e.id!==t.id}))}),a.toggleLoadStatus(!1),a.fetchDataFromItem(t).then((function(e){a.onDsJsonRemoved(e,!0),a.toggleLoadStatus(!0)}),(function(e){console.error(e),a.toggleLoadStatus(!0),a.toggleToastStatus(!0,e)}))},a.onDsJsonAdded=function(e){var t;e.dsJson&&(a.props.onSelect&&a.props.onSelect([e.dsJson]),a.setState({selectedDss:a.state.selectedDss.concat(e.dsJson),dataSchemas:e.dataSchema?Ye(Ye({},a.state.dataSchemas),(t={},t[e.dataSchema.id]=e.dataSchema,t)):a.state.dataSchemas}))},a.onDsJsonRemoved=function(e,t){if(e.dsJson){a.props.onRemove&&a.props.onRemove([e.dsJson]);var n=Ye({},a.state.dataSchemas);delete n[e.dsJson.id],a.setState({selectedDss:a.state.selectedDss.filter((function(n){return t?n.itemId!==e.dsJson.itemId:n.id!==e.dsJson.id})),dataSchemas:n,selectedItems:a.state.selectedItems.filter((function(t){return t.id!==e.dsJson.itemId})),partSelectedItems:a.state.partSelectedItems.filter((function(t){return t.id!==e.dsJson.itemId}))})}},a.onDsJsonChange=function(e){var t=a.state.selectedDss.findIndex((function(t){return t.id===e.id})),n=a.state.selectedDss.slice();n.splice(t,1,e);var o=a.state.selectedItems.concat(a.state.partSelectedItems).find((function(t){return t.id===(null==e?void 0:e.itemId)})),r=a.state.selectedItems,s=a.state.partSelectedItems;o&&(a.getWhetherIsPartSelected(e)?(r=a.state.selectedItems.filter((function(t){return e.itemId&&t.id!==e.itemId})),s=a.state.partSelectedItems.concat(o)):(r=a.state.selectedItems.concat(o),s=a.state.partSelectedItems.filter((function(t){return e.itemId&&t.id!==e.itemId}))));a.setState({selectedDss:n,selectedItems:r,partSelectedItems:s})},a.getWhetherIsPartSelected=function(e){var t=!1;if(null==e?void 0:e.childDataSourceJsons){for(var n=0;n<Object.values(e.childDataSourceJsons).length;n++)if(a.getWhetherIsPartSelected(Object.values(e.childDataSourceJsons)[n])){t=!0;break}}else t=e.isHidden;return t},a.getWhetherCurrentDsIsHidden=function(e){return e&&e.isHidden},a.onAddedDataCollapseClicked=function(){a.setState({isSelectedDataCollapseOpen:!a.state.isSelectedDataCollapseOpen})},a.onFinish=function(){a.props.onFinish&&a.props.onFinish(a.state.selectedDss)},a.onActiveTabChange=function(e){a.setState({activeTab:e})},a.toggleLoadStatus=function(e){e?a.loadingItemNumber-=1:a.loadingItemNumber+=1,a.loadingItemNumber>0?a.setState({isLoaded:!1}):a.setState({isLoaded:!0})},a.toggleToastStatus=function(e,t){e?a.setState({isToastOpen:e,addDataErrorCode:t},(function(){setTimeout((function(){a.setState({isToastOpen:!1})}),5e3)})):a.setState({isToastOpen:e,addDataErrorCode:t})},a.onToggleData=function(e,t){e&&t&&(t.isHidden?a.onDsJsonChange(xe(t,e)):t.id!==e.id?a.onDsJsonChange(De(t,e)):a.onDsJsonRemoved({dsJson:e,dataSchema:t},!1))},a.AddedItem=function(e){var t=e.rootDsJson,n=e.dataSchema;return Object(s.jsx)("div",{className:"added-ds-item"},Object(s.jsx)(Xe,{dataSource:n,isNodeSelectable:function(){return!0},renderSelectableNode:function(e){return a.renderDataItem(e,t)},getChildDataSources:a.getChildData,getLabel:a.getDataLabel}))},a.getChildData=function(e){return e&&e.childSchemas?Object.values(e.childSchemas):[]},a.getDataLabel=function(e){return e&&(e.label||e.id)},a.getItemTypes=function(e,t){var n=it[t];if(e&&0!==e.length){var a=Array.from(new Set(e.asMutable().reduce((function(e,t){return e.concat(lt[t])}),[]))),o=[];return a.forEach((function(e){(Array.isArray(n)?n.some((function(t){return t===e})):e===n)&&(o=o.concat(e))})),Object(s.Immutable)(o)}return Array.isArray(n)?Object(s.Immutable)(n):n},a.renderDataItem=function(e,t){if(!e)return null;var n=e,o=Object(s.Immutable)({id:n.id,type:n.type,label:n.label,isHidden:n.isHidden});return Object(s.jsx)("div",{className:"d-flex align-items-center justify-content-between w-100 item"},Object(s.jsx)("div",{className:"d-flex align-items-center flex-grow-1 text-truncate",title:K(null==o?void 0:o.type,a.props.intl)},Object(s.jsx)("div",{className:"d-flex justify-content-center align-items-center flex-shrink-0 ds-thumbnail"},Object(s.jsx)(P.Icon,{icon:X(o),className:"text-dark",size:"12"})),Object(s.jsx)("div",{className:"flex-grow-1 text-truncate pl-2 ds-type",title:a.getDataLabel(n)},a.getDataLabel(n))),Object(s.jsx)("div",{className:"d-flex align-items-center flex-shrink-0"},Object(s.jsx)(P.Button,{type:"tertiary",size:"sm",icon:!0,onClick:function(){return a.onToggleData(t,n)},title:(null==n?void 0:n.isHidden)?a.props.intl.formatMessage({id:"clickToShow",defaultMessage:P.defaultMessages.clickToShow}):(null==n?void 0:n.parentSchema)?a.props.intl.formatMessage({id:"clickToHide",defaultMessage:P.defaultMessages.clickToHide}):a.props.intl.formatMessage({id:"remove",defaultMessage:P.defaultMessages.remove})},Object(s.jsx)(P.Icon,{icon:(null==n?void 0:n.isHidden)?at:(null==n?void 0:n.parentSchema)?nt:tt,size:12}))))},a.state={selectedDss:[],selectedItems:[],partSelectedItems:[],activeTab:a.props.types&&a.getTabTypeFromDsType(a.props.types[0])?a.getTabTypeFromDsType(a.props.types[0])[0]:Ne.WebMap,isLoaded:!0,isToastOpen:!1,isSelectedDataCollapseOpen:!1,dataSchemas:{},addDataErrorCode:null},a}return Ke(t,e),t.prototype.render=function(){var e,t=this,n=this.AddedItem,a=this.props.types?Array.from(new Set(Array.prototype.concat.apply([],this.props.types.map((function(e){return t.getTabTypeFromDsType(e)})).filter((function(e){return!!e}))))):Object.keys(Ne).map((function(e){return Ne[e]}));return(null==a?void 0:a.length)<1?null:Object(s.jsx)("div",{className:Object(s.classNames)("h-100",(e={},e[this.props.className]=!!this.props.className,e))},Object(s.jsx)("div",{className:"w-100 component-external-data-source-selector",ref:function(e){return t.rootDom=e}},Object(s.jsx)("div",{className:"d-flex flex-wrap align-items-stretch w-100 h-100"},Object(s.jsx)("div",{className:"selector-left"},Object(s.jsx)("h3",{className:"selector-left-title"},this.props.isRadio?this.props.intl.formatMessage({id:"selectData",defaultMessage:P.defaultMessages.selectData}):this.props.intl.formatMessage({id:"addData",defaultMessage:P.defaultMessages.addData})),Object(s.jsx)(P.Nav,{underline:!0,vertical:!0,right:!0,className:"selector-left-tabs"},a.map((function(e){return Object(s.jsx)(P.NavItem,{key:e,className:Object(s.classNames)("w-100 mb-2",{"active-tab":t.state.activeTab===e})},Object(s.jsx)(P.NavLink,{onClick:function(){t.onActiveTabChange(e)},className:"d-flex"},Object(s.jsx)(P.Icon,{icon:t.getTabIcon(e),size:"16",className:"mr-2 flex-shrink-0"}),Object(s.jsx)("div",{className:"flex-grow-1 text-truncate text-left",title:t.getTabLabel(e)},t.getTabLabel(e))))})))),Object(s.jsx)("div",{className:"selector-right h-100"},Object(s.jsx)("div",{className:"selector-right-header w-100 d-flex justify-content-end"},Object(s.jsx)(P.Button,{type:"tertiary",size:"sm",icon:!0,className:"close-icon",onClick:this.props.onCancel},Object(s.jsx)(P.Icon,{width:20,height:20,icon:et}))),Object(s.jsx)("div",{className:"selector-right-body w-100"},(this.state.activeTab===Ne.WebMap||this.state.activeTab===Ne.WebScene||this.state.activeTab===Ne.Layers)&&[Ne.WebMap,Ne.WebScene,Ne.Layers].map((function(e,n){return Object(s.jsx)("div",{className:Object(s.classNames)("inner-item-selector-container h-100 w-100",{"d-none":e!==t.state.activeTab}),key:n},Object(s.jsx)(He,{itemType:t.getItemTypes(t.props.types,e),intl:t.props.intl,portalUrl:t.props.portalUrl,isRadio:t.props.isRadio,onSelect:t.onItemAdded,onRemove:t.onItemRemoved,getItemDetailPosition:t.getItemDetailPosition,selectedItems:t.state.selectedItems,partSelectedItems:t.state.partSelectedItems}))})),this.state.activeTab===Ne.Url&&Object(s.jsx)(Ee,{onAdded:this.onDsJsonAdded,getDsId:this.getNextDsId,intl:this.props.intl,toggleLoadStatus:this.toggleLoadStatus,toggleToastStatus:this.toggleToastStatus})))),Object(s.jsx)("div",null,this.state.selectedDss&&this.state.selectedDss.length>0&&Object(s.jsx)("div",{className:"added-ds-container py-3"},Object(s.jsx)("div",{className:"d-flex justify-content-between align-items-center px-3"},Object(s.jsx)("div",{className:"d-flex align-items-center"},Object(s.jsx)("span",{className:"mr-2"},this.state.selectedDss.length),Object(s.jsx)("span",{className:"mr-2"},this.props.intl.formatMessage({id:"selected",defaultMessage:P.defaultMessages.selected})),Object(s.jsx)(P.Button,{type:"tertiary",size:"sm",icon:!0,onClick:this.onAddedDataCollapseClicked,title:this.state.isSelectedDataCollapseOpen?this.props.intl.formatMessage({id:"down",defaultMessage:P.defaultMessages.down}):this.props.intl.formatMessage({id:"up",defaultMessage:P.defaultMessages.up})},this.state.isSelectedDataCollapseOpen?Object(s.jsx)(P.Icon,{icon:ot,size:"12"}):Object(s.jsx)(P.Icon,{icon:rt,size:"12"}))),Object(s.jsx)("div",{className:"small-done-btn"},!this.state.isSelectedDataCollapseOpen&&Object(s.jsx)(P.Button,{onClick:this.onFinish,type:"primary",className:"text-truncate w-100",disabled:!this.state.isLoaded},this.props.intl.formatMessage({id:"done",defaultMessage:P.defaultMessages.done})))),this.state.isSelectedDataCollapseOpen&&Object(s.jsx)("div",{className:"added-ds-items"},Object(s.jsx)("div",null,this.state.selectedDss.map((function(e,a){return Object(s.jsx)(n,{key:a,rootDsJson:e,dataSchema:t.state.dataSchemas[e.id]})})))),this.state.isSelectedDataCollapseOpen&&Object(s.jsx)("div",{className:"big-done-btn w-100 px-3"},Object(s.jsx)(P.Button,{onClick:this.onFinish,type:"primary",className:"text-truncate w-100"},this.props.intl.formatMessage({id:"done",defaultMessage:P.defaultMessages.done}))))),Object(s.jsx)("div",null,!this.state.isLoaded&&Object(s.jsx)("div",{className:"jimu-primary-loading"})),Object(s.jsx)(P.Toast,{text:ie(this.state.addDataErrorCode,this.props.intl),type:P.ToastType.Error,open:this.state.isToastOpen})))},t}(s.React.PureComponent),pt=Object(s.injectIntl)(s.themeUtils.withStyles(dt,"ExternalDataSourceSelector")),ht=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function i(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((a=a.apply(e,t||[])).next())}))},ft=function(e,t){var n,a,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function i(r){return function(i){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,i])}}};function mt(e,t){return!!e&&t.some((function(t){return e.type&&t===e.type}))}function gt(e,t){return ht(this,void 0,void 0,(function(){var n;return ft(this,(function(a){switch(a.label){case 0:return n={},0!==t.length?[3,2]:[4,Promise.resolve(n)];case 1:return[2,a.sent()];case 2:return[4,Promise.all(e.filter((function(e){return e&&e.id&&!e.getDataSourceJson().isHidden&&e.isDataSourceSet&&!e.isDataView&&!e.isLocal})).map((function(e){return n[e.id]||(n[e.id]=[]),function e(t,n,a){t.isDataSourceSet&&t.getChildDataSources().forEach((function(t){t&&t.getDataSourceJson()&&t.id&&(mt(t.getDataSourceJson(),a)&&n.push(t),e(t,n,a))}))}(e,n[e.id],t)}))).then((function(){return Object.keys(n).forEach((function(e){0===n[e].length&&delete n[e]})),n}))];case 3:return[2,a.sent()]}}))}))}function vt(e,t){var n=e||[];return t&&Object.keys(t).forEach((function(e){if(!n.some((function(t){return t.id===e}))){var t=s.DataSourceManager.getInstance().getDataSource(e);t&&(n=n.concat(t))}})),n}function St(e,t){var n=e||[];return t&&Object.values(t).forEach((function(e){e&&e.length>0&&(n=n.concat(e))})),n}!function(e){e.Added="ADDED",e.Output="OUTPUT"}(st||(st={}));var bt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),yt=function(e){function t(t){var n=e.call(this,t)||this;return n.__unmount=!1,n.getWhetherdisableSelectionType=function(e){return e.length<=1},n.onTypeSelected=function(e){var t,a=e.target.value;t="All"===a?null:[a],n.props.onTypeSelected(t)},n}return bt(t,e),t.prototype.render=function(){var e,t=this,n=this.props.toUseTypes?Object(s.Immutable)(Array.from(new Set(this.props.toUseTypes.asMutable()))):Object(s.Immutable)([]);return s.React.createElement("div",{className:"d-flex justify-content-between align-items-center mb-3 to-use-types"},s.React.createElement("div",{className:"mr-2 w-25 text-truncate",title:this.props.intl.formatMessage({id:"type",defaultMessage:P.defaultMessages.type})},this.props.intl.formatMessage({id:"type",defaultMessage:P.defaultMessages.type})),this.getWhetherdisableSelectionType(n)?s.React.createElement("div",{className:"types-selected text-truncate mr-1",title:K(n[0],this.props.intl)},K(n[0],this.props.intl)):s.React.createElement(P.Select,{value:this.props.selectedTypes&&this.props.selectedTypes[0]||"All",onChange:this.onTypeSelected,className:"flex-shrink-0 to-use-dp",buttonProps:{className:"text-truncate h-100"}},(e=n.asMutable(),e.sort((function(e,t){return null==e?void 0:e.localeCompare(t)}))).map((function(e){return s.React.createElement("option",{value:e,key:e},K(e,t.props.intl))})),n&&n.length>1&&s.React.createElement("option",{value:"All"},this.props.intl.formatMessage({id:"all",defaultMessage:P.defaultMessages.all}))))},t}(s.React.PureComponent),wt=n(31),Dt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),xt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getWhetherSelected=function(){return t.props.useDataSources&&t.props.useDataSources.some((function(e){return((null==e?void 0:e.mainDataSourceId)||(null==e?void 0:e.dataSourceId))===t.props.ds.id}))},t.getParentWidget=function(e){var t,n,a,o=null===(n=null===(t=Object(s.getAppStore)().getState())||void 0===t?void 0:t.appStateInBuilder)||void 0===n?void 0:n.appConfig;if(!o||!e)return null;var r=null!==(a=o.widgets)&&void 0!==a?a:Object(s.Immutable)({}),i=Object.values(r).filter((function(e){var t;return e.useDataSources&&e.layouts&&(null===(t=e.manifest.properties)||void 0===t?void 0:t.passDataSourceToChildren)}));if(0===i.length)return null;var l=[];return i.find((function(t){return(l=wt.searchUtils.getChildrenContents(o,t.id,s.LayoutItemType.Widget,!0))&&l.some((function(t){return t.id===e}))}))||null},t.getUseDsWithoutFields=function(e){if(!e)return null;var t={};Object.keys(e).forEach((function(n){"fields"!==n&&(t[n]=e[n])}))},t.getUseDs=function(){var e={dataSourceId:t.props.ds.id,mainDataSourceId:t.props.ds.id},n=t.getParentWidget(t.props.widgetId),a=((null==n?void 0:n.useDataSources)||[]).find((function(t){var n=s.DataSourceManager.getInstance().getDataSource(t.dataSourceId),a=n&&n.getMainDataSource();return a&&a.id===e.mainDataSourceId}));if(a)e=t.getUseDsWithoutFields(a);else{var o=t.props.ds.getRootDataSource&&t.props.ds.getRootDataSource();o&&(e.rootDataSourceId=o.id)}return t.props.ds.getDataSourceJson().isOutputFromWidget&&(e.dataSourceId=s.DataSourceManager.getInstance().getDataViewDataSourceId(t.props.ds.id,s.CONSTANTS.OUTPUT_DATA_VIEW_ID),e.dataViewId=s.CONSTANTS.OUTPUT_DATA_VIEW_ID),e},t.getDsLabel=function(e){return e?e.getLabel()||e.id:""},t.onItemClick=function(e){if(t.getWhetherSelected()){if(t.props.disableRemove)return;t.onDsRemoved(t.getUseDs())}else{if(t.props.disableSelection)return;t.onDsSelected(t.getUseDs())}},t.onDsSelected=function(e){var n;e&&(n=t.props.useDataSources&&t.props.isMultiple?t.props.useDataSources.asMutable({deep:!0}).concat(e):[e],t.props.onChange&&t.props.onChange(n))},t.onDsRemoved=function(e){if(e&&t.props.useDataSources){var n=t.props.useDataSources.filter((function(t){return(null==t?void 0:t.dataSourceId)!==e.dataSourceId}));t.props.onChange&&t.props.onChange(n.asMutable({deep:!0}))}},t}return Dt(t,e),t.prototype.render=function(){var e,t;if(!this.props.ds||!this.props.ds.getDataSourceJson())return null;var n=this.getWhetherSelected();return s.React.createElement("div",{onClick:this.onItemClick,className:Object(s.classNames)("ds-item",(e={"ds-item-selected":n},e[this.props.className]=!!this.props.className,e))},s.React.createElement("div",{className:"d-flex align-items-center w-100 item"},s.React.createElement("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail",title:K(null===(t=this.props.ds)||void 0===t?void 0:t.type,this.props.intl)},s.React.createElement(P.Icon,{icon:X(this.props.ds.getDataSourceJson()),className:"text-dark",size:"12"})),s.React.createElement("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},s.React.createElement("div",{className:"text-truncate ds-type-name",title:this.getDsLabel(this.props.ds)},this.getDsLabel(this.props.ds)))))},t}(s.React.PureComponent),jt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),It=["widgets/arcgis/query/"],Ot=function(e){function t(t){var n=e.call(this,t)||this;return n.getRootNode=function(e){return It.some((function(t){return(null==e?void 0:e.uri)===t}))?e:n.getChildNodes(e)[0]},n.getChildNodes=function(e){if(e.manifest)return n.props.allToUseRootDss.map((function(e){return e.getDataSourceJson()}));var t=s.DataSourceManager.getInstance().getDataSource(e.id);return(null==t?void 0:t.isDataSourceSet)?t.getChildDataSources().map((function(e){return e.getDataSourceJson()})):[]},n.getLabel=function(e){return e.label},n.renderUnselectableNode=function(e,t){var n="string"==typeof t.icon?t.icon:t.icon&&t.icon.svg,a="string"==typeof t.icon?null:t.icon&&t.icon.properties&&t.icon.properties.color;return s.React.createElement("div",{className:"d-flex w-100",title:e},s.React.createElement("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail"},s.React.createElement(P.Icon,{icon:n,color:a,size:"12"})),s.React.createElement("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},s.React.createElement("div",{className:"text-truncate ds-type-name"},e)))},n.renderSelectableNode=function(e){if(!e)return null;var t=s.DataSourceManager.getInstance().getDataSource(e.id);return s.React.createElement(xt,{useDataSources:n.props.useDataSources,ds:t,widgetId:n.props.widgetId,key:t.id,onChange:n.props.onChange,isMultiple:n.props.isMultiple,intl:n.props.intl,disableSelection:n.props.disableSelection,disableRemove:n.props.disableRemove,className:"w-100"})},n.state={isNodeSelectable:function(e){return n.props.allToUseDss.some((function(t){return t.id===e.id}))}},n}return jt(t,e),t.prototype.componentDidUpdate=function(e){var t=this;e.allToUseDss!==this.props.allToUseDss&&this.setState({isNodeSelectable:function(e){return t.props.allToUseDss.some((function(t){return t.id===e.id}))}})},t.prototype.render=function(){return this.props.widgetJson&&this.props.allToUseRootDss?s.React.createElement("div",{className:"mb-3"},s.React.createElement(Xe,{dataSource:this.getRootNode(this.props.widgetJson),isNodeSelectable:this.state.isNodeSelectable,renderSelectableNode:this.renderSelectableNode,renderUnselectableNode:this.renderUnselectableNode,useDefaultBackground:!0,getChildDataSources:this.getChildNodes,getLabel:this.getLabel})):null},t}(s.React.PureComponent),Mt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Ct=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function i(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((a=a.apply(e,t||[])).next())}))},Nt=function(e,t){var n,a,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function i(r){return function(i){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,i])}}},Tt=n(172),_t=function(e){function t(t){var n=e.call(this,t)||this;return n.__unmount=!1,n.initData=function(){n.setSelectedType(null);var e=n.props.enableToSelectOutputDsFromSelf?null:n.props.widgetId;n.setToUseDataSources(n.props.types,n.props.fromRootDsIds,n.props.fromDsIds,n.props.hideDs,n.props.searchValue,e)},n.setToUseDataSources=function(e,t,a,o,r,s){var i=n.getToUseRootDss(e,t,a,o,r,s);n.getToUseChildDss(e,t,a,o,r).then((function(e){var t=n.getToUseWidgets(i,e);n.__unmount||n.setState({toUseRootDss:i,toUseChildDss:e,toUseWidgets:t})}))},n.setSelectedType=function(e){n.setState({selectedTypes:e})},n.getRootDss=function(){var e=s.DataSourceManager.getInstance().getWidgetGeneratedDataSources();return Object.keys(e).forEach((function(t){e[t]=e[t].filter((function(e){return e&&e.id&&e.getDataSourceJson()}))})),e},n.getToUseWidgets=function(e,t){return s.appConfigUtils.getAllWidgets(Object(s.getAppStore)().getState().appStateInBuilder.appConfig).filter((function(a){return e[a.id]||n.getRootDss()[a.id]&&n.getRootDss()[a.id].some((function(e){return!!t[e.id]}))}))},n.getToUseRootDss=function(e,t,a,o,r,s){var i={};if(t)return i;var l=n.getRootDss();Object.keys(l).forEach((function(t){var s=l[t].filter((function(t){return t&&!t.parentDataSource&&n.props.dataSources&&n.props.dataSources[t.id]&&mt(t.getDataSourceJson(),e)&&n.isValid(t,a,o,r)}));s&&s.length>0&&(i[t]||(i[t]=[]),i[t]=i[t].concat(s))}));var c=ee(s);return Object.keys(i).forEach((function(e){(0===i[e].length||c.some((function(t){return t===e})))&&delete i[e]})),i},n.getToUseChildDss=function(e,t,a,o,r){return Ct(n,void 0,void 0,(function(){var n,i,l=this;return Nt(this,(function(c){return n=[],t?n=t.asMutable().map((function(e){return s.DataSourceManager.getInstance().getDataSource(e)})):(i=this.getRootDss(),Object.keys(i).forEach((function(e){n=n.concat(i[e])}))),[2,gt(n,e).then((function(e){var t={};return Object.keys(e).forEach((function(n){e[n].some((function(e){return l.isValid(e,a,o,r)}))&&(t[n]=e[n].filter((function(e){return l.isValid(e,a,o,r)})))})),t}))]}))}))},n.getToUseChildDssByWidgetId=function(e){var t={};return n.getRootDss()[e].forEach((function(e){t[e.id]||(t[e.id]=[]),t[e.id]=n.state.toUseChildDss[e.id]?t[e.id].concat(n.state.toUseChildDss[e.id]):t[e.id]})),Object.keys(t).forEach((function(e){0===t[e].length&&delete t[e]})),t},n.isValid=function(e,t,n,a){return e&&e.getDataSourceJson()&&e.getDataSourceJson().isOutputFromWidget&&!e.isDataView&&!e.isLocal&&!e.getDataSourceJson().isHidden&&J(e.getLabel(),a)&&q(e.getDataSourceJson(),t,n)},n.getWhetherShowList=function(){return n.getWhetherShowRootDss()||n.getWhetherShowChildDss()},n.getWhetherShowRootDss=function(){return n.state.toUseRootDss&&Object.keys(n.state.toUseRootDss).length>0},n.getWhetherShowChildDss=function(){return n.state.toUseChildDss&&Object.keys(n.state.toUseChildDss).length>0},n.state={toUseRootDss:null,toUseChildDss:null,toUseWidgets:null,selectedTypes:null},n}return Mt(t,e),t.prototype.componentDidMount=function(){this.__unmount=!1,this.props.isDataSourceInited&&this.initData()},t.prototype.componentDidUpdate=function(e,t){if(this.props.isDataSourceInited){if(t.selectedTypes!==this.state.selectedTypes||e.fromRootDsIds!==this.props.fromRootDsIds||e.fromDsIds!==this.props.fromDsIds||e.searchValue!==this.props.searchValue||e.dataSources!==this.props.dataSources){var n=this.props.enableToSelectOutputDsFromSelf?null:this.props.widgetId,a=this.state.selectedTypes||this.props.types;this.setToUseDataSources(a,this.props.fromRootDsIds,this.props.fromDsIds,this.props.hideDs,this.props.searchValue,n)}e.types===this.props.types&&e.isDataSourceInited&&e.dataSources===this.props.dataSources||this.initData(),this.state.selectedTypes||this.state.toUseRootDss===t.toUseRootDss&&this.state.toUseChildDss===t.toUseChildDss||(this.getWhetherShowList()?this.props.addDataTab(st.Output):this.props.removeDataTab(st.Output))}},t.prototype.componentWillUnmount=function(){this.__unmount=!0},t.prototype.render=function(){var e,t,n=this;if(!this.state.toUseChildDss||!this.state.toUseRootDss||!this.state.toUseWidgets)return null;var a=function(e){return e?e.filter((function(e){return!!e})):Object(s.Immutable)([])}(this.props.types);return s.React.createElement("div",{className:"ds-widget-outputs h-100 w-100"},a&&a.length>0?s.React.createElement("div",{className:"pt-3 h-100"},this.props.hideTypeDropdown?null:s.React.createElement("div",{className:"ds-types"},s.React.createElement(yt,{toUseTypes:a,onTypeSelected:this.setSelectedType,selectedTypes:this.state.selectedTypes,intl:this.props.intl})),this.getWhetherShowList()?s.React.createElement("div",{className:"ds-list px-3"},this.state.toUseWidgets.map((function(e){return s.React.createElement(Ot,{key:e.id,widgetJson:e,allToUseDss:St(n.state.toUseRootDss[e.id],n.getToUseChildDssByWidgetId(e.id)),allToUseRootDss:vt(n.state.toUseRootDss[e.id],n.getToUseChildDssByWidgetId(e.id)),useDataSources:n.props.useDataSources,isMultiple:n.props.isMultiple,intl:n.props.intl,widgetId:n.props.widgetId,onChange:n.props.onChange,disableSelection:n.props.disableSelection,disableRemove:n.props.disableRemove})}))):s.React.createElement("div",null,(null===(t=null===(e=Object(s.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig)&&this.props.isDataSourceInited&&s.React.createElement("div",{className:"empty-placeholder w-100"},s.React.createElement("div",{className:"empty-placeholder-icon"},s.React.createElement(P.Icon,{icon:Tt,width:80,height:71})),s.React.createElement("div",{className:"empty-placeholder-text",dangerouslySetInnerHTML:{__html:this.props.intl.formatMessage({id:"noWidgetOutputCanBeUsed",defaultMessage:P.defaultMessages.noWidgetOutputCanBeUsed})+"<br/>"+this.props.intl.formatMessage({id:"pleaseAddData",defaultMessage:P.defaultMessages.pleaseAddData})}})))):this.props.intl.formatMessage({id:"noSelectedType",defaultMessage:P.defaultMessages.noSelectedType}))},t}(s.React.PureComponent),kt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Vt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getWhetherSelected=function(){return t.props.useDataSources&&t.props.useDataSources.some((function(e){return((null==e?void 0:e.mainDataSourceId)||(null==e?void 0:e.dataSourceId))===t.props.dsId}))},t.getUseDs=function(){return{dataSourceId:t.props.dsId,mainDataSourceId:t.props.dsId}},t.onItemClick=function(){if(t.getWhetherSelected()){if(t.props.disableRemove)return;t.onDsRemoved(t.getUseDs())}else{if(t.props.disableSelection)return;t.onDsSelected(t.getUseDs())}},t.onDsSelected=function(e){var n;e&&(n=t.props.useDataSources&&t.props.isMultiple?t.props.useDataSources.asMutable({deep:!0}).concat(e):[e],t.props.onChange&&t.props.onChange(n))},t.onDsRemoved=function(e){if(e&&t.props.useDataSources){var n=t.props.useDataSources.filter((function(t){return(null==t?void 0:t.dataSourceId)!==e.dataSourceId}));t.props.onChange&&t.props.onChange(n.asMutable({deep:!0}))}},t}return kt(t,e),t.prototype.render=function(){var e;if(!this.props.dsId)return null;var t=this.getWhetherSelected(),n=Object(s.getAppStore)()&&Object(s.getAppStore)().getState(),a=n&&n.appStateInBuilder&&n.appStateInBuilder.appConfig&&n.appStateInBuilder.appConfig.dataSources,o=a&&a[this.props.dsId];return s.React.createElement("div",{onClick:this.onItemClick,className:Object(s.classNames)("ds-item ds-error-item",(e={"ds-item-selected":t},e[this.props.className]=!!this.props.className,e))},s.React.createElement("div",{className:"d-flex align-items-center w-100 item"},s.React.createElement("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail"},s.React.createElement(P.Icon,{icon:X(o),className:"text-dark",size:"12"})),s.React.createElement("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},s.React.createElement("div",{className:"text-truncate ds-type-name",title:this.props.dsId},this.props.dsId))))},t}(s.React.PureComponent),Et=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Lt=function(e){function t(t){var n=e.call(this,t)||this;return n.renderDsItem=function(e){return s.React.createElement(xt,{useDataSources:n.props.useDataSources,ds:e,widgetId:n.props.widgetId,key:e.id,onChange:n.props.onChange,isMultiple:n.props.isMultiple,intl:n.props.intl,disableSelection:n.props.disableSelection,disableRemove:n.props.disableRemove,className:"w-100"})},n.renderDsLabel=function(e){var t,a;return s.React.createElement("div",{className:"d-flex w-100"},s.React.createElement("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail",title:K(null===(t=n.props.ds)||void 0===t?void 0:t.type,n.props.intl)},s.React.createElement(P.Icon,{icon:X(null===(a=n.props.ds)||void 0===a?void 0:a.getDataSourceJson()),className:"text-dark",size:"12"})),s.React.createElement("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},s.React.createElement("div",{className:"text-truncate ds-type-name",title:e},e)))},n.getChildDataSources=function(e){return(null==e?void 0:e.isDataSourceSet)?e.getChildDataSources():[]},n.getLabel=function(e){return(null==e?void 0:e.getLabel())||(null==e?void 0:e.id)},n.state={inAllToUseDss:function(e){return n.props.allToUseDss.some((function(t){return t.id===e.id}))}},n}return Et(t,e),t.prototype.componentDidUpdate=function(e){var t=this;e.allToUseDss!==this.props.allToUseDss&&this.setState({inAllToUseDss:function(e){return t.props.allToUseDss.some((function(t){return t.id===e.id}))}})},t.prototype.render=function(){return this.props.ds?s.React.createElement("div",{className:"mb-3"},s.React.createElement(Xe,{dataSource:this.props.ds,isNodeSelectable:this.state.inAllToUseDss,renderSelectableNode:this.renderDsItem,renderUnselectableNode:this.renderDsLabel,useDefaultBackground:!0,getChildDataSources:this.getChildDataSources,getLabel:this.getLabel})):null},t}(s.React.PureComponent),At=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Rt=function(e){function t(t){var n=e.call(this,t)||this;return n.dsManager=s.DataSourceManager.getInstance(),n.getWhetherShowSingleDss=function(){return n.props.rootDss&&n.props.rootDss.length>0},n.getSelectedErrorDss=function(){return n.props.useDataSources?n.props.useDataSources.asMutable().filter((function(e){return!(n.dsManager&&n.dsManager.getDataSource(null==e?void 0:e.mainDataSourceId))})).map((function(e){return e.mainDataSourceId})):null},n.state={isTypeDropdownOpen:!1,selectedErrorDss:null},n}return At(t,e),t.prototype.componentDidMount=function(){if(this.props.showErrorDss){var e=this.getSelectedErrorDss();this.setState({selectedErrorDss:e}),e&&e.length>0?this.props.changeHasErrorSelectedDss&&this.props.changeHasErrorSelectedDss(!0):this.props.changeHasErrorSelectedDss&&this.props.changeHasErrorSelectedDss(!1)}},t.prototype.componentDidUpdate=function(e){if(this.props.showErrorDss&&(!this.state.selectedErrorDss||0===this.state.selectedErrorDss.length)&&(!e.useDataSources||0===e.useDataSources.length)&&this.props.useDataSources&&0!==this.props.useDataSources.length){var t=this.getSelectedErrorDss();this.setState({selectedErrorDss:t}),t&&t.length>0?this.props.changeHasErrorSelectedDss&&this.props.changeHasErrorSelectedDss(!0):this.props.changeHasErrorSelectedDss&&this.props.changeHasErrorSelectedDss(!1)}},t.prototype.render=function(){var e=this;return s.React.createElement("div",{className:"ds-list px-3"},this.props.showErrorDss&&this.state.selectedErrorDss&&this.state.selectedErrorDss.map((function(t){return s.React.createElement(Vt,{useDataSources:e.props.useDataSources,dsId:t,key:t,onChange:e.props.onChange,isMultiple:e.props.isMultiple,disableSelection:e.props.disableSelection,disableRemove:e.props.disableRemove,intl:e.props.intl,className:"mb-3 ml-4",widgetId:e.props.widgetId})})),this.getWhetherShowSingleDss()?s.React.createElement("div",null,s.dataSourceUtils.getSortedArrayByLabel(this.props.rootDss).map((function(t){return t&&t.id?s.React.createElement(Lt,{useDataSources:e.props.useDataSources,ds:t,key:t.id,onChange:e.props.onChange,isMultiple:e.props.isMultiple,allToUseDss:e.props.allToUseDss,disableSelection:e.props.disableSelection,disableRemove:e.props.disableRemove,intl:e.props.intl,widgetId:e.props.widgetId}):null}))):null)},t}(s.React.PureComponent),zt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Ut=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function i(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((a=a.apply(e,t||[])).next())}))},Pt=function(e,t){var n,a,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function i(r){return function(i){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,i])}}},Ft=n(172),Wt=function(e){function t(t){var n=e.call(this,t)||this;return n.__unmount=!1,n.initData=function(){n.setSelectedType(null),n.setToUseDataSources(n.props.types,n.props.fromRootDsIds,n.props.fromDsIds,n.props.hideDs,n.props.searchValue)},n.setHasErrorDss=function(e){return n.setState({hasErrorSelectedDss:e})},n.setToUseDataSources=function(e,t,a,o,r){var s=n.getToUseRootDss(e,t,a,o,r);n.getToUseChildDss(e,t,a,o,r).then((function(e){n.__unmount||n.setState({toUseRootDss:s,toUseChildDss:e})}))},n.setSelectedType=function(e){n.setState({selectedTypes:e})},n.getRootDss=function(){return s.DataSourceManager.getInstance().getConfiguredDataSources().filter((function(e){return e&&e.id&&e.getDataSourceJson()&&!e.parentDataSource}))},n.getToUseRootDss=function(e,t,a,o,r){return t?[]:s.DataSourceManager.getInstance().getConfiguredDataSources().filter((function(t){return t&&!t.parentDataSource&&n.props.dataSources&&n.props.dataSources[t.id]&&mt(t.getDataSourceJson(),e)&&n.isValid(t,a,o,r)}))},n.getToUseChildDss=function(e,t,a,o,r){return Ut(n,void 0,void 0,(function(){var n=this;return Pt(this,(function(i){return[2,gt(t?t.asMutable().map((function(e){return s.DataSourceManager.getInstance().getDataSource(e)})):this.getRootDss(),e).then((function(e){var t={};return Object.keys(e).forEach((function(s){e[s].some((function(e){return n.isValid(e,a,o,r)}))&&(t[s]=e[s].filter((function(e){return n.isValid(e,a,o,r)})))})),t}))]}))}))},n.isValid=function(e,t,n,a){return e&&e.getDataSourceJson()&&!e.getDataSourceJson().isOutputFromWidget&&!e.isDataView&&!e.isLocal&&!e.getDataSourceJson().isHidden&&J(e.getLabel(),a)&&q(e.getDataSourceJson(),t,n)},n.getWhetherShowList=function(){return n.getWhetherShowRootDss()||n.getWhetherShowChildDss()||!(!n.state.hasErrorSelectedDss||!n.props.useDataSources)},n.getWhetherShowRootDss=function(){return n.state.toUseRootDss&&n.state.toUseRootDss.length>0},n.getWhetherShowChildDss=function(){return n.state.toUseChildDss&&Object.keys(n.state.toUseChildDss).length>0},n.state={selectedTypes:null,toUseRootDss:null,toUseChildDss:null,hasErrorSelectedDss:!0},n}return zt(t,e),t.prototype.componentDidMount=function(){this.__unmount=!1,this.props.isDataSourceInited&&this.initData()},t.prototype.componentDidUpdate=function(e,t){this.props.isDataSourceInited&&(t.selectedTypes===this.state.selectedTypes&&e.fromRootDsIds===this.props.fromRootDsIds&&e.fromDsIds===this.props.fromDsIds&&e.searchValue===this.props.searchValue&&e.dataSources===this.props.dataSources||(this.state.selectedTypes?this.setToUseDataSources(this.state.selectedTypes,this.props.fromRootDsIds,this.props.fromDsIds,this.props.hideDs,this.props.searchValue):this.setToUseDataSources(this.props.types,this.props.fromRootDsIds,this.props.fromDsIds,this.props.hideDs,this.props.searchValue)),e.types===this.props.types&&e.isDataSourceInited&&e.dataSources===this.props.dataSources||this.initData(),this.state.selectedTypes||this.state.toUseRootDss===t.toUseRootDss&&this.state.toUseChildDss===t.toUseChildDss||(this.getWhetherShowList()?this.props.addDataTab(st.Added):this.props.removeDataTab(st.Added)))},t.prototype.componentWillUnmount=function(){this.__unmount=!0},t.prototype.render=function(){var e,t,n=function(e){return e?e.filter((function(e){return!!e})):Object(s.Immutable)([])}(this.props.types);return s.React.createElement("div",{className:"ds-added-data h-100 w-100"},n&&n.length>0?s.React.createElement("div",{className:"pt-3 h-100"},!this.props.hideTypeDropdown&&s.React.createElement("div",{className:"ds-types"},s.React.createElement(yt,{toUseTypes:n,onTypeSelected:this.setSelectedType,selectedTypes:this.state.selectedTypes,intl:this.props.intl})),this.getWhetherShowList()?s.React.createElement(Rt,{rootDss:vt(this.state.toUseRootDss,this.state.toUseChildDss),allToUseDss:St(this.state.toUseRootDss,this.state.toUseChildDss),onChange:this.props.onChange,isMultiple:this.props.isMultiple,changeHasErrorSelectedDss:this.setHasErrorDss,useDataSources:this.props.useDataSources,showErrorDss:!0,disableRemove:this.props.disableRemove,disableSelection:this.props.disableSelection,intl:this.props.intl,widgetId:this.props.widgetId}):s.React.createElement("div",null,(null===(t=null===(e=Object(s.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig)&&this.props.isDataSourceInited&&s.React.createElement("div",{className:"empty-placeholder w-100"},s.React.createElement("div",{className:"empty-placeholder-icon"},s.React.createElement(P.Icon,{icon:Ft,width:80,height:71})),s.React.createElement("div",{className:"empty-placeholder-text",dangerouslySetInnerHTML:{__html:this.props.intl.formatMessage({id:"noAddedDataSourceCanBeUsed",defaultMessage:P.defaultMessages.noAddedDataSourceCanBeUsed})+"<br/>"+this.props.intl.formatMessage({id:"pleaseAddData",defaultMessage:P.defaultMessages.pleaseAddData})}})))):this.props.intl.formatMessage({id:"noSelectedType",defaultMessage:P.defaultMessages.noSelectedType}))},t}(s.React.PureComponent),Ht=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Bt=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function i(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((a=a.apply(e,t||[])).next())}))},Jt=function(e,t){var n,a,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function i(r){return function(i){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,i])}}},qt=n(265),Gt=n(101),Qt=function(e){function t(t){var n=e.call(this,t)||this;return n.externalDsStyle={width:"100%",height:"100%",maxWidth:"5000px",margin:0},n.__unmount=!1,n.showExternalDs=function(){n.setState({isExternalDsShown:!0})},n.addDataTab=function(e){n.state.dataTabs.some((function(t){return t===e}))||n.setState({dataTabs:n.state.dataTabs.concat(e)})},n.removeDataTab=function(e){n.state.dataTabs.some((function(t){return t===e}))&&n.setState({dataTabs:n.state.dataTabs.filter((function(t){return t!==e}))})},n.onSelectDataFinished=function(e){e?n.state.getAppConfigAction?((0,n.state.getAppConfigAction)().addDataSources(e).exec(),e.map((function(e){return Bt(n,void 0,void 0,(function(){return Jt(this,(function(t){switch(t.label){case 0:return[4,s.DataSourceManager.getInstance().createDataSource(e)];case 1:return[2,t.sent()]}}))}))})),n.props.changeInitStatus&&n.props.changeInitStatus(!1),n.setState({isExternalDsShown:!1})):console.error("Can not load jimu-for-builder"):n.setState({isExternalDsShown:!1})},n.onSelectDataCanceled=function(){n.setState({isExternalDsShown:!1})},n.onToggleExternalDs=function(){n.setState({isExternalDsShown:!n.state.isExternalDsShown})},n.onSearchValueChange=function(e){n.setState({searchValue:e.target.value})},n.ExternalDs=Object(s.jsx)(pt,{portalUrl:Object(s.getAppStore)().getState().portalUrl,onCancel:n.onSelectDataCanceled,onFinish:n.onSelectDataFinished,types:n.props.types&&n.props.types.some((function(e){return e===U.FeatureLayer}))?null:n.props.types}),n.state={isExternalDsShown:!1,getAppConfigAction:null,searchValue:"",dataTabs:[st.Added,st.Output]},n}return Ht(t,e),t.prototype.componentDidMount=function(){var e=this;this.__unmount=!1,s.moduleLoader.loadModule("jimu-for-builder").then((function(t){e.__unmount||e.setState({getAppConfigAction:t.getAppConfigAction})}))},t.prototype.componentWillUnmount=function(){this.__unmount=!0},t.prototype.render=function(){var e,t=Object(s.jsx)(Wt,{types:this.props.types,isDataSourceInited:this.props.isDataSourceInited,useDataSources:this.props.useDataSources,onChange:this.props.onChange,isMultiple:this.props.isMultiple,disableSelection:this.props.disableSelection,disableRemove:this.props.disableRemove,intl:this.props.intl,fromRootDsIds:this.props.fromRootDsIds,hideTypeDropdown:this.props.hideTypeDropdown,widgetId:this.props.widgetId,searchValue:this.state.searchValue,fromDsIds:this.props.fromDsIds,dataSources:this.props.dataSources,hideDs:this.props.hideDs,removeDataTab:this.removeDataTab,addDataTab:this.addDataTab}),n=Object(s.jsx)(_t,{types:this.props.types,isDataSourceInited:this.props.isDataSourceInited,useDataSources:this.props.useDataSources,onChange:this.props.onChange,isMultiple:this.props.isMultiple,disableSelection:this.props.disableSelection,disableRemove:this.props.disableRemove,intl:this.props.intl,fromRootDsIds:this.props.fromRootDsIds,hideTypeDropdown:this.props.hideTypeDropdown,searchValue:this.state.searchValue,dataSources:this.props.dataSources,widgetId:this.props.widgetId,fromDsIds:this.props.fromDsIds,hideDs:this.props.hideDs,enableToSelectOutputDsFromSelf:this.props.enableToSelectOutputDsFromSelf,removeDataTab:this.removeDataTab,addDataTab:this.addDataTab}),a=Object(s.jsx)(P.Tabs,{pills:!0,fill:!0,className:"mt-3"},Object(s.jsx)(P.Tab,{id:"added",title:this.props.intl.formatMessage({id:"added",defaultMessage:P.defaultMessages.added}),defaultActive:!0},t),Object(s.jsx)(P.Tab,{id:"outputs",title:this.props.intl.formatMessage({id:"outputs",defaultMessage:P.defaultMessages.outputs})},n)),o=1===this.state.dataTabs.length&&this.state.dataTabs[0]===st.Added,r=1===this.state.dataTabs.length&&this.state.dataTabs[0]===st.Output;return Object(s.jsx)("div",{className:Object(s.classNames)("w-100 h-100",(e={},e[this.props.className]=!!this.props.className,e))},Object(s.jsx)("div",{className:"component-data-source-list h-100 w-100"},!this.props.hideHeader&&Object(s.jsx)("div",{className:"ds-list-header jimu-widget-setting--header d-flex px-3 py-0",title:this.props.intl.formatMessage({id:"setDataSource",defaultMessage:P.defaultMessages.setDataSource})},Object(s.jsx)(P.PanelHeader,{level:1,className:"py-3",showClose:!!this.props.onCloseClick,onClose:this.props.onCloseClick,title:this.props.intl.formatMessage({id:"setDataSource",defaultMessage:P.defaultMessages.setDataSource})})),Object(s.jsx)("div",{className:"w-100 px-3 search"},Object(s.jsx)(P.Icon,{icon:Gt,size:16,className:"search-icon"}),Object(s.jsx)(P.TextInput,{value:this.state.searchValue,onChange:this.onSearchValueChange,className:"search-input",placeholder:this.props.intl.formatMessage({id:"search",defaultMessage:s.defaultMessages.search})})),Object(s.jsx)("div",{className:"w-100 ds-list-container"},Object(s.jsx)("div",{className:"ds-list-tabs h-100"},o?Object(s.jsx)("div",{className:"h-100"},t,Object(s.jsx)("div",{className:"d-none"},n)):Object(s.jsx)("div",{className:"h-100"},r?Object(s.jsx)("div",{className:"h-100"},n,Object(s.jsx)("div",{className:"d-none"},t)):a)),!this.props.disableAddData&&Object(s.jsx)("div",{className:" d-flex align-items-center px-3 ds-add-data",onClick:this.showExternalDs},Object(s.jsx)("div",{className:"add-data-icon-container d-flex align-items-center justify-content-center mr-2"},Object(s.jsx)(P.Icon,{icon:qt,size:12,className:"add-data-icon"})),Object(s.jsx)("div",{className:"text-truncate flex-grow-1"},this.props.intl.formatMessage({id:"addNewData",defaultMessage:P.defaultMessages.addNewData})))),this.props.isDataSourceInited?null:Object(s.jsx)("div",{className:"jimu-secondary-loading"})),this.state.isExternalDsShown?Object(s.jsx)(P.Modal,{isOpen:this.state.isExternalDsShown,style:this.externalDsStyle,toggle:this.onToggleExternalDs,contentClassName:"h-100",className:"widget-ds-setting-add-data-popup"},this.ExternalDs):null)},t}(s.React.PureComponent),Xt=Object(s.injectIntl)(s.themeUtils.withStyles(s.ReactRedux.connect((function(e){return{dataSources:e.appStateInBuilder&&e.appStateInBuilder.appConfig&&e.appStateInBuilder.appConfig.dataSources}}))(Qt),"DataSourceList")),Kt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Yt=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function i(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((a=a.apply(e,t||[])).next())}))},Zt=function(e,t){var n,a,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function i(r){return function(i){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,i])}}},$t=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),o=0;for(t=0;t<n;t++)for(var r=arguments[t],s=0,i=r.length;s<i;s++,o++)a[o]=r[s];return a},en=function(e){function t(t){var n=e.call(this,t)||this;return n.__unmount=!1,n.onCloseRemoveOptions=function(e){n.stopPropagation(e),n.props.toggle()},n.onCheckboxBtnClick=function(e,t){n.stopPropagation(t);var a=n.state.selectedWidgets.indexOf(e);a<0?n.state.selectedWidgets.push(e):n.state.selectedWidgets.splice(a,1),n.setState({selectedWidgets:$t(n.state.selectedWidgets)})},n.onRemove=function(e){return Yt(n,void 0,void 0,(function(){var t,n,a,o,r,i,l,c,u,d,p,h,f,m,g,v=this;return Zt(this,(function(S){switch(S.label){case 0:return this.stopPropagation(e),this.state.getAppConfigAction?(t=this.state.getAppConfigAction(),this.state.selectedWidgets.length>0&&this.state.selectedWidgets.forEach((function(e,n){t.removeWidget(e)})),(null==(n=s.DataSourceManager.getInstance().getDataSource(this.props.dataSourceId))?void 0:n.isDataView)?(a=n.getDataSourceJson(),o=n.dataViewId,r=(r=a.dataViews||Object(s.Immutable)({})).without(o),i=Z(a.setIn(["dataViews"],r)),t.editDataSource(i).exec(),[3,5]):[3,1]):[3,5];case 1:return l=null===(f=Object(s.getAppStore)().getState().appStateInBuilder)||void 0===f?void 0:f.appConfig.appProxies,c={},u=[],d=[],(null===(m=this.state.proxySettingUtils)||void 0===m?void 0:m.traverseToGetNeedProxyDataSources)?[4,this.state.proxySettingUtils.traverseToGetNeedProxyDataSources(n)]:[3,3];case 2:return h=S.sent(),[3,4];case 3:h={},S.label=4;case 4:c=h,Object.keys(c).forEach((function(e){var t;(p=null===(t=v.state.proxySettingUtils)||void 0===t?void 0:t.getProxyJsonFromSourceUrl(e,l))&&(d.push(p.id),u.push(p.proxyId))})),t.removeDataSource(this.props.dataSourceId).exec(),null===(g=this.state.proxySettingUtils)||void 0===g||g.deleteProxies(u,t).then((function(){d.forEach((function(e){t.removeAppProxy(e)})),t.exec()})),S.label=5;case 5:return this.props.toggle(),[2]}}))}))},n.stopPropagation=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},n.state={selectedWidgets:[],getAppConfigAction:null,proxySettingUtils:null},n}return Kt(t,e),t.prototype.componentDidMount=function(){var e=this;this.__unmount=!1,Promise.all([s.moduleLoader.loadModule("jimu-for-builder"),s.moduleLoader.loadModule("jimu-ui/advanced/setting-components")]).then((function(t){var n=t[0].getAppConfigAction,a=t[1].proxySettingUtils;e.__unmount||e.setState({getAppConfigAction:n,proxySettingUtils:a})}))},t.prototype.componentWillUnmount=function(){this.__unmount=!0},t.prototype.render=function(){var e,t=this;if(!this.props.dataSourceId)return null;var n=s.DataSourceManager.getInstance().getDataSource(this.props.dataSourceId);return Object(s.jsx)(P.Modal,{isOpen:this.props.isOpen,className:Object(s.classNames)("bg-light-300 d-flex justify-content-between",(e={},e[this.props.className]=!!this.props.className,e)),onClick:this.stopPropagation},Object(s.jsx)(P.ModalHeader,{className:"d-flex justify-content-between border-color-gray-300 py-3 font-16 font-dark-600",onClick:this.stopPropagation,toggle:this.props.toggle},this.props.intl.formatMessage({id:"removeDataSource",defaultMessage:P.defaultMessages.removeDataSource})),Object(s.jsx)(P.ModalBody,{onClick:this.stopPropagation},Object(s.jsx)("div",{className:"p-2"},Object(s.jsx)("p",{className:"font-13 font-dark-600"},this.props.intl.formatMessage({id:"youAreRemovingData",defaultMessage:P.defaultMessages.youAreRemovingData})),Object(s.jsx)("p",{className:"font-14 font-dark-800 mt-3"},n&&n.getLabel()||this.props.dataSourceId),Object(s.jsx)("p",{className:"font-13 font-dark-600 mt-3"},this.props.intl.formatMessage({id:"affectedWidgets",defaultMessage:P.defaultMessages.affectedWidgets})),Object(s.jsx)("p",{className:"font-14 font-dark-400 mt-5"},this.props.intl.formatMessage({id:"relatedWidgets",defaultMessage:P.defaultMessages.relatedWidgets})),Object(s.jsx)("div",{className:"related-widgets px-2 py-3"},Object(s.jsx)("div",null,W(this.props.dataSourceId,this.props.widgets).map((function(e){return e&&e.id?Object(s.jsx)(P.Label,{key:e.id,className:"d-flex"},Object(s.jsx)(P.Checkbox,{className:"mr-2 font-13",onClick:function(n){return t.onCheckboxBtnClick(e.id,n)},checked:t.state.selectedWidgets.includes(e.id)}),Object(s.jsx)(P.Icon,{icon:e.icon,size:"16",className:"mr-1 font-dark-800"}),e.label):null})))),Object(s.jsx)("p",{className:"font-13 font-dark-600 mt-2"},this.props.intl.formatMessage({id:"howToRemoveWidgetsTip",defaultMessage:P.defaultMessages.howToRemoveWidgetsTip})))),Object(s.jsx)(P.ModalFooter,null,Object(s.jsx)("div",{className:"d-flex justify-content-end mt-10"},Object(s.jsx)(P.Button,{type:"primary",className:"mr-2",onClick:this.onRemove},this.props.intl.formatMessage({id:"removeDataSource",defaultMessage:P.defaultMessages.removeDataSource})),Object(s.jsx)(P.Button,{type:"default",onClick:this.onCloseRemoveOptions},this.props.intl.formatMessage({id:"cancel",defaultMessage:s.defaultMessages.cancel})))))},t}(s.React.PureComponent),tn=s.ReactRedux.connect((function(e,t){var n,a,o,r;return{widgets:(null===(n=null==e?void 0:e.appContext)||void 0===n?void 0:n.isBuilder)?null===(o=null===(a=null==e?void 0:e.appStateInBuilder)||void 0===a?void 0:a.appConfig)||void 0===o?void 0:o.widgets:null===(r=null==e?void 0:e.appConfig)||void 0===r?void 0:r.widgets}}))(en),nn=Object(s.injectIntl)(s.themeUtils.withStyles(tn,"DataSourceRemoveWarningPopup")),an=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),on=function(){return(on=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},rn=n(65),sn=n(94),ln=n(266),cn=n(267),un=function(e){function t(n){var a=e.call(this,n)||this;a.__unmount=!1,a.lastScrollTop=0,a.initQueryParams=function(){a.setState({queryParams:{page:1,pageSize:"number"==typeof a.state.dataView.maximum?Math.min(a.state.dataView.maximum,15):15}})},a.setQueryParams=function(){var e=a.state.dataView,t="number"==typeof(null==e?void 0:e.maximum)?e.maximum<=15?1:Math.ceil(e.maximum/15):null,n="number"==typeof(null==e?void 0:e.maximum)?Math.min(e.maximum,15):15,o=a.state.queryParams.page;t?o+1<=t&&(o+=1):o+=1,a.setState({queryParams:{page:o,pageSize:n}})},a.setLocalDataSource=function(){var e,t,n;a.setState({isLocalDataSourceCreated:!1});var o=a.state.dataView;o=null==o?void 0:o.set("orderBy",null===(e=null==o?void 0:o.orderBy)||void 0===e?void 0:e.filter((function(e){return!!e.jimuFieldName})));var r=a.props.mainDataSource.getDataSourceJson().set("id",a.getLocalLoadId()).set("query",o).set("isHidden",!0);if(!a.props.isSettingMainDataSource){var i=null===(t=a.props.mainDataSource.getDataSourceJson())||void 0===t?void 0:t.query;i&&"number"==typeof i.maximum&&(r=r.setIn(["query","maximum"],"number"==typeof r.query.maximum?Math.min(r.query.maximum,i.maximum):i.maximum))}var l=s.DataSourceManager.getInstance().getDataSource(a.getLocalLoadId());l?(s.DataSourceManager.getInstance().updateDataSourceByDataSourceJson(l,r),s.lodash.defer((function(){!a.__unmount&&a.props.isOpen&&a.setState({localDataSource:l,isLocalDataSourceCreated:!0})}))):s.DataSourceManager.getInstance().createDataSource({id:r.id,dataSourceJson:r,layer:null===(n=a.props.mainDataSource)||void 0===n?void 0:n.layer}).then((function(e){!a.__unmount&&a.props.isOpen&&a.setState({localDataSource:e,isLocalDataSourceCreated:!0})}),(function(e){console.error("Preview table error: ",e),!a.__unmount&&a.props.isOpen&&a.setState({isLocalDataSourceCreated:!0})}))},a.loadLocalDataSource=function(){a.setState({isLocalDataSourceLoaded:!1});var e=on({page:1,pageSize:a.state.queryParams.page*a.state.queryParams.pageSize},{outFields:["*"]});if(!a.props.isSettingMainDataSource){var t=a.props.mainDataSource.getConfigQueryParams()||{};e=a.props.mainDataSource.mergeQueryParams(t,e)}a.state.localDataSource.load(e,{widgetId:a.getLocalLoadId(),scope:s.QueryScope.InConfigView}).then((function(){!a.__unmount&&a.props.isOpen&&a.setState({isLocalDataSourceLoaded:!0})}),(function(e){console.error("Preview table error: ",e),!a.__unmount&&a.props.isOpen&&a.setState({isLocalDataSourceLoaded:!0})}))},a.getUseDataSource=function(e){if(!e)return null;var t=e.getRootDataSource(),n=e.getMainDataSource();return Object(s.Immutable)({dataSourceId:e.id,rootDataSourceId:t&&t.id,mainDataSourceId:n&&n.id})},a.getNewDataView=function(e){if(!e)return Object(s.Immutable)({});var t=e.getDataSourceJson(),n=(null==t?void 0:t.dataViews)?Object.keys(t.dataViews):null,o=n&&n.map((function(e){return e.split("_")[1]})).filter((function(e){return a.isNumeric(e)})).length>0?Math.max.apply(null,n.map((function(e){return e.split("_")[1]})).filter((function(e){return a.isNumeric(e)})))+1:1;return Object(s.Immutable)({id:a.props.newDataViewId||"dataView_"+o,label:a.props.newDataViewLabel||a.props.intl.formatMessage({id:"dataView",defaultMessage:P.defaultMessages.dataView})+" "+o})},a.getPreviewTable=function(e){var t,n=null===(t=e)||void 0===t?void 0:t.getRecordsByPage(1,a.state.queryParams.pageSize*a.state.queryParams.page),o=null==e?void 0:e.getSchema(),r=null==o?void 0:o.fields;if(!n||!r)return null;var i=Object.values(r).sort((function(e,t){var n;return null===(n=e.name)||void 0===n?void 0:n.localeCompare(t.name)}));return Object(s.jsx)("div",{className:"table-container mr-2",onScroll:a.onScroll},Object(s.jsx)("div",{className:"table-header"},Object(s.jsx)("table",null,Object(s.jsx)("thead",null,Object(s.jsx)("tr",{className:"d-flex"},i.map((function(e,t){return Object(s.jsx)("th",{key:t,title:e.alias||e.name},e.alias||e.name)})))))),Object(s.jsx)("div",{className:"table-body"},Object(s.jsx)("table",null,Object(s.jsx)("tbody",null,n.map((function(e,t){return Object(s.jsx)("tr",{className:"d-flex",key:t},i.map((function(t,n){var o=e.getFormattedFieldValue(t.jimuName,a.props.intl);return Object(s.jsx)("td",{key:n,title:o},o)})))}))))))},a.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},a.onScroll=function(e){var t=e.target.clientHeight,n=e.target.scrollHeight,o=e.target.scrollTop,r=n-(t+o)<=10,s=o>a.lastScrollTop;a.lastScrollTop=o<=0?0:o,a.state.isLocalDataSourceCreated&&a.state.isLocalDataSourceLoaded&&r&&s&&a.setQueryParams()},a.onDuplicate=function(){var e;if(a.props.onDuplicate){var t=a.getNewDataView(a.props.mainDataSource);t=a.props.dataView?a.props.dataView.merge(t.asMutable({deep:!0})):t,(null===(e=a.props.dataView)||void 0===e?void 0:e.label)&&(t=t.set("label",a.getDuplicateLabel(a.props.dataView.label))),a.props.onDuplicate(t)}},a.onRemove=function(e){var t,n,o;e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();var r=s.DataSourceManager.getInstance().getDataViewDataSourceId(null===(t=a.props.mainDataSource)||void 0===t?void 0:t.id,null===(n=a.props.dataView)||void 0===n?void 0:n.id);0===W(r,a.props.widgets).length?(a.state.getAppConfigAction&&(a.removeDataView(null===(o=a.props.dataView)||void 0===o?void 0:o.id),s.DataSourceManager.getInstance().destroyDataSource(r)),a.props.toggle()):a.setState({isRemoveWarningOpen:!0},(function(){return a.props.toggle()}))},a.removeDataView=function(e){var t;if(e&&a.state.getAppConfigAction){var n=null===(t=a.props.mainDataSource)||void 0===t?void 0:t.getDataSourceJson(),o=n.dataViews||Object(s.Immutable)({});o=o.without(e);var r=Z(n.setIn(["dataViews"],o));a.state.getAppConfigAction().editDataSource(r).exec()}},a.onLabelChange=function(e){var t=a.state.dataView;t=t.set("label",e.target.value),a.setState({dataView:t})},a.onSqlExprBuilderChange=function(e){var t=a.state.dataView;t=t.set("where",e),a.setState({dataView:t})},a.onSortChange=function(e,t){var n=a.state.dataView;n=n.set("orderBy",e),a.setState({dataView:n})},a.onPageSizeChange=function(e){var t=a.state.dataView,n="string"==typeof e?parseInt(e):e;t=n&&n>=1?t.set("pageSize",n):t.without("pageSize"),a.setState({dataView:t})},a.onToggleMaximum=function(e,t){var n=a.state.dataView;n=t?n.set("maximum",100):n.without("maximum"),a.setState({dataView:n})},a.onMaximumChange=function(e){var t=a.state.dataView,n="string"==typeof e?parseInt(e):e;t=n&&n>=1?t.set("maximum",n):t.set("maximum",100),a.setState({dataView:t})},a.onApply=function(){var e,t=a.state.dataView;t=null==t?void 0:t.set("orderBy",null===(e=null==t?void 0:t.orderBy)||void 0===e?void 0:e.filter((function(e){return!!e.jimuFieldName}))),a.props.onApply(t)},a.toggleTitleInput=function(){a.setState({isTitleInputShown:!a.state.isTitleInputShown})},a.toggleRemoveWarning=function(){a.setState({isRemoveWarningOpen:!a.state.isRemoveWarningOpen})},t.count++;var o=a.props.dataView||a.getNewDataView(a.props.mainDataSource);return a.state={dataView:o,localDataSource:null,isTitleInputShown:!1,isRemoveWarningOpen:!1,isLocalDataSourceCreated:!1,isLocalDataSourceLoaded:!1,SqlExpressionBuilder:null,Sort:null,getAppConfigAction:null,isSqlExpressionValid:null,queryParams:{page:1,pageSize:"number"==typeof(null==o?void 0:o.maximum)?Math.min(o.maximum,15):15}},a}return an(t,e),t.prototype.componentDidMount=function(){var e=this;this.__unmount=!1,Promise.all([s.moduleLoader.loadModule("jimu-ui/advanced/sql-expression-builder"),s.moduleLoader.loadModule("jimu-ui/basic/sql-expression-runtime"),s.moduleLoader.loadModule("jimu-for-builder")]).then((function(t){var n=t[0],a=t[1].isSqlExpressionValid,o=t[2].getAppConfigAction;e.__unmount||e.setState({SqlExpressionBuilder:n.SqlExpressionBuilder,Sort:n.Sort,getAppConfigAction:o,isSqlExpressionValid:a})})),this.props.isOpen&&this.setLocalDataSource()},t.prototype.componentDidUpdate=function(e,t){var n,a,o,r;s.lodash.isDeepEqual(e.dataView,this.props.dataView)?this.props.isOpen&&(this.state.localDataSource&&e.mainDataSource===this.props.mainDataSource&&s.lodash.isDeepEqual(null===(n=t.dataView)||void 0===n?void 0:n.without("label"),null===(a=this.state.dataView)||void 0===a?void 0:a.without("label"))||this.setLocalDataSource(),(!s.lodash.isDeepEqual(t.queryParams,this.state.queryParams)||!t.isLocalDataSourceCreated&&this.state.isLocalDataSourceCreated)&&this.loadLocalDataSource()):(this.initQueryParams(),this.setState({dataView:this.props.dataView||this.getNewDataView(this.props.mainDataSource)})),(null===(o=t.dataView)||void 0===o?void 0:o.maximum)!==(null===(r=this.state.dataView)||void 0===r?void 0:r.maximum)&&this.initQueryParams(),e.isOpen&&!this.props.isOpen&&this.destroyLocalDataSource(),t.isTitleInputShown!==this.state.isTitleInputShown&&this.state.isTitleInputShown&&this.titleInput&&(this.titleInput.focus(),this.titleInput.select())},t.prototype.componentWillUnmount=function(){this.__unmount=!0,this.destroyLocalDataSource()},t.prototype.destroyLocalDataSource=function(){this.state.localDataSource&&s.DataSourceManager.getInstance().destroyDataSource(this.state.localDataSource.id),this.__unmount||(this.setState({isLocalDataSourceCreated:!1,isLocalDataSourceLoaded:!1,localDataSource:null,dataView:this.props.dataView||this.getNewDataView(this.props.mainDataSource)}),this.initQueryParams())},t.prototype.getLocalLoadId=function(){return"DATA_VIEW_SETTING-"+t.count},t.prototype.getDuplicateLabel=function(e){for(var t,n=this,a=null===(t=this.props.intl.formatMessage({id:"copy",defaultMessage:P.defaultMessages.copy}))||void 0===t?void 0:t.toLocaleLowerCase(),o=e+" "+a,r=1;this.props.mainDataSource.getDataSourceJson().dataViews&&Object.keys(this.props.mainDataSource.getDataSourceJson().dataViews).find((function(e){var t;return(null===(t=n.props.mainDataSource.getDataSourceJson().dataViews[e])||void 0===t?void 0:t.label)===o}));)r++,o=e+" "+a+" "+r;return o},t.prototype.render=function(){var e,t,n,a,o,r=this;if(!this.props.mainDataSource.query)return null;var i=this.state.dataView,l=s.DataSourceManager.getInstance().getDataViewDataSourceId(null===(t=this.props.mainDataSource)||void 0===t?void 0:t.id,null===(n=this.props.dataView)||void 0===n?void 0:n.id),c=this.state.SqlExpressionBuilder,u=this.state.Sort;return Object(s.jsx)("div",null,Object(s.jsx)(P.Modal,{className:Object(s.classNames)((e={},e[this.props.className]=!!this.props.className,e)),isOpen:this.props.isOpen,centered:!0,toggle:this.props.toggle,returnfocusafterclose:"true",contentClassName:"data-view-container",backdrop:"static"},Object(s.jsx)(P.ModalHeader,{className:"d-flex justify-content-between header"},Object(s.jsx)("div",{className:"flex-grow-1 text-truncate"},this.props.disableRename?Object(s.jsx)("div",{className:"flex-grow-1 text-truncate",title:null==i?void 0:i.label},null==i?void 0:i.label):Object(s.jsx)("div",{className:"d-flex align-items-center pr-3"},this.state.isTitleInputShown?Object(s.jsx)(P.TextInput,{className:"flex-grow-1",value:null==i?void 0:i.label,onChange:this.onLabelChange,ref:function(e){return r.titleInput=e},onBlur:this.toggleTitleInput,onKeyUp:this.toggleTitleInput}):Object(s.jsx)("div",{className:"text-truncate",onClick:this.toggleTitleInput},null==i?void 0:i.label),Object(s.jsx)(P.Button,{className:"flex-shrink-0 ml-2",type:"tertiary",size:"sm",icon:!0,onClick:this.toggleTitleInput,title:this.props.intl.formatMessage({id:"edit",defaultMessage:P.defaultMessages.edit})},Object(s.jsx)(P.Icon,{icon:sn,size:16})))),Object(s.jsx)("div",{className:"flex-shrink-0"},!this.props.disableDuplicate&&this.props.dataView&&Object(s.jsx)(P.Button,{className:"flex-shrink-0 cicle-button mr-3",type:"default",size:"sm",icon:!0,onClick:this.onDuplicate,title:this.props.intl.formatMessage({id:"duplicate",defaultMessage:P.defaultMessages.duplicate})},Object(s.jsx)(P.Icon,{icon:ln,size:16})),!this.props.disableRemove&&this.props.dataView&&Object(s.jsx)(P.Button,{className:"flex-shrink-0 cicle-button",type:"default",size:"sm",icon:!0,onClick:this.onRemove,title:this.props.intl.formatMessage({id:"delete",defaultMessage:s.defaultMessages.delete})},Object(s.jsx)(P.Icon,{icon:cn,size:16})))),i?Object(s.jsx)(P.ModalBody,{className:"d-flex"},Object(s.jsx)("div",{className:"w-38 h-100 flex-shrink-0"},Object(s.jsx)(P.Tabs,{underline:!0,fill:!0,className:"h-100"},Object(s.jsx)(P.Tab,{id:"filter",className:"view-tab",title:this.props.intl.formatMessage({id:"filter",defaultMessage:P.defaultMessages.filter}),defaultActive:!0},c&&Object(s.jsx)(c,{dataSource:this.props.mainDataSource,mode:s.SqlExpressionMode.Simple,expression:i.where,onChange:this.onSqlExprBuilderChange,queryScope:this.props.isSettingMainDataSource&&s.QueryScope.InRemoteConfigView})),Object(s.jsx)(P.Tab,{id:"sort",className:"view-tab",title:this.props.intl.formatMessage({id:"sort",defaultMessage:P.defaultMessages.sort})},u&&Object(s.jsx)(u,{onChange:this.onSortChange,value:i.orderBy||Object(s.Immutable)([]),useDataSource:this.getUseDataSource(this.props.mainDataSource)})),Object(s.jsx)(P.Tab,{id:"records",className:"view-tab",title:this.props.intl.formatMessage({id:"records",defaultMessage:P.defaultMessages.records})},Object(s.jsx)("div",null,Object(s.jsx)("div",{className:"d-flex justify-content-between mb-3"},Object(s.jsx)("div",{className:"label"},this.props.intl.formatMessage({id:"pageSize",defaultMessage:P.defaultMessages.pageSize})),Object(s.jsx)(P.NumericInput,{size:"sm",value:i.pageSize||s.CONSTANTS.DEFAULT_QUERY_PAGE_SIZE,onAcceptValue:this.onPageSizeChange,showHandlers:!1,precision:0,min:1})),Object(s.jsx)("div",{className:"d-flex justify-content-between mb-2"},Object(s.jsx)("div",{className:"label"},this.props.intl.formatMessage({id:"maximum",defaultMessage:P.defaultMessages.maximum})),Object(s.jsx)(P.Switch,{checked:"number"==typeof i.maximum,onChange:this.onToggleMaximum})),"number"==typeof i.maximum&&Object(s.jsx)("div",{className:"d-flex justify-content-between mb-3"},Object(s.jsx)("div",{className:"label"},this.props.intl.formatMessage({id:"maximumLimitationWarning",defaultMessage:P.defaultMessages.maximumLimitationWarning})),Object(s.jsx)(P.Link,{to:"https://developers.arcgis.com/javascript/latest/api-reference/esri-views-layers-FeatureLayerView.html#maximumNumberOfFeatures",className:"ml-2",target:"_blank"},this.props.intl.formatMessage({id:"details",defaultMessage:P.defaultMessages.details}))),"number"==typeof i.maximum&&Object(s.jsx)("div",{className:"d-flex justify-content-between mb-3"},Object(s.jsx)("div",{className:"label"},this.props.intl.formatMessage({id:"maximumRecordCount",defaultMessage:P.defaultMessages.maximumRecordCount})),Object(s.jsx)(P.NumericInput,{size:"sm",value:i.maximum,onAcceptValue:this.onMaximumChange,precision:0,min:1,showHandlers:!1})))))),Object(s.jsx)("div",{className:"w-62 h-100 flex-grow-1 pl-3 preview-table"},this.getPreviewTable(this.state.localDataSource),(!this.state.isLocalDataSourceCreated||!this.state.isLocalDataSourceLoaded)&&Object(s.jsx)(P.Loading,{type:P.LoadingType.Primary}))):null,Object(s.jsx)(P.ModalFooter,{className:"d-flex justify-content-between"},Object(s.jsx)("div",null,this.state.isSqlExpressionValid&&!this.state.isSqlExpressionValid(null===(a=this.state.dataView)||void 0===a?void 0:a.where)&&Object(s.jsx)("div",{className:"sql-exp-warning text-truncate",title:this.props.intl.formatMessage({id:"sqlExprIncomplete",defaultMessage:P.defaultMessages.sqlExprIncomplete})},Object(s.jsx)(P.Icon,{icon:rn,size:18,className:"sql-exp-warning-icon mr-2"}),this.props.intl.formatMessage({id:"sqlExprIncomplete",defaultMessage:P.defaultMessages.sqlExprIncomplete}))),Object(s.jsx)("div",null,Object(s.jsx)(P.Button,{className:"mr-2",type:"primary",onClick:this.onApply,disabled:!this.state.isSqlExpressionValid||!this.state.isSqlExpressionValid(null===(o=this.state.dataView)||void 0===o?void 0:o.where)},this.props.intl.formatMessage({id:"applyChanges",defaultMessage:P.defaultMessages.applyChanges})),Object(s.jsx)(P.Button,{type:"default",onClick:this.props.toggle},this.props.intl.formatMessage({id:"cancel",defaultMessage:s.defaultMessages.cancel}))))),Object(s.jsx)(nn,{dataSourceId:l,isOpen:this.state.isRemoveWarningOpen,toggle:this.toggleRemoveWarning}))},t.count=-1,t}(s.React.PureComponent),dn=s.ReactRedux.connect((function(e,t){var n,a,o,r;return{widgets:(null===(n=null==e?void 0:e.appContext)||void 0===n?void 0:n.isBuilder)?null===(o=null===(a=null==e?void 0:e.appStateInBuilder)||void 0===a?void 0:a.appConfig)||void 0===o?void 0:o.widgets:null===(r=null==e?void 0:e.appConfig)||void 0===r?void 0:r.widgets}}))(un),pn=Object(s.injectIntl)(s.themeUtils.withStyles(dn,"DataViewSettingPopup")),hn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),fn=n(36),mn=n(105),gn=n(128),vn=function(e){function t(t){var n=e.call(this,t)||this;return n.__unmount=!1,n.onRemove=function(e){var t=n.props.onRemove;t&&t(n.props.mainDataSourceId)},n.onDataViewChange=function(e){var t=e.target.value;if(t&&"create_a_view"!==t){var a=n.getAllDataViews()[t],o=Object(s.Immutable)([a.asMutable({deep:!0})]);n.props.onChange(n.props.mainDataSourceId,o)}},n.onMultiDataViewChange=function(e,t){if(t&&"create_a_view"!==t){var a=n.getAllDataViews()[t],o=n.props.dataViews||Object(s.Immutable)([]),r=n.props.dataViews&&n.props.dataViews.find((function(e){return e.id===a.id}))?o.filter((function(e){return e.id!==a.id})):o.concat(a);n.props.onChange(n.props.mainDataSourceId,r)}},n.formatMessage=function(e,t){var a=Object.assign({},P.defaultMessages);return n.props.intl.formatMessage({id:e,defaultMessage:a[e]},t)},n.getDsLabel=function(e){var t=s.DataSourceManager.getInstance(),a=e&&t.getDataSource(e);return a&&a.getLabel()||n.formatMessage("none")},n.getWhetherItemError=function(e){var t=s.DataSourceManager.getInstance();return!(e&&t.getDataSource(e))},n.getAllDataViews=function(){if(!n.props.mainDataSourceId)return null;var e=s.DataSourceManager.getInstance().getDataSource(n.props.mainDataSourceId);if(null==e?void 0:e.isDataSourceSet)return null;var t=e&&e.getDataSourceJson(),a=(null==t?void 0:t.dataViews)||Object(s.Immutable)({});a=a.set(n.props.DefaultDataView.id,(null==t?void 0:t.query)?t.query.merge(n.props.DefaultDataView.asMutable({deep:!0})):n.props.DefaultDataView);var o={id:s.CONSTANTS.SELECTION_DATA_VIEW_ID,label:n.props.intl.formatMessage({id:"selectionDataView",defaultMessage:P.defaultMessages.selectionDataView})};return a=(a=(a=a.set(s.CONSTANTS.SELECTION_DATA_VIEW_ID,o)).without(s.CONSTANTS.DATA_VIEW_ID_FOR_NO_SELECTION)).without(s.CONSTANTS.OUTPUT_DATA_VIEW_ID)},n.getMultiSelectItems=function(e){if(!n.props.mainDataSourceId)return Object(s.Immutable)([]);var t=[];return e&&Object.keys(e).forEach((function(a){t.push({value:a,label:e[a].label,render:function(t){return Object(s.jsx)("div",{className:"d-flex w-100 align-items-center justify-content-between"},Object(s.jsx)("div",{className:"d-flex align-items-center"},Object(s.jsx)(P.Checkbox,{checked:n.getSelectedValueForMutiSelect().includes(t.value)}),Object(s.jsx)("span",{className:"ml-2"},e[a].label)),n.getWhetherAllowToChangeViewSetting(a)&&Object(s.jsx)("div",{className:"px-2",onClick:function(t){return n.onDataViewClick(t,e[a])},title:n.props.intl.formatMessage({id:"settings",defaultMessage:P.defaultMessages.settings})},Object(s.jsx)(P.Icon,{icon:gn,size:12})))}})})),n.getWhetherAllowToCreateView()&&t.push({value:"create_a_view",render:function(){return n.getCreateViewButton()}}),Object(s.Immutable)(t)},n.getCreateViewButton=function(){return Object(s.jsx)("div",{onClick:n.onCreateViewClick,className:"create-view-button"},Object(s.jsx)(P.Icon,{icon:mn,size:12,className:"create-view-icon"}),Object(s.jsx)("span",{className:"ml-2"},n.formatMessage("createAView")))},n.getSelectedValueForSingleSelect=function(){var e;return n.props.dataViews&&n.props.dataViews.length>0?null===(e=n.props.dataViews[0])||void 0===e?void 0:e.id:n.props.DefaultDataView.id},n.getSelectedValueForMutiSelect=function(){return n.props.dataViews&&n.props.dataViews.length>0?n.props.dataViews.map((function(e){return e.id})):Object(s.Immutable)([n.props.DefaultDataView.id])},n.getMultiSelectSelectedString=function(e){if(e)return n.formatMessage("numSelected",{number:e.length})},n.onDataViewClick=function(e,t){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),n.setState({settingDataView:t}),n.toggleViewSetting()},n.onCreateViewClick=function(){n.setState({settingDataView:null}),n.toggleViewSetting()},n.toggleViewSetting=function(){return n.setState({isViewSettingOpen:!n.state.isViewSettingOpen})},n.toggleViewSelect=function(){return n.setState({isViewSelectOpen:!n.state.isViewSelectOpen})},n.stopPropagation=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},n.onDataViewSettingApply=function(e){e.id===n.props.DefaultDataView.id?n.editQuery(e):n.editDataView(e)},n.editQuery=function(e){if(e){var t=n.state.getAppConfigAction;if(t){var a=s.DataSourceManager.getInstance().getDataSource(n.props.mainDataSourceId),o=a&&a.getDataSourceJson();if(o){var r=Z(o.setIn(["query"],(null==o?void 0:o.query)?o.query.merge(e.without("id").without("label").asMutable({deep:!0})):e.set("id","default").set("label",a.getLabel())));t().editDataSource(r).exec(),a.addSourceVersion(),n.toggleViewSetting()}}}},n.editDataView=function(e){if(e){var t=n.state.getAppConfigAction;if(t){var a=s.DataSourceManager.getInstance().getDataSource(n.props.mainDataSourceId),o=a&&a.getDataSourceJson(),r=o.dataViews||Object(s.Immutable)({});r=r.set(e.id,e);var i=Z(o.setIn(["dataViews"],r));t().editDataSource(i).exec(),a.getDataView(null==e?void 0:e.id)?(n.setState({settingDataView:e}),a.addSourceVersion(),n.toggleViewSetting()):s.DataSourceManager.getInstance().createDataSource(o,e.id).then((function(){n.__unmount||(n.setState({settingDataView:e}),n.toggleViewSetting())}))}}},n.getWhetherAllowToCreateView=function(){var e=s.DataSourceManager.getInstance().getDataSource(n.props.mainDataSourceId);return e&&!e.isDataSourceSet&&!e.getDataSourceJson().isOutputFromWidget},n.getWhetherAllowToChangeViewSetting=function(e){var t;if(e===s.CONSTANTS.SELECTION_DATA_VIEW_ID)return!1;var a=s.DataSourceManager.getInstance().getDataSource(n.props.mainDataSourceId);return!(null===(t=null==a?void 0:a.getDataSourceJson())||void 0===t?void 0:t.isOutputFromWidget)},n.state={isViewSettingOpen:!1,isViewSelectOpen:!1,settingDataView:null,getAppConfigAction:null},n}return hn(t,e),t.prototype.componentDidMount=function(){var e=this;this.__unmount=!1,s.moduleLoader.loadModule("jimu-for-builder").then((function(t){e.__unmount||e.setState({getAppConfigAction:t.getAppConfigAction})}))},t.prototype.componentWillUnmount=function(){this.__unmount=!0},t.prototype.render=function(){var e,t,n,a=this,o=this.props.mainDataSourceId;if(!o)return null;var r=s.DataSourceManager.getInstance().getDataSource(o),i=r&&r.getDataSourceJson(),l=this.getAllDataViews(),c=Object(s.jsx)(P.Button,{icon:!0,size:"sm",type:"tertiary",title:this.formatMessage("remove"),onClick:this.onRemove,className:"ds-item-close"},Object(s.jsx)(P.Icon,{icon:fn,size:"12"})),u=this.getWhetherAllowToCreateView();return Object(s.jsx)("div",{className:this.props.className?"w-100 "+this.props.className:"w-100"},i&&Object(s.jsx)("div",{className:Object(s.classNames)("ds-item",{"ds-error-item":this.getWhetherItemError(o),"disable-cursor":this.props.disableDataSourceList}),onClick:this.props.onClick},Object(s.jsx)("div",{className:"d-flex align-items-center w-100 item"},Object(s.jsx)("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail"},Object(s.jsx)(P.Icon,{icon:X(i),className:"text-dark",size:"12"})),Object(s.jsx)("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},Object(s.jsx)("div",{className:"text-truncate ds-type-name",title:this.getDsLabel(o)},this.getDsLabel(o))),!this.props.hideRemove&&c),!this.props.hideDataView&&l&&Object.keys(l).length>0&&Object(s.jsx)("div",{className:"dv-select-container"},this.props.isMultiple?Object(s.jsx)(P.MultiSelect,{fluid:!0,items:this.getMultiSelectItems(l),onClickItem:this.onMultiDataViewChange,values:this.getSelectedValueForMutiSelect(),buttonProps:{disabled:this.props.disableDataView},displayByValues:this.getMultiSelectSelectedString}):Object(s.jsx)(P.Select,{value:this.getSelectedValueForSingleSelect(),onChange:this.onDataViewChange,onClick:this.stopPropagation,isOpen:this.state.isViewSelectOpen,toggle:this.toggleViewSelect,disabled:this.props.disableDataView},Object.values(l).map((function(e,t){return Object(s.jsx)("option",{value:e.id,key:t},Object(s.jsx)("div",{className:"d-flex justify-content-between align-items-center w-100"},Object(s.jsx)("div",null,e.label),a.state.isViewSelectOpen&&a.getWhetherAllowToChangeViewSetting(e.id)&&Object(s.jsx)("div",{className:"px-2 settings-icon",onClick:function(t){return a.onDataViewClick(t,e)},title:a.props.intl.formatMessage({id:"settings",defaultMessage:P.defaultMessages.settings})},Object(s.jsx)(P.Icon,{icon:gn,size:12}))))})),u&&Object(s.jsx)("option",{value:"create_a_view"},this.getCreateViewButton())))),u&&Object(s.jsx)(pn,{isOpen:this.state.isViewSettingOpen,toggle:this.toggleViewSetting,onApply:this.onDataViewSettingApply,onDuplicate:this.onDataViewSettingApply,mainDataSource:r,dataView:this.state.settingDataView,disableDuplicate:!this.state.settingDataView||(null===(e=this.state.settingDataView)||void 0===e?void 0:e.id)===this.props.DefaultDataView.id,disableRemove:!this.state.settingDataView||(null===(t=this.state.settingDataView)||void 0===t?void 0:t.id)===this.props.DefaultDataView.id,disableRename:!this.state.settingDataView||(null===(n=this.state.settingDataView)||void 0===n?void 0:n.id)===this.props.DefaultDataView.id}))},t}(s.React.PureComponent),Sn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),bn=function(e){function t(t){var n=e.call(this,t)||this;return n.__unmount=!1,n.DefaultDataView=Object(s.Immutable)({id:"USE_MAIN_DATA_SOURCE",label:n.props.intl.formatMessage({id:"default",defaultMessage:P.defaultMessages.default})}),n.changeInitStatus=function(e){n.setState({isDataSourceInited:e})},n.disableSelection=function(){if(n.props.disableSelection){var e=n.props.useDataSources||Object(s.Immutable)([]);return n.props.disableSelection(e.asMutable({deep:!0}))}return!1},n.disableRemove=function(){if(n.props.disableRemove){var e=n.props.useDataSources||Object(s.Immutable)([]);return n.props.disableRemove(e.asMutable({deep:!0}))}return!1},n.onModalClose=function(){n.setState({modalType:"none"})},n.onMainDsChanged=function(e){e&&(n.props.onChange&&n.props.onChange(e),n.props.closeDataSourceListOnChange&&n.setState({modalType:"none"}))},n.onMainDsRemoved=function(e){if(e&&n.props.useDataSources){var t=n.props.useDataSources.filter((function(t){return(null==t?void 0:t.mainDataSourceId)!==e}));n.props.onChange&&n.props.onChange(t.asMutable({deep:!0}))}},n.onDataViewChanged=function(e,t){if(e&&n.props.useDataSources){var a=Object(s.Immutable)(n.props.useDataSources.find((function(t){return t.mainDataSourceId===e}))||{dataSourceId:e,mainDataSourceId:e}),o=t.map((function(t){var n;if("USE_MAIN_DATA_SOURCE"===t.id){var o=s.DataSourceManager.getInstance().getDataSource(e);if(null===(n=null==o?void 0:o.getDataSourceJson())||void 0===n?void 0:n.isOutputFromWidget){var r=s.DataSourceManager.getInstance().getDataViewDataSourceId(e,s.CONSTANTS.OUTPUT_DATA_VIEW_ID),i=s.CONSTANTS.OUTPUT_DATA_VIEW_ID;return a.set("dataSourceId",r).set("dataViewId",i).asMutable({deep:!0})}return a.without("dataViewId").set("dataSourceId",e).asMutable({deep:!0})}return a.set("dataViewId",t.id).set("dataSourceId",s.DataSourceManager.getInstance().getDataViewDataSourceId(e,t.id)).asMutable({deep:!0})})),r=n.props.useDataSources.filter((function(t){return(null==t?void 0:t.mainDataSourceId)!==e})).concat(o);n.props.onChange&&n.props.onChange(r.asMutable({deep:!0}))}},n.toggleDsList=function(){n.props.disableDataSourceList||n.setState({modalType:"ds"===n.state.modalType?"none":"ds"})},n.getWhetherShowPlaceholder=function(){var e;if(null===(e=n.props.useDataSources)||void 0===e?void 0:e.some((function(e){return!s.DataSourceManager.getInstance().getDataSource(e.dataSourceId)})))return!0;if(n.props.disableSelection){var t=n.props.useDataSources||Object(s.Immutable)([]);return!n.props.disableSelection(t.asMutable({deep:!0}))}return n.props.isMultiple||!n.props.isMultiple&&(!n.props.useDataSources||0===n.props.useDataSources.filter((function(e){return!!e})).length)},n.groupUseDssByMainDataSource=function(e){if(!e||0===e.length)return null;var t={};return e.forEach((function(e){if(t[e.mainDataSourceId]||(t[e.mainDataSourceId]=Object(s.Immutable)([])),e.dataViewId===s.CONSTANTS.SELECTION_DATA_VIEW_ID)t[e.mainDataSourceId]=t[e.mainDataSourceId].concat({id:s.CONSTANTS.SELECTION_DATA_VIEW_ID,label:n.props.intl.formatMessage({id:"selectionDataView",defaultMessage:P.defaultMessages.selectionDataView})});else if(e.dataViewId===s.CONSTANTS.OUTPUT_DATA_VIEW_ID)t[e.mainDataSourceId]=t[e.mainDataSourceId].concat(n.DefaultDataView);else if(e.dataViewId){var a=s.DataSourceManager.getInstance().getDataSource(e.mainDataSourceId),o=a&&a.getDataSourceJson(),r=o&&o.dataViews;(null==r?void 0:r[e.dataViewId])&&(t[e.mainDataSourceId]=t[e.mainDataSourceId].concat(r[e.dataViewId]))}else t[e.mainDataSourceId]=t[e.mainDataSourceId].concat(n.DefaultDataView)})),t},n.state={isDataSourceInited:Y(n.props.dataSources,n.props.dataSourcesInfo),modalType:"none",SidePopper:null},n}return Sn(t,e),t.prototype.componentDidMount=function(){var e=this;this.__unmount=!1,s.moduleLoader.loadModule("jimu-ui/advanced/setting-components").then((function(t){e.__unmount||e.setState({SidePopper:t.SidePopper})}))},t.prototype.componentWillUnmount=function(){this.__unmount=!0},t.prototype.componentDidUpdate=function(e){s.lodash.isDeepEqual(this.props.dataSources,e.dataSources)&&s.lodash.isDeepEqual(this.props.dataSourcesInfo,e.dataSourcesInfo)||this.changeInitStatus(Y(this.props.dataSources,this.props.dataSourcesInfo))},t.prototype.render=function(){var e=this,t=this.state.modalType,n=this.state.SidePopper,a=this.getWhetherShowPlaceholder(),o=this.groupUseDssByMainDataSource(this.props.useDataSources);return Object(s.jsx)("div",{className:"w-100"},o&&Object.keys(o).sort((function(e,t){return null==e?void 0:e.localeCompare(t)})).map((function(t,n){return t?Object(s.jsx)(vn,{key:n,mainDataSourceId:t,onRemove:e.onMainDsRemoved,intl:e.props.intl,hideRemove:e.disableRemove(),theme:e.props.theme,disableDataSourceList:e.props.disableDataSourceList,onClick:e.toggleDsList,className:e.props.isMultiple&&"mb-3",onChange:e.onDataViewChanged,disableDataView:e.props.disableDataView,disableAddData:e.props.disableAddData,isMultiple:e.props.isMultiple,dataViews:o[t],DefaultDataView:e.DefaultDataView,hideDataView:e.props.hideDataView}):null})),n&&"ds"===t&&Object(s.jsx)(n,{isOpen:"ds"===t&&!s.urlUtils.getAppIdPageIdFromUrl().pageId,position:"right"},Object(s.jsx)("div",{className:"bg-light-300 h-100 w-100"},Object(s.jsx)(Xt,{types:this.props.types,onChange:this.onMainDsChanged,changeInitStatus:this.changeInitStatus,hideDs:this.props.hideDs,onCloseClick:this.onModalClose,isMultiple:this.props.isMultiple,fromDsIds:this.props.fromDsIds,useDataSources:this.props.useDataSources,isDataSourceInited:this.state.isDataSourceInited,widgetId:this.props.widgetId,disableSelection:this.disableSelection(),disableRemove:this.disableRemove(),fromRootDsIds:this.props.fromRootDsIds,hideHeader:this.props.hideHeader,hideTypeDropdown:this.props.hideTypeDropdown,disableAddData:this.props.disableAddData,enableToSelectOutputDsFromSelf:this.props.enableToSelectOutputDsFromSelf}))),a&&Object(s.jsx)(P.Link,{className:"ds-selector-button w-100 mt-0 d-flex justify-content-center align-items-center px-2",onClick:this.toggleDsList},Object(s.jsx)("div",{className:"text-truncate"},this.props.buttonLabel||this.props.intl.formatMessage({id:"setDataSource",defaultMessage:P.defaultMessages.setDataSource}))))},t}(s.React.PureComponent),yn=s.themeUtils.withTheme(bn),wn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Dn=function(){return(Dn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},xn=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}return n},jn=function(e){function t(t){var n=e.call(this,t)||this;return n.onToggleUseDataEnabled=function(){n.props.onToggleUseDataEnabled&&n.props.onToggleUseDataEnabled(!n.props.useDataSourcesEnabled)},n.onChange=function(e){n.props.onChange&&n.props.onChange(e)},n}return wn(t,e),t.prototype.render=function(){var e,t=this.props,n=(t.onChange,xn(t,["onChange"]));return Object(s.jsx)("div",{className:Object(s.classNames)("w-100",(e={},e[this.props.className]=!!this.props.className,e))},Object(s.jsx)("div",{className:"component-data-source-selector"},!this.props.mustUseDataSource&&Object(s.jsx)("div",{className:Object(s.classNames)("d-flex justify-content-between w-100 align-items-center",{"mb-3":this.props.useDataSourcesEnabled})},Object(s.jsx)("label",{className:"w-75 text-truncate d-inline-block font-dark-600"},this.props.intl.formatMessage({id:"connectToData",defaultMessage:P.defaultMessages.connectToData})),Object(s.jsx)(P.Switch,{checked:!!this.props.useDataSourcesEnabled,onChange:this.onToggleUseDataEnabled})),(this.props.mustUseDataSource||this.props.useDataSourcesEnabled)&&Object(s.jsx)(yn,Dn({types:this.props.types},n,{onChange:this.onChange,intl:this.props.intl,closeDataSourceListOnChange:this.props.closeDataSourceListOnChange,fromDsIds:this.props.fromDsIds,widgetId:this.props.widgetId}))))},t}(s.React.PureComponent),In=Object(s.injectIntl)(s.themeUtils.withStyles(jn,"DataSourceSelector")),On=s.ReactRedux.connect((function(e){return{dataSources:e.appStateInBuilder&&e.appStateInBuilder.appConfig&&e.appStateInBuilder.appConfig.dataSources,dataSourcesInfo:e.appStateInBuilder&&e.appStateInBuilder.dataSourcesInfo}}))(In),Mn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Cn=n(268),Nn=n(269),Tn=n(270),_n=n(271),kn=n(170),Vn=n(171),En=n(272),Ln=function(e){function t(t){var n,a,o=e.call(this,t)||this;o.onLabelChange=function(e){o.setState({newLabel:e.target.value})},o.onMoreIconClick=function(e){o.stopPropagation(e),o.props.onMoreIconClick&&o.props.onMoreIconClick(o.props.dataSourceJson)},o.onCloseIconClick=function(e){o.stopPropagation(e),o.props.onCloseIconClick&&o.props.onCloseIconClick(o.props.dataSourceJson)},o.onRename=function(){var e=o.state.newLabel.trim();o.props.onRename&&o.props.onRename(e)},o.onDataSourceItemClick=function(e){o.stopPropagation(e),o.props.onDataSourceItemClick&&o.props.onDataSourceItemClick(o.props.dataSourceJson)},o.onMappingIconClick=function(e){o.stopPropagation(e),o.props.onMappingIconClick&&o.props.onMappingIconClick(o.props.dataSourceJson)},o.onHideIconClick=function(e){o.stopPropagation(e),o.props.onToggleHidden&&o.props.onToggleHidden(o.props.dataSourceJson)},o.onChildDataIconClick=function(e){o.stopPropagation(e),o.props.onChildDataIconClick&&o.props.onChildDataIconClick(o.props.dataSourceJson)},o.onRelatedWidgetsIconClick=function(e){o.stopPropagation(e),o.props.onRelatedWidgetsIconClick&&o.props.onRelatedWidgetsIconClick(o.props.dataSourceJson)},o.stopPropagation=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},o.getWhetherIsSetDs=function(e){if(!e)return!1;var t=s.DataSourceManager.getInstance().getDataSource(e.id);return!!t&&t.isDataSourceSet},o.getChildDssLength=function(e){if(!e)return null;var t=s.DataSourceManager.getInstance().getDataSource(e.id);return t&&t.isDataSourceSet?t.getChildDataSources().length:null};var r=s.DataSourceManager.getInstance().getDataSource(null===(n=o.props.dataSourceJson)||void 0===n?void 0:n.id);return o.state={newLabel:r?r.getLabel():(null===(a=o.props.dataSourceJson)||void 0===a?void 0:a.id)||""},o}return Mn(t,e),t.prototype.componentDidUpdate=function(e,t){var n,a;if(e.isRenameInputShown!==this.props.isRenameInputShown&&this.props.isRenameInputShown&&this.renameInput&&(this.renameInput.focus(),this.renameInput.select()),e.dataSourceJson!==this.props.dataSourceJson){var o=s.DataSourceManager.getInstance().getDataSource(null===(n=this.props.dataSourceJson)||void 0===n?void 0:n.id);this.setState({newLabel:o?o.getLabel():(null===(a=this.props.dataSourceJson)||void 0===a?void 0:a.id)||""})}},t.prototype.render=function(){var e,t,n,a,o,r,i,l=this;if(!this.props.dataSourceJson)return null;var c,u=F(this.props.dataSourceJson.id,this.props.widgets,!1),d=W(this.props.dataSourceJson.id,this.props.widgets),p=$(this.props.dataSourceJson),h=this.getWhetherIsSetDs(this.props.dataSourceJson);h&&(c=this.getChildDssLength(this.props.dataSourceJson));var f=s.DataSourceManager.getInstance().getDataSource(null===(t=this.props.dataSourceJson)||void 0===t?void 0:t.id),m=K(this.props.dataSourceJson.type,this.props.intl);return Object(s.jsx)("div",{className:Object(s.classNames)((e={},e[this.props.className]=!!this.props.className,e))},Object(s.jsx)("div",{className:Object(s.classNames)("component-data-source-item",{"component-data-source-item-selected-item":this.props.isSelected,"cursor-pointer":!!this.props.onDataSourceItemClick}),onClick:this.onDataSourceItemClick},Object(s.jsx)("div",{className:"d-flex justify-content-between align-items-center ds-item-header"},Object(s.jsx)("div",{className:"d-flex align-items-center w-100",title:m},Object(s.jsx)("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail"},Object(s.jsx)(P.Icon,{icon:X(this.props.dataSourceJson),className:"text-dark",size:"12"})),Object(s.jsx)("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},Object(s.jsx)("div",{className:"text-truncate ds-type-name"},m))),Object(s.jsx)("div",{className:"d-flex"},Object(s.jsx)("div",{className:"ml-1 flex-shrink-0 d-flex align-items-center ds-badge"},Object(s.jsx)(ne.DataBadge,{itemId:null===(n=this.props.dataSourceJson)||void 0===n?void 0:n.itemId,portalUrl:null===(a=this.props.dataSourceJson)||void 0===a?void 0:a.portalUrl,url:null===(o=this.props.dataSourceJson)||void 0===o?void 0:o.url})),this.props.isErrorIconShown?Object(s.jsx)("div",{className:"ml-1 flex-shrink-0 d-flex align-items-center ds-more p-2"},Object(s.jsx)("span",{className:"d-flex justify-content-center",title:this.props.intl.formatMessage({id:"uploadImageError",defaultMessage:P.defaultMessages.uploadImageError})},Object(s.jsx)(P.Icon,{icon:En,className:"align-baseline warning-icon",size:"12"}))):null,this.props.isHideable?Object(s.jsx)(P.Button,{size:"sm",icon:!0,type:"tertiary",className:"ml-1 flex-shrink-0 ds-more p-2",onClick:this.onHideIconClick},Object(s.jsx)("span",{className:"d-flex justify-content-center",title:(null===(r=this.props.dataSourceJson)||void 0===r?void 0:r.isHidden)?this.props.intl.formatMessage({id:"clickToShow",defaultMessage:P.defaultMessages.clickToShow}):this.props.intl.formatMessage({id:"clickToHide",defaultMessage:P.defaultMessages.clickToHide})},Object(s.jsx)(P.Icon,{icon:(null===(i=this.props.dataSourceJson)||void 0===i?void 0:i.isHidden)?Vn:kn,className:"align-baseline",size:"12"}))):null,this.props.isMoreIconShown?Object(s.jsx)(P.Button,{size:"sm",icon:!0,type:"tertiary",className:"ml-1 flex-shrink-0 ds-more p-2",onClick:this.onMoreIconClick},Object(s.jsx)("span",{className:"d-flex justify-content-center",title:this.props.intl.formatMessage({id:"more",defaultMessage:P.defaultMessages.more})},Object(s.jsx)(P.Icon,{icon:Cn,className:"align-baseline",size:"12"}))):null)),Object(s.jsx)("div",{className:"ds-item-body"},this.props.isRenameInputShown?Object(s.jsx)(P.TextInput,{className:"flex-grow-1 text-truncate p-1 ds-label ds-label-input",ref:function(e){return l.renameInput=e},onBlur:this.onRename,onKeyUp:this.onRename,onChange:this.onLabelChange,value:this.state.newLabel,onClick:this.stopPropagation}):Object(s.jsx)("div",{className:"flex-grow-1 two-line-truncate ds-label text-left",title:f&&f.getLabel()||this.props.dataSourceJson.id},f&&f.getLabel()||this.props.dataSourceJson.id),Object(s.jsx)("div",{className:Object(s.classNames)("d-flex justify-content-between",{"mt-3":p||this.props.isMappingIconShown})},Object(s.jsx)("div",{className:"d-flex"},h?Object(s.jsx)(P.Button,{type:"tertiary",className:"mr-5 p-0 ds-child-dss",onClick:this.onChildDataIconClick,title:""+this.props.intl.formatMessage({id:"containLayersWithNum",defaultMessage:P.defaultMessages.containLayersWithNum},{layerNum:c})},Object(s.jsx)("span",null,Object(s.jsx)(P.Icon,{icon:Tn,size:12,className:"mr-1"}),Object(s.jsx)("span",{className:"align-middle"},c))):null,this.props.isRelatedWidgetsShown?Object(s.jsx)(P.Button,{type:"tertiary",className:"p-0 flex-grow-1 text-truncate flex-row ds-related-widgets",onClick:this.onRelatedWidgetsIconClick,title:this.props.intl.formatMessage({id:"relatedWidgetsWithNum",defaultMessage:P.defaultMessages.relatedWidgetsWithNum},{directlyNum:u.length,totalNum:d.length})},Object(s.jsx)("span",null,Object(s.jsx)(P.Icon,{icon:_n,size:12,className:"mr-1"}),Object(s.jsx)("span",{className:"align-middle"},u.length+" / "+d.length))):null),p?Object(s.jsx)(P.Button,{size:"sm",icon:!0,type:"tertiary",className:"ds-origin-label",href:p,target:"_blank",onClick:this.stopPropagation,title:this.props.intl.formatMessage({id:"source",defaultMessage:P.defaultMessages.source},{directlyNum:u.length,totalNum:d.length})},Object(s.jsx)(P.Icon,{icon:Nn,className:"m-0",size:12})):null))))},t}(s.React.PureComponent),An=s.ReactRedux.connect((function(e,t){if(t.isRelatedWidgetsShown){var n=window&&window.jimuConfig&&window.jimuConfig.isBuilder?e.appStateInBuilder&&e.appStateInBuilder.appConfig:e.appConfig;return{widgets:n&&n.widgets}}return{}}))(Object(s.injectIntl)(s.themeUtils.withStyles(Ln,"DataSourceItem"))),Rn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),zn=function(){return(zn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Un=function(e){function t(t){return e.call(this,t)||this}return Rn(t,e),t.prototype.render=function(){var e;return this.props.dataSourceJson?Object(s.jsx)("div",{className:Object(s.classNames)((e={},e[this.props.className]=!!this.props.className,e))},Object(s.jsx)("div",{className:"component-data-source-error-item"},Object(s.jsx)(An,zn({},this.props)))):null},t}(s.React.PureComponent),Pn=s.themeUtils.withStyles(Un,"DataSourceErrorItem"),Fn=n(273),Wn=n(274),Hn=n(117),Bn="CLICK_ME_TO_CLEAR_SELECTION";function Jn(e,t){var n,a;if(!e||!t)return null;var o=((n={})[s.JimuFieldType.Number]=Fn,n[s.JimuFieldType.String]=Wn,n[s.JimuFieldType.Date]=Hn,n),r=((a={})[s.JimuFieldType.Number]=t.colors.info,a[s.JimuFieldType.String]=t.colors.success,a[s.JimuFieldType.Date]=t.colors.warning,a);return{icon:o[e],color:r[e]}}var qn,Gn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Qn=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isOpen:!1},n}return Gn(t,e),t.prototype.render=function(){var e=this,t=this.props.fields;if(!t||!this.props.ds)return null;var n=t[Bn]?[Bn]:[];return s.React.createElement("div",{className:"field-list px-3"},t&&n.concat(Object.keys(t).filter((function(e){return e!==Bn}))).map((function(n){var a=Jn(t[n].type,e.props.theme);return s.React.createElement("div",{key:n,onClick:function(){e.props.onFieldClick(t[n])},className:Object(s.classNames)("field-item mt-2 p-1 d-flex w-100",{"field-item-selected":e.props.selectedFields&&(e.props.isMultiple?e.props.selectedFields.some((function(e){return e===n})):n===e.props.selectedFields[0])})},a&&s.React.createElement(P.Icon,{icon:a.icon,color:a.color,className:"mr-2 flex-shrink-0",size:16}),s.React.createElement("div",{className:"flex-grow-1 text-truncate",title:t[n].alias||t[n].name},t[n].alias||t[n].name))})))},t}(s.React.PureComponent),Xn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Kn=function(){return(Kn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Yn=function(e){function t(t){var n=e.call(this,t)||this;return n.fieldNameStyle={minHeight:"16px"},n.toggle=function(){n.setState({isOpen:!n.state.isOpen})},n.getSelectedFieldJimuName=function(){var e=n.props.fields;if(e&&n.props.selectedFields&&n.props.selectedFields[0]){var t=e[n.props.selectedFields[0]];return null==t?void 0:t.jimuName}},n.onFieldChange=function(e){n.props.onFieldClick(n.props.fields[e.currentTarget.value])},n.state={isOpen:!1},n}return Xn(t,e),t.prototype.render=function(){var e=this,t=this.props.fields;if(!t||!this.props.ds)return null;var n=this.props.dropdownProps||{},a=t[Bn]?[Bn]:[];return s.React.createElement("div",null,s.React.createElement(P.Select,Kn({},n,{value:this.getSelectedFieldJimuName(),fluid:!0,isOpen:this.state.isOpen,toggle:this.toggle,className:"field-dropdown",placeholder:this.props.placeHolder,onChange:this.onFieldChange}),t&&a.concat(Object.keys(t).filter((function(e){return e!==Bn}))).map((function(n,a){var o=Jn(t[n].type,e.props.theme);return s.React.createElement(P.Option,{key:a,value:n},o&&s.React.createElement(P.Icon,{icon:o.icon,color:o.color,className:"d-inline-block mr-2",size:16}),s.React.createElement("span",{style:e.fieldNameStyle},t[n].alias||t[n].name))}))))},t}(s.React.PureComponent),Zn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),$n=function(){return($n=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},ea=function(e){function t(t){var n=e.call(this,t)||this;return n.onFieldClick=function(e,t){var a=n.props.fields[t];n.props.onFieldClick(a)},n.getMultiSelectItems=function(){if(n.props.fields){var e=[];return(n.props.fields[Bn]?[Bn]:[]).concat(Object.keys(n.props.fields).filter((function(e){return e!==Bn}))).forEach((function(t){e.push({value:t,label:n.props.fields[t].alias||n.props.fields[t].name,render:function(e){var a=Jn(n.props.fields[t].type,n.props.theme);return s.React.createElement("div",{className:"d-flex w-100 align-items-center"},s.React.createElement(P.Checkbox,{checked:n.props.selectedFields.includes(e.value)}),a&&s.React.createElement(P.Icon,{icon:a.icon,color:a.color,className:"d-inline-block ml-2",size:16}),s.React.createElement("span",{className:"ml-2"},n.props.fields[t].alias||n.props.fields[t].name))}})})),e}return[]},n}return Zn(t,e),t.prototype.render=function(){if(!this.props.fields||!this.props.ds)return null;var e=this.props.dropdownProps||{};return s.React.createElement("div",null,s.React.createElement(P.MultiSelect,$n({},e,{fluid:!0,items:Object(s.Immutable)(this.getMultiSelectItems()),onClickItem:this.onFieldClick,values:this.props.selectedFields,placeHolder:this.props.placeHolder})))},t}(s.React.PureComponent),ta=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}();!function(e){e.First="POPULATED_VIEW_SELECTION_DEFAULT",e.Second="VIEW_DEFAULT_SELECTION_POPULATED"}(qn||(qn={}));var na=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getWhetherUseDsIsShallowEqual=function(e,t){var n=!1;return e&&t&&e.length===t.length&&(n=!e.some((function(e,n){return e.dataSourceId!==t[n].dataSourceId}))),n},t.isPopulatedView=function(e){return(null==e?void 0:e.dataViewId)===s.CONSTANTS.REPEAT_CONTEXT_DATA_VIEW_ID},t.isSelectionView=function(e){return(null==e?void 0:e.dataViewId)===s.CONSTANTS.SELECTION_DATA_VIEW_ID},t.isDefaultView=function(e){return"USE_MAIN_DATA_SOURCE"===(null==e?void 0:e.dataViewId)||(null==e?void 0:e.dataViewId)===s.CONSTANTS.OUTPUT_DATA_VIEW_ID},t.isCommonView=function(e){return(null==e?void 0:e.dataViewId)&&!t.isPopulatedView(e)&&!t.isSelectionView(e)&&!t.isDefaultView(e)},t.getOneDefaultUseDs=function(e,n,a){var o=t.groupUseDataSourcesByMainDsAndAddAutoViews(e,n,a),r=[];r=t.props.defaultDataViewPriority===qn.Second?[t.isCommonView,t.isDefaultView,t.isSelectionView,t.isPopulatedView]:[t.isPopulatedView,t.isCommonView,t.isSelectionView,t.isDefaultView];var s=Object.values(o).find((function(e){return e.some((function(e){return r[0](e)}))}))||Object.values(o).find((function(e){return e.some((function(e){return r[1](e)}))}))||Object.values(o).find((function(e){return e.some((function(e){return r[2](e)}))}))||Object.values(o).find((function(e){return e.some((function(e){return r[3](e)}))}))||Object.values(o)[0];return s?s.find((function(e){return r[0](e)}))||s.find((function(e){return r[1](e)}))||s.find((function(e){return r[2](e)}))||s.find((function(e){return r[3](e)}))||s[0]:null},t.getSelectedUseDsFromProps=function(e,n,a,o,r){var i,l,c=t.groupUseDataSourcesByMainDsAndAddAutoViews(e,a,r),u=t.getOneDefaultUseDs(e,a,r);return n?o?null===(i=c[n.mainDataSourceId])||void 0===i?void 0:i.find((function(e){return e.dataViewId===s.CONSTANTS.REPEAT_CONTEXT_DATA_VIEW_ID})):n.dataViewId?n:null===(l=c[n.mainDataSourceId])||void 0===l?void 0:l.find((function(e){return"USE_MAIN_DATA_SOURCE"===e.dataViewId})):u},t.getWhetherUseRepeatedDataSourceContext=function(e,n,a,o){var r,i,l,c,u=(null===(r=null===window||void 0===window?void 0:window.jimuConfig)||void 0===r?void 0:r.isBuilder)?null===(l=null===(i=Object(s.getAppStore)().getState())||void 0===i?void 0:i.appStateInBuilder)||void 0===l?void 0:l.appConfig:null===(c=Object(s.getAppStore)().getState())||void 0===c?void 0:c.appConfig;if(!(u&&e&&n&&0!==n.length&&a&&o))return!1;for(var d=wt.searchUtils.getParentWidgetIdOfContent(u,e,s.LayoutItemType.Widget,o),p=u.widgets[d],h=p&&s.CONSTANTS.PROVIDE_REPEATED_DATA_SOURCE_CONTEXT_WIDGET_URI.some((function(e){return e===p.uri})),f=!1,m=function(e){var o=t.getRealUseDataSources(n[e],a);if(f=(null==p?void 0:p.useDataSources)&&p.useDataSources.some((function(e){return(null==o?void 0:o.dataSourceId)===e.dataSourceId})))return"break"},g=0;g<n.length;g++){if("break"===m(g))break}return h&&f},t.groupUseDataSourcesByMainDsAndAddAutoViews=function(e,n,a){if(!a||!n||0===n.length)return{};var o={};return n.forEach((function(e){if(o[e.mainDataSourceId]||(o[e.mainDataSourceId]=[]),!o[e.mainDataSourceId].some((function(t){return t.dataSourceId===e.dataSourceId})))if(!e.dataViewId&&e.dataSourceId===e.mainDataSourceId){var t=e.set("dataSourceId",s.DataSourceManager.getInstance().getDataViewDataSourceId(e.mainDataSourceId,"USE_MAIN_DATA_SOURCE")).set("dataViewId","USE_MAIN_DATA_SOURCE");o[e.mainDataSourceId]=o[e.mainDataSourceId].concat(t)}else o[e.mainDataSourceId]=o[e.mainDataSourceId].concat(e)})),Object.keys(o).forEach((function(r){o[r]=o[r].concat(t.getAutoAddedDataViews(e,o[r],n,a))})),o},t.getAutoAddedDataViews=function(e,n,a,o){if(!n||0===n.length||!o)return[];var r=s.DataSourceManager.getInstance().getDataSource(n[0].mainDataSourceId);if(!(r&&!r.isDataSourceSet))return[];var i=[];if(t.props.useSelectionDataView&&!n.some((function(e){return e.dataViewId===s.CONSTANTS.SELECTION_DATA_VIEW_ID}))){var l=n[0].set("dataSourceId",s.DataSourceManager.getInstance().getDataViewDataSourceId(n[0].mainDataSourceId,s.CONSTANTS.SELECTION_DATA_VIEW_ID)).set("dataViewId",s.CONSTANTS.SELECTION_DATA_VIEW_ID);i=i.concat(l)}if(t.props.usePopulatedDataView&&t.getWhetherUseRepeatedDataSourceContext(e,n,a,o)){var c=n[0].set("dataSourceId",s.DataSourceManager.getInstance().getDataViewDataSourceId(n[0].mainDataSourceId,s.CONSTANTS.REPEAT_CONTEXT_DATA_VIEW_ID)).set("dataViewId",s.CONSTANTS.REPEAT_CONTEXT_DATA_VIEW_ID);i=i.concat(c)}return i},t.getDsLabel=function(e,n){if(n&&n===s.CONSTANTS.SELECTION_DATA_VIEW_ID)return t.props.intl.formatMessage({id:"selectionDataView",defaultMessage:P.defaultMessages.selectionDataView});if(n&&n===s.CONSTANTS.REPEAT_CONTEXT_DATA_VIEW_ID)return t.props.intl.formatMessage({id:"populatedDataView",defaultMessage:P.defaultMessages.populatedDataView});if(n&&("USE_MAIN_DATA_SOURCE"===n||n===s.CONSTANTS.OUTPUT_DATA_VIEW_ID))return t.props.intl.formatMessage({id:"default",defaultMessage:P.defaultMessages.default});var a=s.DataSourceManager.getInstance().getDataSource(e);return a?a.getLabel()||a.id:e},t.getRealUseDataSources=function(e,t){if(!e)return null;if("USE_MAIN_DATA_SOURCE"===e.dataViewId)return e.set("dataSourceId",e.mainDataSourceId).without("dataViewId");if(e.dataViewId===s.CONSTANTS.REPEAT_CONTEXT_DATA_VIEW_ID){var n=t.find((function(t){return t.mainDataSourceId===e.mainDataSourceId}));return n&&Object(s.Immutable)(n)}return e},t.onMainDataChange=function(e){var n=e.target.value;if(n!==t.props.selectedUseDataSource.mainDataSourceId){var a=Object(s.Immutable)(t.props.useDataSources.find((function(e){return e.mainDataSourceId===n}))||{dataSourceId:n,mainDataSourceId:n});t.props.onChange(a,t.props.isSelectedFromRepeatedDataSourceContext)}},t.onDataViewChange=function(e){if(t.props.selectedUseDataSource){var n=e.target.value,a=t.props.selectedUseDataSource.set("dataSourceId",s.DataSourceManager.getInstance().getDataViewDataSourceId(t.props.selectedUseDataSource.mainDataSourceId,n)).set("dataViewId",n);t.props.onChange(t.getRealUseDataSources(a,t.props.useDataSources),(null==a?void 0:a.dataViewId)===s.CONSTANTS.REPEAT_CONTEXT_DATA_VIEW_ID)}},t}return ta(t,e),t.prototype.componentDidMount=function(){if(!this.props.selectedUseDataSource){var e=this.getOneDefaultUseDs(this.props.widgetId,this.props.useDataSources,this.props.browserSizeMode);this.props.onChange(this.getRealUseDataSources(e,this.props.useDataSources),(null==e?void 0:e.dataViewId)===s.CONSTANTS.REPEAT_CONTEXT_DATA_VIEW_ID)}},t.prototype.componentDidUpdate=function(e){if(e.widgetId!==this.props.widgetId||!this.getWhetherUseDsIsShallowEqual(e.useDataSources,this.props.useDataSources)||e.browserSizeMode!==this.props.browserSizeMode||!this.props.selectedUseDataSource){var t=this.getOneDefaultUseDs(this.props.widgetId,this.props.useDataSources,this.props.browserSizeMode);this.props.onChange(this.getRealUseDataSources(t,this.props.useDataSources),(null==t?void 0:t.dataViewId)===s.CONSTANTS.REPEAT_CONTEXT_DATA_VIEW_ID)}},t.prototype.render=function(){var e,t,n=this;if(!this.props.useDataSources)return null;var a=this.groupUseDataSourcesByMainDsAndAddAutoViews(this.props.widgetId,this.props.useDataSources,this.props.browserSizeMode),o=this.getSelectedUseDsFromProps(this.props.widgetId,this.props.selectedUseDataSource,this.props.useDataSources,this.props.isSelectedFromRepeatedDataSourceContext,this.props.browserSizeMode);return Object(s.jsx)("div",{className:Object(s.classNames)("w-100",(e={},e[this.props.className]=!!this.props.className,e))},Object(s.jsx)("div",{className:"component-main-data-and-view"},!this.props.hideMainDataSourceSelect&&Object(s.jsx)("div",{className:"w-100 text-truncate mb-12 option-label mb-2"},this.props.intl.formatMessage({id:"data",defaultMessage:P.defaultMessages.data})),!this.props.hideMainDataSourceSelect&&Object(s.jsx)("div",{className:"flex-grow-1"},Object(s.jsx)(P.Select,{value:null==o?void 0:o.mainDataSourceId,className:"select-max-width text-truncate",onChange:this.onMainDataChange,size:"sm"},Object.keys(a).sort((function(e,t){return null==e?void 0:e.localeCompare(t)})).map((function(e,t){return Object(s.jsx)("option",{value:e,key:t,className:"select-max-width text-truncate"},n.getDsLabel(e))})))),Object(s.jsx)("div",{className:Object(s.classNames)("flex-grow-1",{"mt-2":!this.props.hideMainDataSourceSelect})},Object(s.jsx)(P.Select,{value:null==o?void 0:o.dataViewId,className:"select-max-width text-truncate",onChange:this.onDataViewChange,size:"sm"},null===(t=a[null==o?void 0:o.mainDataSourceId])||void 0===t?void 0:t.sort((function(e,t){var n;return null===(n=null==e?void 0:e.dataSourceId)||void 0===n?void 0:n.localeCompare(null==t?void 0:t.dataSourceId)})).map((function(e,t){return Object(s.jsx)("option",{value:e.dataViewId,key:t,className:"select-max-width text-truncate"},n.getDsLabel(e.dataSourceId,e.dataViewId))}))))))},t}(s.React.PureComponent),aa=s.ReactRedux.connect((function(e,t){var n,a;return{browserSizeMode:(null===(n=null==e?void 0:e.appContext)||void 0===n?void 0:n.isBuilder)?null===(a=null==e?void 0:e.appStateInBuilder)||void 0===a?void 0:a.browserSizeMode:null==e?void 0:e.browserSizeMode}}))(na),oa=Object(s.injectIntl)(s.themeUtils.withStyles(aa,"MainDataAndViewSelector")),ra=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),sa=function(){return(sa=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},ia=n(101),la=function(e){function t(t){var n=e.call(this,t)||this;return n.getWhetherArrayIsShallowEqual=function(e,t){var n=!1;return e&&t&&e.length===t.length&&(n=!e.some((function(e,n){return e!==t[n]}))),n},n.getDefaultSelectedDs=function(e,t){return n.hasSelectedFields()||n.props.isDataSourceDropDownHidden?n.getDsFromSelectedFieldsAndUseDss(n.props.dataSources,n.props.selectedFields):null},n.hasSelectedFields=function(){return!!n.props.selectedFields&&(Array.isArray(n.props.selectedFields)?n.props.selectedFields.length>0:"object"==typeof n.props.selectedFields&&Object.values(n.props.selectedFields).every((function(e){return e&&e.length>0})))},n.getDsFromSelectedFieldsAndUseDss=function(e,t){var a;if(t&&e)if(n.getAreFromMultipleDss(e,t)){var o=Object.keys(n.props.selectedFields)[0];if(o.split("-").reverse()[0]===s.CONSTANTS.SELECTION_DATA_VIEW_ID){var r=s.DataSourceManager.getInstance().getDataSource(o),i=r&&r.getMainDataSource(),l=i&&i.id;a=n.props.dataSources.some((function(e){return e&&e.getMainDataSource().id===l}))?r:null}else a=n.props.dataSources.find((function(e){return e&&e.id===o}))}else a=e[0];else e&&(a=e[0]);return a},n.getAreFromMultipleDss=function(e,t){return t?!Array.isArray(t):(null==e?void 0:e.length)>1},n.getDsLabel=function(e){return e&&e.getDataSourceJson()&&(e.getLabel()||e.id)||""},n.getSelectedFields=function(e,t,a,o){if(!e||!e.id||!a)return Object(s.Immutable)([]);var r=n.getAreFromMultipleDss(t,a)?Object(s.Immutable)(a[e.id]):a;return r?o?r:r.slice(0,1):Object(s.Immutable)([])},n.getSelectedUseDataSource=function(){return n.state.selectedDs?n.getUseDataSources([n.state.selectedDs])[0]:null},n.getWhetherJimuNameIsInHiddenFields=function(e){var t,a=!1;if(n.props.hiddenFields){var o=n.getAreFromMultipleDss(n.props.dataSources,n.props.selectedFields);Object(s.Immutable)([]);a=(o?n.props.hiddenFields[null===(t=n.state.selectedDs)||void 0===t?void 0:t.id]:n.props.hiddenFields).some((function(t){return t===e}))}return a},n.getValidFields=function(e,t){var a,o=n.getAllFields(e);if(!o)return null;if(n.props.types||n.props.hiddenFields||n.state.searchValue){var r,i,l=Object(s.Immutable)({});Object.keys(o).forEach((function(e){r=o[e].type,i=o[e].alias||o[e].name;var a=!n.props.types||r&&n.props.types&&n.props.types.some((function(e){return e===r})),s=n.getWhetherJimuNameIsInHiddenFields(e),c=!n.state.searchValue||n.state.searchValue&&i&&i.toLowerCase().includes(n.state.searchValue.toLowerCase());(t?a&&!s:a&&!s&&c)&&(l=l.setIn([e],o[e]))})),a=l}else a=o;return a&&n.props.noSelectionItem&&(a=a.set(Bn,n.getNoSelectionItem())),a},n.getNoSelectionItem=function(){return Object(s.Immutable)(sa(sa({},n.props.noSelectionItem),{jimuName:Bn}))},n.getUseDataSources=function(e){if(!e)return null;var t=Object(s.Immutable)([]);return e.forEach((function(e){var n;e&&(t=t.concat({dataSourceId:e.id,mainDataSourceId:e.getMainDataSource().id,dataViewId:e.dataViewId,rootDataSourceId:null===(n=e.getRootDataSource())||void 0===n?void 0:n.id}))})),t},n.onSelectedUseDsChange=function(e,t){var a=s.DataSourceManager.getInstance().getDataSource(e.dataSourceId);if(n.setState({selectedDs:a}),n.hasSelectedFields()){var o=n.getSelectedFields(n.state.selectedDs,n.props.dataSources,n.props.selectedFields,n.props.isMultiple).map((function(e){var t;return a&&(null===(t=n.getAllFields(a))||void 0===t?void 0:t[e])})).filter((function(e){return!!e}));n.props.onChange&&n.props.onChange(o.asMutable(),a,t)}n.setState({selectedDs:a,isFromRepeatedDs:t})},n.onSearchChange=function(e){n.setState({searchValue:e.target.value})},n.onFieldClick=function(e){n.onSelectedFieldsChange(e,n.state.selectedDs,n.props.dataSources,n.props.selectedFields,n.state.isFromRepeatedDs,n.props.isMultiple)},n.onSelectedFieldsChange=function(e,t,a,o,r,s){if(e.jimuName!==Bn){var i,l=n.getSelectedFields(t,a,o,s),c=n.getValidFields(t,s);l&&l.some((function(t){return t===e.jimuName}))?n.props.isMultiple?(i=l.filter((function(t){return t!==e.jimuName})).map((function(e){return null==c?void 0:c[e]})),n.props.onChange&&n.props.onChange(i,t,r)):n.props.onChange&&n.props.onChange([],t,r):s?(i=l?l.map((function(e){return null==c?void 0:c[e]})).concat(e):[e],n.props.onChange&&n.props.onChange(i,t,r)):n.props.onChange&&n.props.onChange([e],t,r)}else n.props.onChange&&n.props.onChange([],t,r)},n.state={selectedDs:n.getDefaultSelectedDs(n.props.dataSources,n.props.selectedFields),searchValue:"",isFromRepeatedDs:!!n.props.isSelectedFromRepeatedDataSourceContext},n}return ra(t,e),t.prototype.componentDidMount=function(){this.props.getDefaultField&&this.props.getDefaultField(this.getDefaultFieldFromDs(this.props.dataSources,this.props.selectedFields))},t.prototype.componentDidUpdate=function(e,t){this.getWhetherArrayIsShallowEqual(this.props.dataSources,e.dataSources)&&this.props.selectedFields===e.selectedFields||this.setState({selectedDs:this.getDefaultSelectedDs(this.props.dataSources,this.props.selectedFields)}),this.getWhetherArrayIsShallowEqual(this.props.dataSources,e.dataSources)||this.props.getDefaultField&&this.props.getDefaultField(this.getDefaultFieldFromDs(this.props.dataSources,this.props.selectedFields)),e.isSelectedFromRepeatedDataSourceContext!==this.props.isSelectedFromRepeatedDataSourceContext&&this.setState({isFromRepeatedDs:!!this.props.isSelectedFromRepeatedDataSourceContext})},t.prototype.getDefaultFieldFromDs=function(e,t){var n,a=this;if(this.getAreFromMultipleDss(e,t))n={},e.forEach((function(e){n[e.id]=a.getOneDefaultFieldFromDs(e)}));else{var o=e[0];n=this.getOneDefaultFieldFromDs(o)}return n},t.prototype.getOneDefaultFieldFromDs=function(e){if(e&&e.getSchema){var t=this.getValidFields(e),n=t&&Object.keys(t)[0];return t&&n?t[n]:null}return null},t.prototype.getAllFields=function(e){var t,n=null==e?void 0:e.getSelectedFields(),a=null===(t=null==e?void 0:e.getSchema())||void 0===t?void 0:t.fields,o=a?Object.keys(a).filter((function(e){return!n.includes(e)})):[];return null==a?void 0:a.without.apply(a,o)},t.prototype.render=function(){var e;if(!this.props.dataSources||0===this.props.dataSources.filter((function(e){return!!e})).length)return console.warn("No data sources"),null;var t=this.getSelectedFields(this.state.selectedDs,this.props.dataSources,this.props.selectedFields,this.props.isMultiple),n=this.props.noSelectionItem&&0===t.length?Object(s.Immutable)([this.getNoSelectionItem().jimuName]):t;return Object(s.jsx)("div",{style:this.props.style,className:Object(s.classNames)("w-100 h-100",(e={},e[this.props.className]=!!this.props.className,e))},Object(s.jsx)("div",{className:"component-field-selector w-100 h-100"},this.props.isDataSourceDropDownHidden?null:Object(s.jsx)("div",{className:"ds-name p-3 d-flex justify-content-between align-items-center"},Object(s.jsx)(oa,{widgetId:this.props.widgetId,useDataSources:this.getUseDataSources(this.props.dataSources),onChange:this.onSelectedUseDsChange,useSelectionDataView:this.props.useSelectionDataView,usePopulatedDataView:this.props.usePopulatedDataView,selectedUseDataSource:this.getSelectedUseDataSource(),isSelectedFromRepeatedDataSourceContext:this.state.isFromRepeatedDs})),this.props.isSearchInputHidden?null:Object(s.jsx)("div",{className:"d-inline-block w-100 px-3 mb-2 item-selector-search"},Object(s.jsx)(P.Icon,{icon:ia,className:"search-icon",color:this.props.theme.colors.dark}),Object(s.jsx)(P.TextInput,{placeholder:this.props.intl.formatMessage({id:"search",defaultMessage:s.defaultMessages.search}),onChange:this.onSearchChange,className:"d-inline-block search-input",value:this.state.searchValue})),this.props.useDropdown?Object(s.jsx)("div",null,this.props.isMultiple?Object(s.jsx)(ea,{placeHolder:this.props.placeHolder,ds:this.state.selectedDs,fields:this.getValidFields(this.state.selectedDs),selectedFields:n,onFieldClick:this.onFieldClick,theme:this.props.theme,dropdownProps:this.props.dropdownProps}):Object(s.jsx)(Yn,{placeHolder:this.props.placeHolder,ds:this.state.selectedDs,fields:this.getValidFields(this.state.selectedDs),selectedFields:n,onFieldClick:this.onFieldClick,theme:this.props.theme,dropdownProps:this.props.dropdownProps})):Object(s.jsx)(Qn,{ds:this.state.selectedDs,fields:this.getValidFields(this.state.selectedDs),selectedFields:n,isMultiple:this.props.isMultiple,onFieldClick:this.onFieldClick,theme:this.props.theme})))},t}(s.React.PureComponent),ca=Object(s.injectIntl)(s.themeUtils.withStyles(s.themeUtils.withTheme(la),"FieldSelector")),ua=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),da=function(){return(da=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},pa=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}return n},ha=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ua(t,e),t.prototype.render=function(){var e=this.props,t=e.useDataSources,n=e.dataSources,a=pa(e,["useDataSources","dataSources"]);return n?s.React.createElement(ca,da({},this.props)):1===(null==t?void 0:t.length)?s.React.createElement(s.DataSourceComponent,{useDataSource:t[0]},(function(e,t){return s.React.createElement(ca,da({},a,{dataSources:[e]}))})):s.React.createElement(s.MultipleDataSourceComponent,{useDataSources:t},(function(e,t){return s.React.createElement(ca,da({},a,{dataSources:e&&Object.values(e)}))}))},t}(s.React.PureComponent);s.ThemeManager.getInstance().registerJimuThemeStyleModule("jimu-ui/advanced/data-source-selector/",{componentStyles:a})}}))}}}));