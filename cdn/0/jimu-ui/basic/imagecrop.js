System.register(["jimu-core","jimu-ui","jimu-for-builder"],(function(t){var e,o,n;return{setters:[function(t){e=t},function(t){o=t},function(t){n=t}],execute:function(){t(function(t){var e={};function o(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=977)}({0:function(t,o){t.exports=e},1:function(t,e){t.exports=o},104:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19.637 15.866L30.951 27.18a2.667 2.667 0 01-3.771 3.771L15.866 19.637 4.552 30.951A2.667 2.667 0 01.781 27.18l11.314-11.314L.781 4.552A2.667 2.667 0 014.552.781l11.314 11.314L27.18.781a2.667 2.667 0 013.771 3.771L19.637 15.866z"></path></svg>'},19:function(t,e){t.exports=n},48:function(t,e){t.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M4.586 8.657l6.01-6.01a.5.5 0 01.707.707l-6.01 6.01a1 1 0 01-1.414 0L.697 6.182a.5.5 0 01.707-.707l3.182 3.182z" fill="#000"></path><path d="M0 0h12v12H0z"></path></g></svg>'},977:function(t,e,o){"use strict";o.r(e),o.d(e,"CropType",(function(){return i.CropType})),o.d(e,"ImageCrop",(function(){return P}));var n,r=o(0),i=o(1),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=o(48),p=o(104),c=function(t){function e(e){return t.call(this,e)||this}return a(e,t),e.prototype.render=function(){var t=this,e=this.props,o=e.showGrid,n=e.style,a=e.className;a||(a="");var c=n.width,u={display:"flex",alignItems:"center",justifyContent:"flex-end",minWidth:"75px",paddingBottom:"5px",left:"-1px",paddingTop:"5px",position:"absolute",top:"-40px",height:"40px",width:Math.min(this.props.screenWidth,c)+"px",boxShadow:"0 2px 8px 1px rgba(0,0,0,0.20)",backgroundColor:"#fff",borderRadius:"2px",cursor:"default"};this.props.widgetArea.top-40<0&&(u.top=this.props.widgetArea.height+"px");var h=r.React.createElement("div",{onMouseDown:function(t){t.stopPropagation()},style:u},r.React.createElement("div",{className:"tool-item mr-1",style:{float:"right",padding:"0.42rem 0.5rem"},onClick:function(){t.props.onConfirmCrop&&t.props.onConfirmCrop(t.props.svgViewBox,t.props.svgPath,t.props.cropShape)}},r.React.createElement(i.Icon,{icon:s,width:16,height:16,className:"mr-0"})),r.React.createElement("div",{className:"tool-item mr-1",style:{float:"right",padding:"0.42rem 0.5rem",marginLeft:"0.1rem"},onClick:function(){t.props.onCancelCrop&&t.props.onCancelCrop()}},r.React.createElement(i.Icon,{icon:p,width:13,height:13,className:"mr-0"})));return r.React.createElement("div",{style:n,className:Object(r.classNames)("cropperArea "+a,{gridLines:o})},r.React.createElement("svg",{width:"100%",height:"100%",viewBox:this.props.svgViewBox?this.props.svgViewBox:"0 0 28 28",preserveAspectRatio:"none"},r.React.createElement("defs",null,r.React.createElement("mask",{id:"mask-setting-"+this.props.widgetId,maskContentUnits:"userSpaceOnUse"},r.React.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",stroke:"none",fill:"rgb(255, 255, 255, 1)"}),r.React.createElement("svg",{width:"100%",height:"100%",viewBox:this.props.svgViewBox?this.props.svgViewBox:"0 0 28 28",preserveAspectRatio:"none"},r.React.createElement("g",null,r.React.createElement("path",{strokeWidth:"2",strokeDasharray:"10",strokeDashoffset:"0",fill:"#000",d:this.props.svgPath?this.props.svgPath:"m0,0l0,28l28,0l0,-28l-28,0z"}))))),r.React.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",className:"mask-image",style:{stroke:"none",fill:"rgb(0, 0, 0, 0.7)"}}),r.React.createElement("g",null,r.React.createElement("path",{stroke:"#fff",strokeWidth:".1",fill:"none",strokeDashoffset:"0",d:this.props.svgPath?this.props.svgPath:"m0,0l0,28l28,0l0,-28l-28,0z"}))),h)},e}(r.React.Component),u=o(19),h=function(t,e,o,n){return new(o||(o=Promise))((function(r,i){function a(t){try{p(n.next(t))}catch(t){i(t)}}function s(t){try{p(n.throw(t))}catch(t){i(t)}}function p(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,s)}p((n=n.apply(t,e||[])).next())}))},l=function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function m(t,e,o,n){return{x:d(t.x,e.width,o.width,n),y:d(t.y,e.height,o.height,n)}}function d(t,e,o,n){var r=e*n/2-o/2;return Math.min(r,Math.max(t,-r))}function g(t,e){return Math.sqrt(Math.pow(t.y-e.y,2)+Math.pow(t.x-e.x,2))}function f(t,e){return Math.min(t,Math.max(0,e))}function v(t,e){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}var w,b=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),x=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},y=function(t){function e(o){var n=t.call(this,o)||this;return n.image=null,n.container=null,n.containerRect={},n.imageSize={width:0,height:0,naturalWidth:0,naturalHeight:0},n.dragStartPosition={x:0,y:0},n.dragStartCrop={x:0,y:0},n.lastPinchDistance=0,n.rafDragTimeout=null,n.rafZoomTimeout=null,n.screenWidth=document?document.documentElement.clientWidth:null,n.screenHeight=document?document.documentElement.clientHeight:null,n.getStyle=function(){var t=window.location.href.replace(window.location.hash,"");return Object(r.css)(w||(w=x(['\n      .cropperArea {\n        position: relative;\n        border: 1px solid rgba(255, 255, 255, 0.5);\n        box-sizing: border-box;\n        box-shadow: 0 0 0 9999em;\n        color: rgba(0,0,0,0.5);\n\n        .tool-item {\n          background-color: #EEF0F3;\n          cursor: pointer;\n\n          &:hover {\n            background-color: #c8cbcd;\n            cursor: pointer;\n          }\n        }\n      }\n\n      .gridLines {\n        &::before {\n          content: " ";\n          box-sizing: border-box;\n          position: absolute;\n          border: 1px solid rgba(255, 255, 255, 0.5);\n          top: 0;\n          bottom: 0;\n          left: 33.33%;\n          right: 33.33%;\n          borderTop: 0;\n          borderBottom: 0;\n        }\n\n        &::after {\n          content: " ";\n          box-sizing: border-box;\n          position: absolute;\n          border: 1px solid rgba(255, 255, 255, 0.5);\n          top: 33.33%;\n          bottom: 33.33%;\n          left: 0;\n          right: 0;\n          borderLeft: 0;\n          borderRight: 0;\n        },\n      }\n\n      .roundShape {\n        border-radius: 50%\n      }\n\n      .mask-border {\n        path {\n          transition:all 1s linear;\n          animation-name:ring;\n          animation-duration:9.2s;\n          animation-timing-function: linear;\n          animation-iteration-count:infinite;\n        }\n        \n        @keyframes ring {\n            from {\n                stroke-dashoffset:0;\n            }\n            to {\n                stroke-dashoffset:6000;\n            }\n        }\n      }\n\n      .mask-image {\n        -webkit-mask-image: url(',"#mask-setting-",");\n        mask: url(","#mask-setting-",");\n        mask-image: url(","#mask-setting-",");\n      }\n    "],['\n      .cropperArea {\n        position: relative;\n        border: 1px solid rgba(255, 255, 255, 0.5);\n        box-sizing: border-box;\n        box-shadow: 0 0 0 9999em;\n        color: rgba(0,0,0,0.5);\n\n        .tool-item {\n          background-color: #EEF0F3;\n          cursor: pointer;\n\n          &:hover {\n            background-color: #c8cbcd;\n            cursor: pointer;\n          }\n        }\n      }\n\n      .gridLines {\n        &::before {\n          content: " ";\n          box-sizing: border-box;\n          position: absolute;\n          border: 1px solid rgba(255, 255, 255, 0.5);\n          top: 0;\n          bottom: 0;\n          left: 33.33%;\n          right: 33.33%;\n          borderTop: 0;\n          borderBottom: 0;\n        }\n\n        &::after {\n          content: " ";\n          box-sizing: border-box;\n          position: absolute;\n          border: 1px solid rgba(255, 255, 255, 0.5);\n          top: 33.33%;\n          bottom: 33.33%;\n          left: 0;\n          right: 0;\n          borderLeft: 0;\n          borderRight: 0;\n        },\n      }\n\n      .roundShape {\n        border-radius: 50%\n      }\n\n      .mask-border {\n        path {\n          transition:all 1s linear;\n          animation-name:ring;\n          animation-duration:9.2s;\n          animation-timing-function: linear;\n          animation-iteration-count:infinite;\n        }\n        \n        @keyframes ring {\n            from {\n                stroke-dashoffset:0;\n            }\n            to {\n                stroke-dashoffset:6000;\n            }\n        }\n      }\n\n      .mask-image {\n        -webkit-mask-image: url(',"#mask-setting-",");\n        mask: url(","#mask-setting-",");\n        mask-image: url(","#mask-setting-",");\n      }\n    "])),t,n.props.widgetId,t,n.props.widgetId,t,n.props.widgetId)},n.preventZoomSafari=function(t){return t.preventDefault()},n.cleanEvents=function(){document.removeEventListener("mousemove",n.onMouseMove),document.removeEventListener("mouseup",n.onDragStopped),document.removeEventListener("touchmove",n.onTouchMove),document.removeEventListener("touchend",n.onDragStopped)},n.onImgLoad=function(){n.computeSizes(),n.emitCropData()},n.computeSizes=function(){if(n.image){n.imageSize={width:n.image.width,height:n.image.height,naturalWidth:n.image.naturalWidth,naturalHeight:n.image.naturalHeight};var t=n.props.widgetArea.width,e=n.props.widgetArea.height,o=n.state.minZoom,r=n.state.maxZoom;r=n.image.width/n.image.height>=t/e?(o=e/n.image.height)+5:(o=t/n.image.width)+5,o>n.props.zoom&&n.props.onZoomChange&&n.props.onZoomChange(o);var i={width:t,height:e};n.setState({cropSize:i,minZoom:o,maxZoom:r},n.recomputeCropPosition)}n.container&&(n.containerRect=n.container.getBoundingClientRect())},n.onMouseDown=function(t){t.preventDefault(),document.addEventListener("mousemove",n.onMouseMove),document.addEventListener("mouseup",n.onDragStopped),n.onDragStart(e.getMousePoint(t))},n.onMouseMove=function(t){return n.onDrag(e.getMousePoint(t))},n.onTouchStart=function(t){t.preventDefault(),document.addEventListener("touchmove",n.onTouchMove,{passive:!1}),document.addEventListener("touchend",n.onDragStopped),2===t.touches.length?n.onPinchStart(t):1===t.touches.length&&n.onDragStart(e.getTouchPoint(t.touches[0]))},n.onTouchMove=function(t){2===t.touches.length?n.onPinchMove(t):1===t.touches.length&&n.onDrag(e.getTouchPoint(t.touches[0]))},n.onDragStart=function(t){var e=t.x,o=t.y;n.dragStartPosition={x:e,y:o},n.dragStartCrop={x:n.props.crop.x,y:n.props.crop.y}},n.onDrag=function(t){var e=t.x,o=t.y;n.rafDragTimeout&&window.cancelAnimationFrame(n.rafDragTimeout),n.rafDragTimeout=window.requestAnimationFrame((function(){if(void 0!==e&&void 0!==o){var t=e-n.dragStartPosition.x,r=o-n.dragStartPosition.y,i=m({x:n.dragStartCrop.x+t,y:n.dragStartCrop.y+r},n.imageSize,n.state.cropSize,n.props.zoom);n.props.onCropChange(i)}}))},n.onDragStopped=function(){n.cleanEvents(),n.emitCropData()},n.onWheel=function(t){t.preventDefault();var o=e.getMousePoint(t),r=null;r=t.deltaY<=0?1.05*n.props.zoom:.95*n.props.zoom,n.setNewZoom(r,o)},n.getPointOnContainer=function(t,e){var o=t.x,r=t.y;if(!n.containerRect)throw new Error("The Cropper is not mounted");return{x:n.containerRect.width/2-(o-n.containerRect.left),y:n.containerRect.height/2-(r-n.containerRect.top)}},n.getPointOnImage=function(t){var e=t.x,o=t.y,r=n.props,i=r.crop,a=r.zoom;return{x:(e+i.x)/a,y:(o+i.y)/a}},n.setNewZoom=function(t,e){var o=n.getPointOnContainer(e),r=n.getPointOnImage(o),i=Math.min(n.state.maxZoom,Math.max(t,n.state.minZoom)),a=m({x:r.x*i-o.x,y:r.y*i-o.y},n.imageSize,n.state.cropSize,i);n.props.onCropChange(a),n.props.onZoomChange&&n.props.onZoomChange(i)},n.emitCropData=function(){if(n.state.cropSize){var t=function(t,e,o,n){var r={x:f(100,((e.width-o.width/n)/2-t.x/n)/e.width*100),y:f(100,((e.height-o.height/n)/2-t.y/n)/e.height*100),width:f(100,o.width/e.width*100/n),height:f(100,o.height/e.height*100/n)};return{croppedAreaPercentages:r,croppedAreaPixels:{x:f(e.naturalWidth,r.x*e.naturalWidth/100),y:f(e.naturalHeight,r.y*e.naturalHeight/100),width:f(e.naturalWidth,r.width*e.naturalWidth/100),height:f(e.naturalHeight,r.height*e.naturalHeight/100)}}}(m(n.props.crop,n.imageSize,n.state.cropSize,n.props.zoom),n.imageSize,n.state.cropSize,n.props.zoom),e=t.croppedAreaPercentages,o=t.croppedAreaPixels;n.props.onCropComplete&&n.props.onCropComplete(e,o)}},n.recomputeCropPosition=function(){var t=m(n.props.crop,n.imageSize,n.state.cropSize,n.props.zoom);n.props.onCropChange(t),n.emitCropData()},n.onImgError=function(){var t={width:n.props.widgetArea.width,height:n.props.widgetArea.height};n.setState({cropSize:t})},n.onResize=function(t,e){n.screenWidth=t,n.screenHeight=e},n.state={cropSize:null,minZoom:n.props.minZoom,maxZoom:n.props.maxZoom},n}return b(e,t),e.prototype.componentDidMount=function(){window.addEventListener("resize",this.computeSizes),this.container.addEventListener("gesturestart",this.preventZoomSafari),this.container.addEventListener("gesturechange",this.preventZoomSafari),this.container.addEventListener("wheel",this.onWheel)},e.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.computeSizes),this.container.removeEventListener("gesturestart",this.preventZoomSafari),this.container.removeEventListener("gesturechange",this.preventZoomSafari),this.container.removeEventListener("wheel",this.onWheel),this.cleanEvents()},e.prototype.componentDidUpdate=function(t){t.aspect!==this.props.aspect?this.computeSizes():t.zoom!==this.props.zoom&&this.recomputeCropPosition()},e.prototype.onPinchStart=function(t){var o=e.getTouchPoint(t.touches[0]),n=e.getTouchPoint(t.touches[1]);this.lastPinchDistance=g(o,n),this.onDragStart(v(o,n))},e.prototype.onPinchMove=function(t){var o=this,n=e.getTouchPoint(t.touches[0]),r=e.getTouchPoint(t.touches[1]),i=v(n,r);this.onDrag(i),this.rafZoomTimeout&&window.cancelAnimationFrame(this.rafZoomTimeout),this.rafZoomTimeout=window.requestAnimationFrame((function(){var t=g(n,r),e=o.props.zoom*(t/o.lastPinchDistance);o.setNewZoom(e,i),o.lastPinchDistance=t}))},e.prototype.render=function(){var t=this,e=Object(r.getAppStore)().getState().appContext.isRTL,o=this.props,n=o.crop,i=n.x,a=n.y,s=o.zoom,p=o.showGrid,u=(o.style,o.classes),h=u.containerClassName,l=u.cropAreaClassName,m=u.imageClassName;return Object(r.jsx)("div",{css:this.getStyle,onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,"data-testid":"container",className:h,style:{userSelect:"none",touchAction:"none",cursor:"move",display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",top:this.props.widgetArea.top,left:e?null:this.props.widgetArea.left,right:e?document.body.clientWidth-this.props.widgetArea.right:null,width:this.props.widgetArea.width,height:this.props.widgetArea.height},ref:function(e){t.container=e}},Object(r.jsx)(r.ReactResizeDetector,{handleWidth:!0,handleHeight:!0,onResize:this.onResize}),Object(r.jsx)("img",{src:this.props.image,ref:function(e){t.image=e},onLoad:this.onImgLoad,onError:this.onImgError,alt:"",style:{position:"absolute",transform:"translate("+i+"px, "+a+"px) scale("+s+")",willChange:"transform"},className:m}),this.state.cropSize&&Object(r.jsx)(c,{onCancelCrop:this.props.onCancelCrop,onConfirmCrop:this.props.onConfirmCrop,showGrid:p,style:{width:this.state.cropSize.width,height:this.state.cropSize.height},className:l,svgViewBox:this.props.svgViewBox,svgPath:this.props.svgPath,cropShape:this.props.cropShape,widgetId:this.props.widgetId,screenWidth:this.screenWidth,screenHeight:this.screenHeight,widgetArea:this.props.widgetArea}),this.props.loading&&Object(r.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%"},className:"jimu-secondary-loading"}))},e.defaultProps={zoom:1,aspect:4/3,maxZoom:10,minZoom:1,showGrid:!0,style:{},classes:{},zoomSpeed:1},e.getMousePoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},e.getTouchPoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},e}(r.React.Component),C=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),S=["image/gif","image/svg+xml"],P=function(t){function e(e){var o=t.call(this,e)||this;return o.eidtInfoStyle={width:"100%",height:"100%",margin:0},o.onCropChange=function(t){o.setState({crop:t})},o.onCropAreaComplete=function(t,e){o.setState({croppedAreaPixels:e})},o.onZoomChange=function(t){o.setState({zoom:t})},o.onConfirmCrop=function(t,e,n){if(S.includes(o.props.imageFormat)||o.props.cropType===i.CropType.Fake){var a={cropPosition:o.state.crop,cropZoom:o.state.zoom,svgViewBox:t||"0 0 28 28",svgPath:e||"m0,0l0,28l28,0l0,-28l-28,0z",cropShape:n||"rectangle",cropPixel:o.state.croppedAreaPixels,cropType:i.CropType.Fake};o.props.onConfirmCrop&&o.props.onConfirmCrop(a)}else{var s={cropPosition:o.state.crop,cropZoom:o.state.zoom,svgViewBox:t,svgPath:e,cropShape:n,cropPixel:o.state.croppedAreaPixels,cropType:i.CropType.Real};o.setState({loading:!0}),function(t,e,o){return h(this,void 0,void 0,(function(){return l(this,(function(n){switch(n.label){case 0:return[4,new Promise((function(n,i){HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,o){var n=this;setTimeout((function(){for(var r=atob(n.toDataURL(e,o).split(",")[1]),i=r.length,a=new Uint8Array(i),s=0;s<i;s++)a[s]=r.charCodeAt(s);t(new Blob([a],{type:e||"image/png"}))}))}});var a=new Image;a.setAttribute("crossOrigin","anonymous"),a.src=t,a.addEventListener("load",(function(){var t=document.createElement("canvas");t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(a,e.x,e.y,e.width,e.height,0,0,e.width,e.height),t.toBlob((function(t){var e=this,i=URL.createObjectURL(t),a={file:i,fileName:(new Date).getTime().toString()+".jpeg",type:r.ResourceType.Image,url:i,blobUrl:i,referedIds:[],fileFormat:"image/jpeg",originId:o};if(window.jimuConfig.isBuilder){var s=u.AppResourceManager.getInstance();return s.getBlobByBlobUrl(a.file).then((function(t){return h(e,void 0,void 0,(function(){return l(this,(function(e){return a.file=t,s.upLoadFileToResource(a),a.originId&&u.AppResourceManager.getInstance().updateImageResourceItemInfo(a),[2]}))}))})),n(a)}return r.moduleLoader.getJimuForBuilderModules().appBuilderSync.letBuilderAddResource(a),n(a)}),"image/jpeg",.8)})),a.addEventListener("error",(function(){return i()}))}))];case 1:return[2,n.sent()]}}))}))}(o.props.image,s.cropPixel,o.props.originId).then((function(t){o.setState({loading:!1}),o.props.onConfirmCrop&&o.props.onConfirmCrop(s,t)}),(function(){o.setState({loading:!1})}))}},o.state={modal:!0,crop:o.props.crop?o.props.crop:{x:0,y:0},zoom:o.props.cropZoom?o.props.cropZoom:1,aspect:1,showGrid:!1,zoomSpeed:.1,croppedAreaPixels:null,loading:!1},o}return C(e,t),e.prototype.render=function(){var t=window.jimuConfig.isBuilder;return r.ReactDOM.createPortal(Object(r.jsx)("div",null,Object(r.jsx)("div",{className:"jimu-widget",style:{zIndex:9999,position:"fixed",top:0,left:0,backgroundColor:"rgb(0, 0, 0, .5)"}}),Object(r.jsx)("div",{style:{zIndex:1e4,position:"absolute",top:0},className:Object(r.classNames)({"jimu-widget d-flex justify-content-center align-items-center":t})},Object(r.jsx)(y,{image:this.props.image,crop:this.state.crop,zoom:this.state.zoom,aspect:this.state.aspect,showGrid:this.state.showGrid,zoomSpeed:this.state.zoomSpeed,onCropChange:this.onCropChange,onCropComplete:this.onCropAreaComplete,onZoomChange:this.onZoomChange,onCancelCrop:this.props.onCancelCrop,onConfirmCrop:this.onConfirmCrop,widgetArea:this.props.widgetArea,widgetId:this.props.widgetId,svgViewBox:this.props.cropParam&&this.props.cropParam.svgViewBox,svgPath:this.props.cropParam&&this.props.cropParam.svgPath,cropShape:this.props.cropParam&&this.props.cropParam.cropShape,loading:this.state.loading}))),document&&document.getElementsByTagName("body")[0])},e}(r.React.Component)}}))}}}));