System.register(["jimu-core","jimu-ui"],(function(e){var t,n;return{setters:[function(e){t=e},function(e){n=e}],execute:function(){e(function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=976)}({0:function(e,n){e.exports=t},1:function(e,t){e.exports=n},324:function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M11 9c0 1.657-2.239 3-5 3s-5-1.343-5-3V3c0-1.657 2.239-3 5-3s5 1.343 5 3v6zM9.021 4.264C9.766 3.817 10 3.339 10 3c0-.34-.234-.817-.979-1.264C8.296 1.301 7.231 1 6 1c-1.23 0-2.296.301-3.021.736C2.234 2.183 2 2.661 2 3c0 .34.234.817.979 1.264C3.704 4.699 4.769 5 6 5c1.23 0 2.296-.301 3.021-.736zM10 7.8V9c0 .34-.234.817-.979 1.264C8.296 10.699 7.231 11 6 11c-1.23 0-2.296-.301-3.021-.736C2.234 9.817 2 9.339 2 9V7.8C2.912 8.53 4.364 9 6 9c1.636 0 3.088-.471 4-1.2zM2 6V4.8C2.912 5.53 4.364 6 6 6c1.636 0 3.088-.471 4-1.2V6c0 .34-.234.817-.979 1.264C8.296 7.699 7.231 8 6 8c-1.23 0-2.296-.301-3.021-.736C2.234 6.817 2 6.339 2 6z" fill="#000"></path></svg>'},330:function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0)"><path fill-rule="evenodd" clip-rule="evenodd" d="M5.95 5.243l.707-.707a1 1 0 000-1.415L3.828.293a1 1 0 00-1.414 0L.293 2.414a1 1 0 000 1.414L3.12 6.657a1 1 0 001.415 0l.707-.707.81.81-.707.707a1 1 0 000 1.414l2.828 2.829a1 1 0 001.414 0l2.122-2.122a1 1 0 000-1.414L8.88 5.346a1 1 0 00-1.414 0l-.707.707-.81-.81zm0-1.415L3.12 1 1 3.121 3.828 5.95l.708-.707-.527-.527a.5.5 0 11.707-.707l.527.527.707-.708zm.81 3.64l.502.5a.5.5 0 00.707-.706l-.502-.502.707-.707 2.829 2.828-2.122 2.122-2.828-2.829.707-.707z" fill="#000"></path></g><defs><clipPath id="clip0"><path fill="#fff" d="M0 0h12v12H0z"></path></clipPath></defs></svg>'},976:function(e,t,n){"use strict";n.r(t),n.d(t,"DynamicUrlEditor",(function(){return P})),n.d(t,"UrlInfoSelector",(function(){return v}));var r={};n.r(r),n.d(r,"DynamicUrlEditor",(function(){return l})),n.d(r,"UrlInfoSelector",(function(){return u}));var o,i=n(0),a=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};function l(e){var t=e.theme;return Object(i.css)(o||(o=a(["\n    .component-dynamic-url-editor{\n      width: 100%;\n      height: 100%;\n      .ql-container{\n        background-color: ",";\n      }\n      .ql-editor{\n        padding: "," ",";\n        p{\n          word-break: break-all;\n        }\n      }\n      .dynamic-url-editor-btngroup{\n        background-color: ",";\n      }\n    }\n  "],["\n    .component-dynamic-url-editor{\n      width: 100%;\n      height: 100%;\n      .ql-container{\n        background-color: ",";\n      }\n      .ql-editor{\n        padding: "," ",";\n        p{\n          word-break: break-all;\n        }\n      }\n      .dynamic-url-editor-btngroup{\n        background-color: ",";\n      }\n    }\n  "])),t.colors.palette.light[200],i.polished.rem(5),i.polished.rem(6),t.colors.palette.light[200])}var c,s=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};function u(e){var t=e.theme;return Object(i.css)(c||(c=s(["\n    .component-url-info-selector{\n      .param-list{\n        height: calc(100% - 45px);\n        overflow-y: auto;\n        .param-item.param-item-selected{\n          border: 1px solid ",";\n        }\n        .param-item{\n          border: 1px solid transparent;\n          cursor: pointer;\n          background-color: ",";\n          user-select: none;\n        }\n        .param-item:hover{\n          background-color: ",";\n        }\n        .param-item:active.param-item:hover{\n          background-color: ",";\n        }\n      }\n    }\n  "],["\n    .component-url-info-selector{\n      .param-list{\n        height: calc(100% - 45px);\n        overflow-y: auto;\n        .param-item.param-item-selected{\n          border: 1px solid ",";\n        }\n        .param-item{\n          border: 1px solid transparent;\n          cursor: pointer;\n          background-color: ",";\n          user-select: none;\n        }\n        .param-item:hover{\n          background-color: ",";\n        }\n        .param-item:active.param-item:hover{\n          background-color: ",";\n        }\n      }\n    }\n  "])),t.colors.primary,t.colors.palette.light[400],t.colors.palette.light[500],t.colors.white)}var d,p,f=n(1),m=i.ReactRedux.useSelector,h=i.React.useState,b=function(e){var t=[];return Object.keys(e).forEach((function(n){"draft"!==n&&t.push({key:n,value:e[n]})})),t},v=i.themeUtils.withStyles((function(e){var t,n=e.editor,r=e.className,o=e.selectWidgets,a=e.selection,l=m((function(e){return(e.appStateInBuilder?e.appStateInBuilder:e).queryObject})),c=function(e){var t=o.findIndex((function(t){return t.id===e})),n={};if(t>-1){var r=o[t].config.expression,a="";if(r&&(a=r.replace(/<[^>]+>/g,"")),a&&-1!=a.indexOf("?")){var c=a.substr(a.indexOf("?"));n=i.queryString.parse(c)}}else n=l;return n},s=h("appURL"),u=s[0],d=s[1],p=h(b(c(u))),v=p[0],y=p[1],x=f.hooks.useEventCallback((function(e){if(null!=a){var t=Object(i.Immutable)(e).name;!function(e,t,r,o){n.deleteText(o.index,o.length),n.insertEmbed(o.index,"urlInfo",{uniqueid:e,name:t,urlInfo:r},"user"),n.setSelection(o.index+1,"user"),n.focus()}(i.utils.getUUID(),t,e,a)}}));return i.React.createElement("div",{className:Object(i.classNames)("w-100 h-100",(t={},t[r]=!!r,t))},i.React.createElement("div",{className:"component-url-info-selector w-100 h-100"},i.React.createElement("div",{className:"p-3",style:{display:"none"}},i.React.createElement(f.Select,{size:"sm",value:u,onChange:function(e){var t=e.target.value;d(t),y(b(c(t)))},className:"top-drop"},[{id:"appURL",name:"App Url"}].map((function(e){return i.React.createElement("option",{key:e.id,value:e.id,title:e.name},e.name)})))),i.React.createElement("div",{className:"param-list px-3"},v.map((function(e){return i.React.createElement("div",{key:e.key,title:e.key,onClick:function(){return t=e.key,n={type:i.UrlInfoPartType.Urlinfo,urlsearch:"{"+u+".search."+t+"}"},void x({name:n.urlsearch,parts:[n]});var t,n},className:"param-item text-truncate mt-2 p-1"},""+e.key)})))))}),"UrlInfoSelector"),y=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},x=(d=function(e,t){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}d(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),g=function(){return(g=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},j=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},O=i.React.useState,E=i.React.useRef,w=n(324),R=n(330),S=[{name:"preventOverflow",options:{altAxis:!0}},Object(f.getFallbackPlacementsModifier)(["left-start","left-end"],!0)],k=[0,8],M=function(e){var t,n=e.className,r=e.editorRef,o=e.useDataSourcesEnabled,a=e.useDataSources,l=e.onChange,c=e.widgetId,s=e.value,u=e.selectWidgets,d=e.RichExpressionBuilder,m=(e.useMixinKeyboardEnterModules,e.useEditorSelectionFormats),h=(e.richTextEditorUtils,e.RichEditorCore),b=e.Delta,x=e.ExpressionBuilderType,M=j(e,["className","editorRef","useDataSourcesEnabled","useDataSources","onChange","widgetId","value","selectWidgets","RichExpressionBuilder","useMixinKeyboardEnterModules","useEditorSelectionFormats","richTextEditorUtils","RichEditorCore","Delta","ExpressionBuilderType"]),C=O(!1),P=C[0],I=C[1],U=O(!1),T=U[0],B=U[1],N=E(null),D=E(null),z=f.hooks.useForwardValueRef(r),_=z[0],L=z[1],F=f.hooks.useTranslate(f.defaultMessages),q=m(_,!0),K=q[0],V=q[1],A=O(s),W=A[0],H=A[1],J=i.React.useCallback((function(e,t){if(function(e){var t;return!!(null===(t=null==e?void 0:e.ops)||void 0===t?void 0:t.length)&&e.ops.some((function(e){var t,n=null!==(t=null==e?void 0:e.insert)&&void 0!==t?t:{};return n.urlInfo||n.expression||n.urlinfo}))}(t))return t;var n=t.map((function(e){return"string"==typeof e.insert?e.insert:""})).join("");return(new b).insert(n)}),[b]),G=i.React.useMemo((function(){return{toolbar:!1,keyboard:{bindings:{bold:{handler:function(){}},italic:{handler:function(){}},underline:{handler:function(){}},enter:{key:13,handler:function(){}}}},clipboard:{matchers:[["*",J]]}}}),[J]);f.hooks.useUnmount((function(){l(W)}));var Q=a&&a.length>0;return Object(i.jsx)("div",{className:Object(i.classNames)("w-100 h-100",(t={},t[n]=!!n,t))},Object(i.jsx)("div",{className:"component-dynamic-url-editor"},Object(i.jsx)(h,g({modules:G,className:Object(i.classNames)("rich-text-editor"),onChange:function(e){H(e)},onBlur:function(){l(W)},editorRef:L,onKeyDown:function(e){e&&e.target&&13===e.keyCode&&e.target.blur()},defaultValue:s,placeholder:F("websitePlaceholder")},M)),Object(i.jsx)("div",{className:"dynamic-url-editor-btngroup"},Object(i.jsx)(f.Button,{size:"sm",icon:!0,onClick:function(){I(!P),P&&!T||_.focus(),T&&B(!1)},ref:N,active:P,type:"tertiary",title:F("urlInfo")},Object(i.jsx)(f.Icon,{icon:R,size:12})),o&&Object(i.jsx)(f.Button,{size:"sm",icon:!0,onClick:function(){B(!T),!P&&T||_.focus(),P&&I(!1)},ref:D,active:T,type:"tertiary",disabled:!Q,title:F(Q?"data":"dataUnavailableTips")},Object(i.jsx)(f.Icon,{icon:w,size:12}))),Object(i.jsx)(f.Popper,{open:P,disableResize:!0,placement:"left-start",reference:N.current,modifiers:S,showArrow:!0,toggle:function(e){(null==_?void 0:_.root.contains(null==e?void 0:e.target))||I((function(e){return!e}))}},Object(i.jsx)("div",{style:{width:180,height:300}},Object(i.jsx)(f.PanelHeader,{className:"px-3 py-2",title:F("urlInfo"),onClose:function(){return I(!1)}}),Object(i.jsx)(v,{editor:_,className:n,selectWidgets:u,selection:V,formats:K}))),Object(i.jsx)(f.Popper,{open:T,disableResize:!0,placement:"left-start",reference:D.current,modifiers:S,showArrow:!0,toggle:function(e){(null==_?void 0:_.root.contains(null==e?void 0:e.target))||B((function(e){return!e}))},offset:k},Object(i.jsx)("div",{css:Object(i.css)(p||(p=y(["\n            width: 240px;\n            height: 360px;\n            .field-list{\n              height: calc(100% - 200px) !important;\n            }\n          "],["\n            width: 240px;\n            height: 360px;\n            .field-list{\n              height: calc(100% - 200px) !important;\n            }\n          "])))},Object(i.jsx)(f.PanelHeader,{className:"px-3 py-2",title:F("dataPanelTitle"),onClose:function(){return B(!1)}}),Object(i.jsx)(d,{widgetId:c,source:"user",useDataSources:a,editor:_,formats:K,editable:!1,autoInsertSpace:!1,types:Object(i.Immutable)([x.Attribute]),selection:V})))))},C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={moduleLoaded:!1},t}return x(t,e),t.prototype.componentDidMount=function(){var e=this;Promise.all([i.moduleLoader.loadModule("jimu-ui/advanced/rich-text-editor"),i.moduleLoader.loadModule("jimu-ui/advanced/expression-builder")]).then((function(t){var n=t[0],r=n.RichExpressionBuilder,o=n.useEditorSelectionFormats,i=n.richTextEditorUtils,a=n.RichEditorCore,l=n.Delta,c=n.useMixinKeyboardEnterModules,s=t[1].ExpressionBuilderType;e.state.moduleLoaded||(e.RichExpressionBuilder=r,e.useEditorSelectionFormats=o,e.richTextEditorUtils=i,e.RichEditorCore=a,e.ExpressionBuilderType=s,e.Delta=l,e.useMixinKeyboardEnterModules=c,e.setState({moduleLoaded:!0}))}))},t.prototype.render=function(){return this.state.moduleLoaded?Object(i.jsx)(M,g({},this.props,{Delta:this.Delta,useMixinKeyboardEnterModules:this.useMixinKeyboardEnterModules,RichExpressionBuilder:this.RichExpressionBuilder,useEditorSelectionFormats:this.useEditorSelectionFormats,richTextEditorUtils:this.richTextEditorUtils,RichEditorCore:this.RichEditorCore,ExpressionBuilderType:this.ExpressionBuilderType})):null},t}(i.React.PureComponent),P=i.themeUtils.withStyles(C,"DynamicUrlEditor");i.ThemeManager.getInstance().registerJimuThemeStyleModule("jimu-ui/advanced/dynamic-url-editor",{componentStyles:r})}}))}}}));