System.register(["jimu-core","jimu-ui","jimu-layouts/layout-runtime","jimu-for-builder","jimu-layouts/layout-builder"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t},function(t){n=t},function(t){i=t},function(t){o=t},function(t){r=t}],execute:function(){t(function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=471)}({0:function(t,n){t.exports=e},1:function(t,e){t.exports=n},24:function(t,e){t.exports=r},25:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var i=2,o=12},471:function(t,e,n){"use strict";n.r(e);var i,o,r,a,l,s,d,f,u,h,c=n(0),p=n(1),g=n(5),m=n(25),y=n(8),v=n(24),b=n(51),w=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},I=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),x=function(){return(x=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},j=Object(c.css)(o||(o=w(["\n  position: absolute;\n  left: 0;\n  max-height: 40px;\n  height: 20%;\n  right: 0;\n  z-index: ",";\n  display: flex;\n  pointer-events: all;\n  display: flex;\n\n  &.drop-active {\n    background: transparent !important;\n  }\n\n  body:not(.design-mode) & {\n    display: none !important;\n  }\n"],["\n  position: absolute;\n  left: 0;\n  max-height: 40px;\n  height: 20%;\n  right: 0;\n  z-index: ",";\n  display: flex;\n  pointer-events: all;\n  display: flex;\n\n  &.drop-active {\n    background: transparent !important;\n  }\n\n  body:not(.design-mode) & {\n    display: none !important;\n  }\n"])),g.LayoutZIndex.BoundaryDropArea),O=Object(c.css)(r||(r=w(["\n  ",";\n  top: 0;\n"],["\n  ",";\n  top: 0;\n"])),j),R=Object(c.css)(a||(a=w(["\n  ",";\n  bottom: 0;\n"],["\n  ",";\n  bottom: 0;\n"])),j),S=function(t){function e(e){var n,i,o=t.call(this,e)||this;return o.state={isResizing:!1,dh:0},o.handleResizeStart=function(t,e,n){o.initWidth=e,o.initHeight=n,o.props.onResizeStart(t),o.setState({isResizing:!0})},o.handleResizing=function(t,e,n,i,r){o.props.onResizing(t,e,n,i,r),o.setState({dh:r,isResizing:!0})},o.handleResizeEnd=function(t,e,n,i,r,a){var l=o.props.layoutItem;o.props.onResizeEnd(t,e,n,i,r,l),o.setState({isResizing:!1,dh:0})},o.handleDropAtTop=function(t,e,n){o.dropAtBoundary(t,e,n,"top")},o.handleDropAtBottom=function(t,e,n){o.dropAtBoundary(t,e,n,"bottom")},o.dropAtBoundary=function(t,e,n,i){var r=Object(y.getAppConfigAction)();Object(v.mergeWidgetsIntoColumn)(r.appConfig,t,e,n,{layoutId:o.props.layoutId,layoutItemId:o.props.layoutItemId},i).then((function(t){var e=t.updatedAppConfig;(r=Object(y.getAppConfigAction)(e)).exec()})).finally(null)},o.pasteAtBoundary=function(t,e,n,i){var r=Object(y.getAppConfigAction)(),a=t.layoutInfo,l=a.layoutId,s=a.layoutItemId,d={layoutInfo:r.duplicateLayoutItem(l,l,s,!0)};Object(v.mergeWidgetsIntoColumn)(r.appConfig,d,e,n,{layoutId:o.props.layoutId,layoutItemId:o.props.layoutItemId},i).then((function(t){var e=t.updatedAppConfig;(r=Object(y.getAppConfigAction)(e)).exec()})).finally(null)},o.fakeTopLayouts=Object(c.Immutable)(((n={})[c.BrowserSizeMode.Large]=o.props.layoutId+"_"+o.props.layoutItemId+"_tlarge",n[c.BrowserSizeMode.Medium]=o.props.layoutId+"_"+o.props.layoutItemId+"_tmedium",n[c.BrowserSizeMode.Small]=o.props.layoutId+"_"+o.props.layoutItemId+"_tsmall",n)),o.fakeBottomLayouts=Object(c.Immutable)(((i={})[c.BrowserSizeMode.Large]=o.props.layoutId+"_"+o.props.layoutItemId+"_blarge",i[c.BrowserSizeMode.Medium]=o.props.layoutId+"_"+o.props.layoutItemId+"_bmedium",i[c.BrowserSizeMode.Small]=o.props.layoutId+"_"+o.props.layoutItemId+"_bsmall",i)),o}return I(e,t),e.prototype.isFunctionalWidget=function(){var t,e,n,i=this.props.layoutItem;if(i.type===c.LayoutItemType.Widget){var o=!1,r=null===(e=null===(t=Object(c.getAppStore)().getState().appConfig)||void 0===t?void 0:t.widgets)||void 0===e?void 0:e[i.widgetId];return null!=(null===(n=null==r?void 0:r.manifest)||void 0===n?void 0:n.properties)&&(o=r.manifest.widgetType===c.WidgetType.Layout||r.manifest.properties.hasEmbeddedLayout),!o}return!1},e.prototype.calHeight=function(t,e){var n,i,o,r,a,l,s,d,f,u,h,c,p;return this.props.isMultiRow?{height:e.height,alignSelf:null!==(i=null===(n=t.style)||void 0===n?void 0:n.alignSelf)&&void 0!==i?i:"flex-start"}:"ratio"===t.heightMode?{alignSelf:null!==(r=null===(o=t.style)||void 0===o?void 0:o.alignSelf)&&void 0!==r?r:"flex-start"}:(null===(a=t.autoProps)||void 0===a?void 0:a.height)===g.LayoutItemSizeModes.Auto?{height:"auto",alignSelf:null!==(s=null===(l=t.style)||void 0===l?void 0:l.alignSelf)&&void 0!==s?s:"flex-start"}:(null===(d=t.autoProps)||void 0===d?void 0:d.height)===g.LayoutItemSizeModes.Custom?{height:e.height,alignSelf:null!==(u=null===(f=t.style)||void 0===f?void 0:f.alignSelf)&&void 0!==u?u:"flex-start"}:(null===(h=t.autoProps)||void 0===h?void 0:h.height)===g.LayoutItemSizeModes.Stretch||"fit"===t.heightMode?{alignSelf:"stretch"}:parseFloat(e.height)>0?{height:e.height,alignSelf:null!==(p=null===(c=t.style)||void 0===c?void 0:c.alignSelf)&&void 0!==p?p:"flex-start"}:{alignSelf:"stretch"}},e.prototype.getStyle=function(t){var e,n,i,o,r,a,d=this.props,f=d.gutter,u=d.layoutItem,h=d.isMultiRow,p=this.state,m=p.dh,y=p.isResizing,v=u.bbox,b=this.calHeight(t,v);return 0===t.offsetX&&0===t.offsetY||(b.transform="translate("+(null!==(e=t.offsetX)&&void 0!==e?e:0)+"px, "+(null!==(n=t.offsetY)&&void 0!==n?n:0)+"px)"),y&&0!==m&&(b.height=this.initHeight+m),h?Object(c.css)(l||(l=w(["\n        padding: ","px 0;\n        transform: ",";\n        height: ",";\n        align-self: ",";\n      "],["\n        padding: ","px 0;\n        transform: ",";\n        height: ",";\n        align-self: ",";\n      "])),f/2,0!==t.offsetX||0!==t.offsetY?"translate("+(null!==(i=t.offsetX)&&void 0!==i?i:0)+"px, "+(null!==(o=t.offsetY)&&void 0!==o?o:0)+"px)":null,g.utils.getValueOfBBox(b,"height"),b.alignSelf):Object(c.css)(s||(s=w(["\n      padding: 0 ","px;\n      transform: ",";\n      height: ",";\n      align-self: ",";\n    "],["\n      padding: 0 ","px;\n      transform: ",";\n      height: ",";\n      align-self: ",";\n    "])),f/2,0!==t.offsetX||0!==t.offsetY?"translate("+(null!==(r=t.offsetX)&&void 0!==r?r:0)+"px, "+(null!==(a=t.offsetY)&&void 0!==a?a:0)+"px)":null,g.utils.getValueOfBBox(b,"height"),b.alignSelf)},e.prototype.render=function(){var t,e=this.props,n=e.order,i=e.span,o=e.offset,r=e.layoutId,a=e.layoutItem,l=e.draggable,s=e.resizable,p=e.selectable;if(null==a||a.isPending)return null;var m=c.lodash.assign({},b.a,a.setting),y="ratio"===m.heightMode,I=null===(t=m.autoProps)||void 0===t?void 0:t.height,j=Object(c.classNames)("row-layout-item d-flex","col-"+i,"offset-"+o,"order-"+n,{"fix-height":I===g.LayoutItemSizeModes.Custom}),S=this.isFunctionalWidget(),z=Object(c.css)(d||(d=w(["\n      width: 100%;\n      height: 10px;\n      background: ",";\n    "],["\n      width: 100%;\n      height: 10px;\n      background: ",";\n    "])),this.props.builderTheme.colors.palette.primary[700]),M=g.utils.parseAspectRatio(m.aspectRatio),C=g.utils.handleOnebyOneAnimation(this.props);return Object(c.jsx)(v.LayoutItemInBuilder,x({css:this.getStyle(m),layoutId:r,layoutItemId:a.id,onResizeStart:this.handleResizeStart,onResizing:this.handleResizing,onResizeEnd:this.handleResizeEnd,left:!0,right:!0,top:!1,bottom:I===g.LayoutItemSizeModes.Custom&&!y,draggable:l,resizable:s,selectable:p,onClick:this.props.onClick,className:j,forceAspectRatio:y,aspectRatio:M},C),Object(c.jsx)(c.React.Fragment,null,S&&Object(c.jsx)(v.DropArea,{css:Object(c.css)(f||(f=w(["\n                ",";\n              "],["\n                ",";\n              "])),O),layouts:this.fakeTopLayouts,highlightDragover:!0,onDrop:this.handleDropAtTop},Object(c.jsx)("div",{css:z})),S&&Object(c.jsx)(v.DropArea,{css:Object(c.css)(u||(u=w(["\n                ",";\n              "],["\n                ",";\n              "])),R),layouts:this.fakeBottomLayouts,highlightDragover:!0,onDrop:this.handleDropAtBottom},Object(c.jsx)("div",{css:Object(c.css)(h||(h=w(["",";position: absolute; bottom:0;"],["",";position: absolute; bottom:0;"])),z)}))))},e}(c.React.PureComponent);function z(t,e){var n=-1;return e.some((function(e,i){if(e.id===t)return n=i,!0})),n}function M(t,e,n,i){var o=i.map((function(t){return Object(c.Immutable)(t)})),r=z(t,o);if(g.utils.isRTL()&&(e=0!==e?0:-n),e>0){var a=o[r],l=Math.min(e,a.width-1);return o[r]=a.set("left",a.left+l).set("width",a.width-l),o}if(e<0){for(var s=0,d=0;d<r;d+=1)s+=Math.min(o[d].width,m.a);var f=o[r].left-s,u=Math.abs(e);if(f>0){var h=0;for(d=r;d>=0;d-=1){var p=o[d],y=0;if(d>0){var v=o[d-1];y=p.left-(v.left+v.width)}else y=p.left;if(0!==y){var b=h+y>=u?u-h:y;o[r]=o[r].set("width",o[r].width+b);for(var w=d;w<=r;w+=1)o[w]=o[w].set("left",o[w].left-b);if(h+y>=u)return o;h+=y}}if(r>0)for(d=r-1;d>=0;d-=1){if(!((y=(p=o[d]).width-m.a)<=0)){b=h+y>=u?u-h:y;o[r]=o[r].set("width",o[r].width+b),o[d]=p.set("width",p.width-b);for(w=d+1;w<=r;w+=1)o[w]=o[w].set("left",o[w].left-b);if(h+y>=u)return o;h+=y}}}return o}if(n<0){l=Math.min(Math.abs(n),o[r].width-1);return o[r]=o[r].set("width",o[r].width-l),o}if(n>0){var I=0;for(d=r+1;d<o.length;d+=1)I+=Math.min(o[d].width,m.a);u=n;if((f=m.b-(o[r].left+o[r].width)-I)>0){for(h=0,d=r;d<o.length;d+=1){p=o[d],y=0;if(d!==o.length-1)y=o[d+1].left-(p.left+p.width);else y=m.b-(p.left+p.width);if(0!==y){b=h+y>=u?u-h:y;o[r]=o[r].set("width",o[r].width+b);for(w=r+1;w<=d;w+=1)o[w]=o[w].set("left",o[w].left+b);if(h+y>=u)return o;h+=y}}if(r!==o.length-1)for(d=r+1;d<o.length;d+=1){if(!((y=(p=o[d]).width-m.a)<=0)){b=h+y>=u?u-h:y;o[r]=o[r].set("width",o[r].width+b),o[d]=p.set("width",p.width-b);for(w=r+1;w<=d;w+=1)o[w]=o[w].set("left",o[w].left+b);if(h+y>=u)return o;h+=y}}}return o}return o}function C(t,e,n){var i=n.map((function(t){return Object(c.Immutable)(t)})),o=z(t,i),r=i[o];return i.splice(o,1),P(r,e,i)}function P(t,e,n){var i=n.map((function(t){return Object(c.Immutable)(t)})),o=Object(c.Immutable)(t),r=Math.max(e,0);if(o=o.set("left",r),null==i||0===i.length)return[o=o.set("width",Math.min(o.width,m.b-o.left))];var a,l=i.length,s=function(){if(0===l)d=i[l].left,a=d;else{var t=i[l-1];d=l<i.length?i[l].left-(t.left+t.width):m.b-(t.left+t.width),a=t.left+t.width+d}};i.some((function(t,e){if(r<=t.left)return l=e,!0}));var d=l<i.length?i[l].left-r:m.b-r;if(d>=o.width)return i.splice(l,0,o),i;var f=d;if(s(),d>=o.width)return o=o.set("left",a-o.width),i.splice(l,0,o),i;d=f;for(var u=l;u<i.length;u+=1){var h=i[u],p=0;if(u!==i.length-1)p=i[u+1].left-(h.left+h.width);else p=m.b-(h.left+h.width);if(0!==p){for(var g=d+p>=o.width?o.width-d:p,y=l;y<=u;y+=1)i[y]=i[y].set("left",i[y].left+g);if(d+p>=o.width)return i.splice(l,0,o),i;d+=p}}if(s(),d>=o.width)return o=o.set("left",a-o.width),i.splice(l,0,o),i;for(u=l-1;u>=0;u-=1){h=i[u],p=0;if(u>0){var v=i[u-1];p=h.left-(v.left+v.width)}else p=h.left;if(0!==p){for(g=d+p>=o.width?o.width-d:p,y=u;y<=l-1;y+=1)i[y]=i[y].set("left",i[y].left-g);if(d+p>=o.width)return o=o.set("left",a-o.width),i.splice(l,0,o),i;d+=p}}if(s(),d>=m.a)return o=o.set("left",a-d).set("width",d),i.splice(l,0,o),i;if(l!==i.length)for(u=l;u<i.length;u+=1){if(!((p=(h=i[u]).width-m.a)<=0)){g=d+p>=m.a?m.a-d:p;i[u]=h.set("width",h.width-g);for(y=l;y<=u;y+=1)i[y]=i[y].set("left",i[y].left+g);if(d+p>=m.a)return o=o.set("left",i[l].left-m.a).set("width",m.a),i.splice(l,0,o),i;d+=p}}if(s(),d>=m.a)return o=o.set("left",a-d).set("width",d),i.splice(l,0,o),i;for(u=l-1;u>=0;u-=1){if(!((p=(h=i[u]).width-m.a)<=0)){g=d+p>=m.a?m.a-d:p;i[u]=h.set("width",h.width-g);for(y=u+1;y<=l-1;y+=1)i[y]=i[y].set("left",i[y].left-g);if(d+p>=m.a)return o=o.set("left",a-m.a).set("width",m.a),i.splice(l,0,o),i;d+=p}}return i}var D,L,A,_,T,B,E,W,k,N,Y=n(80),X=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},F=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),H=Object(c.css)(D||(D=X(["\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n"],["\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n"]))),U=Object(c.css)(L||(L=X(["\n  ",";\n  bottom: 0;\n  top: 0;\n  z-index: ",";\n  pointer-events: none;\n"],["\n  ",";\n  bottom: 0;\n  top: 0;\n  z-index: ",";\n  pointer-events: none;\n"])),H,g.LayoutZIndex.DragMoveTip),V=function(t){function e(e){var n=t.call(this,e)||this;return n.state={isResizing:!1,updatingRects:null,isDragoverCenter:!1},g.utils.autoBindHandlers(n,["handleItemResizeStart","handleItemResizing","handleItemResizeEnd","handleDrop","handleDragOver","handleDragEnter","handleDragLeave","handleToggleDragoverCenterEffect"]),n.flipLeftRight=g.utils.isRTL(),n}return F(e,t),e.prototype.componentDidMount=function(){this.canvasPane=new v.CanvasPane(this.guideDragOverRef)},e.prototype.handleItemResizeStart=function(t){this.domRect=this.ref.getBoundingClientRect(),this.setState({isResizing:!0})},e.prototype.handleItemResizing=function(t,e,n,i,o){var r=this.domRect.width/m.b,a=M(t,Math.round(e/r),Math.round(i/r),this.childRects);this.setState({updatingRects:a})},e.prototype.handleItemResizeEnd=function(t,e,n,i,o,r){var a=this,l=this.props.layout,s=this.domRect.width/m.b,d=Math.round(e/s),f=Math.round(i/s),u=Object(y.getAppConfigAction)();M(t,d,f,this.childRects).forEach((function(e){var n=l.content[e.id].bbox,i=n.height;e.id===t&&(i=g.utils.isPercentage(n.height)?(parseFloat(e.height)+100*o/a.domRect.height).toFixed(4)+"%":Math.round(parseFloat(e.height)+o)+"px");var r={left:e.left,width:e.width,height:i};u.editLayoutItemBBox({layoutId:l.id,layoutItemId:e.id},r)})),u.exec(),this.setState({isResizing:!1,updatingRects:null})},e.prototype.handleToggleDragoverCenterEffect=function(t){this.referenceId=null,t&&this.collectBounds(),this.setState({isDragoverCenter:t})},e.prototype.handleDragOver=function(t,e,n,i,o,r){var a,l,s=null!==(a=t.layoutInfo)&&void 0!==a?a:{layoutId:null},d=this.reCalculateRects(t,n,i,o);d.some((function(t){if(null==t.id||t.layoutId===s.layoutId&&t.id===s.layoutItemId)return l=t,!0}));var f=!0,u=l.left;if(this.flippedChildRects.some((function(t){if((t.layoutId!==l.layoutId||t.id!==l.id)&&(t.left<=l.left&&t.left+t.width>l.left&&(f=!1),!f)){var e=d.find((function(e){return e.layoutId===t.layoutId&&e.id===t.id}));return u=e.left+e.width<=l.left?t.left+t.width:t.left,!0}})),this.dragInsertPos=u,this.canvasPane.clear(),f)this.canvasPane.drawRect({left:u*this.colWidth+this.space/2,top:0,width:l.width*this.colWidth-this.space,height:i.height});else{var h=Math.min(n.width-this.space/2,Math.max(0,u*this.colWidth-this.space/2));this.canvasPane.drawRect({left:h,top:0,width:10,height:n.height})}},e.prototype.handleDragEnter=function(){this.canvasPane.setSize(this.ref.clientWidth,this.ref.clientHeight),this.canvasPane.setColor(c.polished.rgba(this.builderTheme.colors.palette.primary[700],.5))},e.prototype.handleDragLeave=function(){this.canvasPane.clear()},e.prototype.reCalculateRects=function(t,e,n,i){var o,r,a=null!==(o=t.layoutInfo)&&void 0!==o?o:{layoutId:null},l=this.props,s=l.config,d=l.layout;this.space=null!==(r=s.space)&&void 0!==r?r:0;var f=this.maxPageWidth>0?Math.min(this.maxPageWidth,e.width):e.width,u=i-(e.width-f)/2,h=n.left-(e.width-f)/2;this.colWidth=f/m.b;var c=Math.round(u/this.colWidth),p=Math.round(h/this.colWidth),g=Math.round(n.width/this.colWidth),y=function(t,e,n,i,o,r){var a,l,s=null!==(a=e.layoutInfo)&&void 0!==a?a:{layoutId:null},d=s.layoutId===t;return r.some((function(t){return(!d||t.id!==s.layoutItemId)&&(t.left>=n&&t.left<n+i||n>=t.left&&n<t.left+t.width)}))?(r.some((function(t,e){if(d&&t.id===s.layoutItemId)return!1;if(o>=t.left&&o<=t.left+t.width)return o>=t.left&&o<t.left+t.width/2?(l=t.left,!0):(l=t.left+t.width,!0);if(n<t.left&&n+i>t.left){var a=0;if(0===e)a=t.left;else{for(var f=void 0,u=e-1;u>=0&&(f=r[u],d&&f.id===s.layoutItemId);u-=1);a=null!=f?t.left-(f.left+f.width):t.left}return l=a>=i?t.left-i:t.left-a,!0}return n>t.left&&n<t.left+t.width?(l=t.left+t.width,!0):void 0})),l):n}(d.id,t,p,g,c,this.flippedChildRects);return null==t.id&&this.isInRow(a)?C(a.layoutItemId,y,this.flippedChildRects):P({width:g,height:n.height,layoutId:a.layoutId,id:a.layoutItemId},y,this.flippedChildRects)},e.prototype.handleDrop=function(t,e,n){var i=this.props.layout,o=Object(y.getAppConfigAction)(),r=this.calDropPosition(o.appConfig,t,e,n,!1),a=r.addedItemRect,l=r.insertIndex,s=r.appConfig;null!=a?Object(v.addItemToLayout)(s,t,{layoutId:i.id},e,a,l).then((function(e){var n,r=e.layoutInfo,a=e.updatedAppConfig;o=Object(y.getAppConfigAction)(a),(null===(n=t.layoutInfo)||void 0===n?void 0:n.layoutId)!==i.id&&o.editLayoutItemSetting(r,{heightMode:"fit"});var l=r.layoutId,s=r.layoutItemId,d=a.layouts[l].content[s].bbox;d=d.without("top").without("right").without("bottom"),o.editLayoutItemBBox(r,d),Object(c.getAppStore)().dispatch(c.appActions.layoutChanged(o.appConfig,r))})).finally(null):Object(c.getAppStore)().dispatch(c.appActions.layoutChanged(s,t.layoutInfo)),this.canvasPane.clear()},e.prototype.calDropPosition=function(t,e,n,i,o){var r,a,l,s=this,d=this.maxPageWidth>0?Math.min(this.maxPageWidth,n.width):n.width,f=null!==(r=e.layoutInfo)&&void 0!==r?r:{layoutId:null},u=this.props.layout,h=d/m.b,c=this.dragInsertPos,p=Math.round(i.width/h),g=Object(y.getAppConfigAction)(t);return(!o&&null==e.id&&this.isInRow(f)?C(f.layoutItemId,c,this.flippedChildRects):P({width:p,height:i.height,layoutId:f.layoutId,id:f.layoutItemId},c,this.flippedChildRects)).forEach((function(t,n){var i,o={left:t.left,width:t.width,height:t.height};if(s.flipLeftRight&&(o=Object(Y.b)(o)),t.layoutId===u.id)g.editLayoutItemBBox({layoutId:t.layoutId,layoutItemId:t.id},o),t.id===(null===(i=e.layoutInfo)||void 0===i?void 0:i.layoutItemId)&&null!=e.id&&g.setLayoutItemToPending({layoutId:t.layoutId,layoutItemId:t.id},!1);else{a=o,l=0+n}})),{addedItemRect:a,insertIndex:l,appConfig:g.appConfig}},e.prototype.isInRow=function(t){var e=this.props.layout;return(null==t?void 0:t.layoutId)===e.id},e.prototype.collectBounds=function(){var t,e=this,n=this.props.transformedLayout,i=null!==(t=n.order)&&void 0!==t?t:[];return this.childRects=[],i.forEach((function(t){var i,o;if(!n.content[t].isPending){var r=null===(o=null===(i=n.content)||void 0===i?void 0:i[t])||void 0===o?void 0:o.bbox;null!=r&&e.childRects.push({layoutId:n.id,id:t,left:parseInt(r.left,10),width:parseInt(r.width,10),height:r.height})}})),this.childRects.sort((function(t,e){return t.left-e.left})),this.flipLeftRight?(this.flippedChildRects=[],this.childRects.forEach((function(t){var n={left:t.left,width:t.width,height:t.height};n=Object(Y.b)(n),e.flippedChildRects.push({layoutId:t.layoutId,id:t.id,left:n.left,width:n.width,height:n.height})})),this.flippedChildRects.sort((function(t,e){return t.left-e.left}))):this.flippedChildRects=this.childRects,this.childRects},e.prototype.createItem=function(t,e,n){var i,o,r=this.props,a=r.transformedLayout,l=r.itemDraggable,s=r.itemResizable,d=r.itemSelectable,f=r.config,u=r.isMultiRow,h=t[e],p=null!==(i=f.space)&&void 0!==i?i:0;if(0===e)o=h.left;else{var g=t[e-1];o=h.left-g.left-g.width}return Object(c.jsx)(S,{key:h.id,order:e+1,offset:o,span:h.width,gutter:p,isMultiRow:u,builderTheme:this.builderTheme,layoutId:a.id,layoutItemId:h.id,layoutItem:a.content[h.id],draggable:l,resizable:s,selectable:d,alignItems:n.alignItems,onResizeStart:this.handleItemResizeStart,onResizing:this.handleItemResizing,onResizeEnd:this.handleItemResizeEnd})},e.prototype.render=function(){var t,e,n,i=this,o=this.props,r=o.transformedLayout,a=o.className,l=o.config,s=this.state,d=s.isResizing,f=s.isDragoverCenter;d&&null!=this.state.updatingRects?n=this.state.updatingRects:(this.collectBounds(),n=this.childRects);var u=null!==(t=l.style)&&void 0!==t?t:{},h=null!==(e=l.space)&&void 0!==e?e:0;return Object(c.jsx)(g.PageContext.Consumer,null,(function(t){return i.maxPageWidth=t.maxWidth,i.builderTheme=t.builderTheme,Object(c.jsx)("div",{className:Object(c.classNames)("row-layout",a,{"row-rtl":i.flipLeftRight}),css:Y.a,"data-layoutid":r.id},Object(c.jsx)("div",{css:Object(c.css)(A||(A=X(["\n            width: 100%;\n            max-width: ",";\n          "],["\n            width: 100%;\n            max-width: ",";\n          "])),t.maxWidth>0?t.maxWidth+"px":"none")},Object(c.jsx)("div",{ref:function(t){return i.ref=t},css:Object(c.css)(_||(_=X(["\n                position: relative;\n                height: 100%;\n                margin-left: ","px;\n                margin-right: ","px;\n                display: flex;\n                flex-direction: column;\n                .row {\n                  overflow: ",";\n                }\n              "],["\n                position: relative;\n                height: 100%;\n                margin-left: ","px;\n                margin-right: ","px;\n                display: flex;\n                flex-direction: column;\n                .row {\n                  overflow: ",";\n                }\n              "])),-h/2,-h/2,i.props.isMultiRow?"auto":"unset")},Object(c.jsx)(c.OneByOneAnimation,{className:Object(c.classNames)("row m-0",{"flex-nowrap":!i.props.isMultiRow,"h-100":n.length>0}),"data-layoutid":r.id},Object(c.jsx)(v.DropArea,{css:H,layouts:i.props.layouts,highlightDragover:!1,onDragEnter:i.handleDragEnter,onDragLeave:i.handleDragLeave,onDragOver:i.handleDragOver,onDrop:i.handleDrop,onToggleDragoverEffect:i.handleToggleDragoverCenterEffect}),n.map((function(t,e){return i.createItem(n,e,u)}))),0===n.length&&i.props.children,Object(c.jsx)("div",{ref:function(t){i.guideColRef=t},css:Object(c.css)(T||(T=X(["\n                  pointer-events: none;\n                  top: 0;\n                  right: 0;\n                  bottom: 0;\n                  left: 0px;\n                  position: absolute;\n                  z-index: 1;\n                  display: ",";\n                "],["\n                  pointer-events: none;\n                  top: 0;\n                  right: 0;\n                  bottom: 0;\n                  left: 0px;\n                  position: absolute;\n                  z-index: 1;\n                  display: ",";\n                "])),f||d?"flex":"none")},[0,1,2,3,4,5,6,7,8,9,10,11].map((function(e){return Object(c.jsx)("div",{key:e,css:Object(c.css)(B||(B=X(["\n                        width: 8.333333%;\n                      "],["\n                        width: 8.333333%;\n                      "])))},Object(c.jsx)("div",{css:Object(c.css)(E||(E=X(["\n                          padding-left: ","px;\n                          padding-right: ","px;\n                          height: 100%;\n                          width: 100%;\n                          overflow: hidden;\n                        "],["\n                          padding-left: ","px;\n                          padding-right: ","px;\n                          height: 100%;\n                          width: 100%;\n                          overflow: hidden;\n                        "])),h/2,h/2)},Object(c.jsx)("div",{css:Object(c.css)(W||(W=X(["\n                            transform: translateY(-5%);\n                            border: 1px dashed ",";\n                            height: 110%;\n                            width: 100%;\n                          "],["\n                            transform: translateY(-5%);\n                            border: 1px dashed ",";\n                            height: 110%;\n                            width: 100%;\n                          "])),c.polished.rgba(t.builderTheme.colors.palette.dark[300],.6))})))}))),Object(c.jsx)("canvas",{css:Object(c.css)(k||(k=X(["\n                      ",";\n                      display: ",";\n                    "],["\n                      ",";\n                      display: ",";\n                    "])),U,f?"block":"none"),ref:function(t){return i.guideDragOverRef=t}}))))}))},e}(c.React.PureComponent),Z=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),q=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},G=function(){return(G=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},J=function(t){function e(e){var n=t.call(this,e)||this;return n.onResize=function(t,e){var i;if(n.browserSizeMode===n.mainSizeMode&&0!==e){var o=n.props.widgetId;null!=(null===(i=window.runtimeInfo.widgets)||void 0===i?void 0:i[o])?window.runtimeInfo.widgets[o].height=e:window.runtimeInfo.widgets[o]={height:e}}},n.handleDebounceResize=c.lodash.debounce(n.onResize,200),n}return Z(e,t),e.prototype.findExtension=function(){var t,e=c.ExtensionManager.getInstance().getExtensions(""+c.extensionSpec.ExtensionPoints.LayoutTransformer);if((null==e?void 0:e.length)>0){var n=e.find((function(t){return"ROW"===t.layoutType}));this.layoutTransform=null===(t=n)||void 0===t?void 0:t.transformLayout}},e.prototype.collectRowItems=function(){var t,e=this.props,n=e.layout,i=e.layouts;null==this.layoutTransform&&this.findExtension();var o=n;i[this.browserSizeMode]!==n.id&&null!=this.layoutTransform&&(o=this.layoutTransform(n,this.mainSizeMode,this.browserSizeMode)),this.finalLayout=o;var r=null!==(t=o.order)&&void 0!==t?t:[],a=[],l=[],s=0;return a.push(l),r.forEach((function(t){if(!o.content[t].isPending){var e=o.content[t].bbox,n=parseInt(e.left,10),i=Math.floor(n/m.b);i>s&&(l=[],s=i,a.push(l)),l.push(t)}})),a},e.prototype.createRow=function(){var t=this.props,e=t.layout,n=t.config,i=t.layouts;return Object(c.jsx)(V,{layouts:i,layout:e,transformedLayout:this.finalLayout,config:n,isMultiRow:this.numOfRows>1},this.props.children)},e.prototype.render=function(){var t,e=this,n=this.props,i=n.layout,o=null!==(t=n.config.style)&&void 0!==t?t:{};return Object(c.jsx)(g.PageContext.Consumer,null,(function(t){e.theme=t.theme,e.browserSizeMode=t.browserSizeMode,e.mainSizeMode=t.mainSizeMode,e.builderTheme=t.builderTheme,e.numOfRows=e.collectRowItems().length;var n=G({},p.styleUtils.toCSSStyle(o));return Object(c.jsx)("div",{className:Object(c.classNames)("layout d-flex",c.classNames),css:Object(c.css)(N||(N=q(["\n            width: 100%;\n          "],["\n            width: 100%;\n          "]))),style:n,"data-layoutid":i.id,ref:function(t){e.ref=t}},e.createRow(),Object(c.jsx)(c.ReactResizeDetector,{handleHeight:!0,onResize:e.handleDebounceResize}))}))},e}(c.React.PureComponent),K=c.ReactRedux.connect(g.utils.mapStateToLayoutProps)(J);e.default={RowLayoutBuilder:K}},5:function(t,e){t.exports=i},51:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return a}));var i=n(0),o=n(1),r=Object(i.Immutable)({space:20,style:{padding:{number:[10],unit:o.UnitTypes.PIXEL}}}),a={heightMode:"fixed",aspectRatio:1,offsetX:0,offsetY:0,style:{alignSelf:"flex-start"}}},8:function(t,e){t.exports=o},80:function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return s}));var i,o=n(0),r=n(25),a=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},l=Object(o.css)(i||(i=a(["\n  width: 100%;\n  display: flex;\n  justify-content: center;\n\n  .offset-1 {\n    margin-left: 8.33333%;\n    margin-right: 0;\n  }\n  .offset-2 {\n    margin-left: 16.66667%;\n    margin-right: 0;\n  }\n  .offset-3 {\n    margin-left: 25%;\n    margin-right: 0;\n  }\n  .offset-4 {\n    margin-left: 33.33333%;\n    margin-right: 0;\n  }\n  .offset-5 {\n    margin-left: 41.66667%;\n    margin-right: 0;\n  }\n  .offset-6 {\n    margin-left: 50%;\n    margin-right: 0;\n  }\n  .offset-7 {\n    margin-left: 58.33333%;\n    margin-right: 0;\n  }\n  .offset-8 {\n    margin-left: 66.66667%;\n    margin-right: 0;\n  }\n  .offset-9 {\n    margin-left: 75%;\n    margin-right: 0;\n  }\n  .offset-10 {\n    margin-left: 83.33333%;\n    margin-right: 0;\n  }\n  .offset-11 {\n    margin-left: 91.66667%;\n    margin-right: 0;\n  }\n"],["\n  width: 100%;\n  display: flex;\n  justify-content: center;\n\n  .offset-1 {\n    margin-left: 8.33333%;\n    margin-right: 0;\n  }\n  .offset-2 {\n    margin-left: 16.66667%;\n    margin-right: 0;\n  }\n  .offset-3 {\n    margin-left: 25%;\n    margin-right: 0;\n  }\n  .offset-4 {\n    margin-left: 33.33333%;\n    margin-right: 0;\n  }\n  .offset-5 {\n    margin-left: 41.66667%;\n    margin-right: 0;\n  }\n  .offset-6 {\n    margin-left: 50%;\n    margin-right: 0;\n  }\n  .offset-7 {\n    margin-left: 58.33333%;\n    margin-right: 0;\n  }\n  .offset-8 {\n    margin-left: 66.66667%;\n    margin-right: 0;\n  }\n  .offset-9 {\n    margin-left: 75%;\n    margin-right: 0;\n  }\n  .offset-10 {\n    margin-left: 83.33333%;\n    margin-right: 0;\n  }\n  .offset-11 {\n    margin-left: 91.66667%;\n    margin-right: 0;\n  }\n"])));function s(t){return Object(o.Immutable)(t).set("left",r.b-parseInt(t.left,10)-parseInt(t.width,10))}}}))}}}));