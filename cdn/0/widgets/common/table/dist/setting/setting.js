System.register(["jimu-core","jimu-ui","jimu-ui/advanced/setting-components","jimu-for-builder","jimu-ui/advanced/data-source-selector","jimu-core/react"],(function(e){var i,t,a,n,o,s;return{setters:[function(e){i=e},function(e){t=e},function(e){a=e},function(e){n=e},function(e){o=e},function(e){s=e}],execute:function(){e(function(e){var i={};function t(a){if(i[a])return i[a].exports;var n=i[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=e,t.c=i,t.d=function(e,i,a){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:a})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(1&i&&(e=t(e)),8&i)return e;if(4&i&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var n in e)t.d(a,n,function(i){return e[i]}.bind(null,n));return a},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},t.p="",t(t.s=493)}({0:function(e,t){e.exports=i},1:function(e,i){e.exports=t},12:function(e,i){e.exports=o},18:function(e,i){e.exports=s},2:function(e,i){e.exports=a},390:function(e,i){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA5IiBoZWlnaHQ9IjcwIiB2aWV3Qm94PSIwIDAgMTA5IDcwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KPHJlY3QgeD0iOCIgeT0iOCIgd2lkdGg9IjkzIiBoZWlnaHQ9IjU0IiByeD0iMiIgZmlsbD0iIzI4MjgyOCIvPg0KPHJlY3QgeD0iMzIiIHk9IjI0IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iMzIiIHk9IjMyIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMzIiIHk9IjM5IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMzIiIHk9IjQ2IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMzIiIHk9IjUzIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjI0IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iMTIiIHk9IjMyIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjM5IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjQ2IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjUzIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjE5IiB3aWR0aD0iODUiIGhlaWdodD0iMSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjE5IiB3aWR0aD0iMTYiIGhlaWdodD0iMSIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMTIiIHk9IjEzIiB3aWR0aD0iMTYiIGhlaWdodD0iNiIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMzAiIHk9IjEzIiB3aWR0aD0iMTYiIGhlaWdodD0iNiIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNDgiIHk9IjEzIiB3aWR0aD0iMTYiIGhlaWdodD0iNiIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjI0IiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iNTIiIHk9IjMyIiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjM5IiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjQ2IiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjUzIiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjI0IiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iNzMiIHk9IjMyIiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjM5IiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjQ2IiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjUzIiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPC9zdmc+DQo="},391:function(e,i){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA5IiBoZWlnaHQ9IjcwIiB2aWV3Qm94PSIwIDAgMTA5IDcwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KPHJlY3QgeD0iOCIgeT0iOCIgd2lkdGg9IjkzIiBoZWlnaHQ9IjU0IiByeD0iMiIgZmlsbD0iIzI4MjgyOCIvPg0KPHJlY3QgeD0iMzIiIHk9IjI0IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iMzIiIHk9IjMyIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMzIiIHk9IjM5IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMzIiIHk9IjQ2IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMzIiIHk9IjUzIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjI0IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iMTIiIHk9IjMyIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjM5IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjQ2IiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjUzIiB3aWR0aD0iMTYiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjEyIiB3aWR0aD0iMzgiIGhlaWdodD0iOCIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMTQiIHk9IjE0IiB3aWR0aD0iMjgiIGhlaWdodD0iNCIgZmlsbD0iIzE4MTgxOCIvPg0KPHBhdGggZD0iTTQ0IDE1SDQ4TDQ2IDE3TDQ0IDE1WiIgZmlsbD0iIzE4MTgxOCIvPg0KPHJlY3QgeD0iNTIiIHk9IjI0IiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iNTIiIHk9IjMyIiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjM5IiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjQ2IiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNTIiIHk9IjUzIiB3aWR0aD0iMTciIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjI0IiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzUyNTI1MiIvPg0KPHJlY3QgeD0iNzMiIHk9IjMyIiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjM5IiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjQ2IiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iNzMiIHk9IjUzIiB3aWR0aD0iMjQiIGhlaWdodD0iNSIgZmlsbD0iIzM2MzYzNiIvPg0KPC9zdmc+DQo="},41:function(e,i,t){"use strict";var a,n;t.d(i,"b",(function(){return a})),t.d(i,"a",(function(){return n})),function(e){e.Dropdown="DROPDOWN",e.Tabs="TABS"}(a||(a={})),function(e){e.Single="SINGLE",e.Multiple="MULTIPLE"}(n||(n={}))},493:function(e,i,t){"use strict";t.r(i);var a,n,o,s=t(0),l=t(1),r=t(2),c=t(12),d=t(41),I={newSheet:"New sheet",sheetStyle:"Arrangement style",layerConfig:"Sheet configuration",enableAttachements:"Show attachments",enableSearch:"Search",searchFields:"Select searching fields",countSelected:"{selectedCount} items selected",fullMatch:"Exact match",allowCsv:"Allow exporting to CSV",enableSelect:"Select records",enableEdit:"Allow editing",enableRefresh:"Refresh",configFields:"Configure fields",dropdown:"Dropdown",configTips:"Select fields for initial display",selectMode:"Select mode",tableBlankStatus:'Click the "{SheetString}" button to add and configure data sheets.'},g=t(18),p=(a=function(e,i){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=i[t])})(e,i)},function(e,i){function t(){this.constructor=e}a(e,i),e.prototype=null===i?Object.create(i):(t.prototype=i.prototype,new t)}),u=function(e,i){return Object.defineProperty?Object.defineProperty(e,"raw",{value:i}):e.raw=i,e},h=s.CONSTANTS.OUTPUT_DATA_VIEW_ID,b=function(e){function i(i){var t=e.call(this,i)||this;return t.supportedDsTypes=Object(s.Immutable)([c.AllDataSourceTypes.FeatureLayer]),t.nameChange=function(e){if(e&&e.target&&e.target.value){var i=e.target.value.trim();t.props.optionChange("name",i)}},t.handleCheckboxChange=function(e){var i=e.currentTarget;i&&t.props.optionChange(i.dataset.field,i.checked)},t.formatMessage=function(e,i){var a=Object.assign({},I,l.defaultMessages);return t.props.intl.formatMessage({id:e,defaultMessage:a[e]},i)},t.displaySelectedFields=function(e){return t.formatMessage("countSelected",{selectedCount:e.length})},t.onFieldChange=function(e){0!==e.length&&t.props.optionChange("tableFields",e)},t.onDataSourceCreated=function(e){t.setState({dataSource:e})},t.getSearchingFields=function(e){var i=t.state.dataSource;if(i){var a=i.getSchema();if(a&&a.fields){var n=[];return Object.keys(a.fields).forEach((function(i){var t=a.fields[i];e?t.type==s.JimuFieldType.String&&n.push({value:i,label:a.fields[i].alias||a.fields[i].name}):n.push({value:i,label:a.fields[i].alias||a.fields[i].name})})),n}}return[]},t.handleChooseSearchingFieldsChange=function(e,i,a){t.props.optionChange("searchFields",a.join(","))},t.getSelectModeOptions=function(){return[Object(s.jsx)("option",{key:d.a.Single,value:d.a.Single},t.formatMessage("single")),Object(s.jsx)("option",{key:d.a.Multiple,value:d.a.Multiple},t.formatMessage("multiple"))]},t.state={dataSource:void 0},t}return p(i,e),i.prototype.getStyle=function(e){return Object(s.css)(n||(n=u(["\n      .layer-config-panel {\n        .panel-inner {\n          .title {\n            max-width: 70%;\n          }\n        }\n        .setting-container {\n          height: calc(100% - ",");\n          overflow: auto;\n          .table-options {\n            .table-options-item {\n              display: flex;\n              justify-content: space-between;\n              margin-bottom: 8px;\n            }\n            .select-option {\n              margin-bottom: 8px;\n            }\n          }\n          .ds-container {\n            position: absolute;\n            display: none;\n          }\n          .component-field-selector {\n            .search-input {\n              width: 100%;\n            }\n            .field-list {\n              max-height: 300px;\n            }\n          }\n          .config-word-break {\n            word-break: break-all;\n          }\n        }\n      }\n    "],["\n      .layer-config-panel {\n        .panel-inner {\n          .title {\n            max-width: 70%;\n          }\n        }\n        .setting-container {\n          height: calc(100% - ",");\n          overflow: auto;\n          .table-options {\n            .table-options-item {\n              display: flex;\n              justify-content: space-between;\n              margin-bottom: 8px;\n            }\n            .select-option {\n              margin-bottom: 8px;\n            }\n          }\n          .ds-container {\n            position: absolute;\n            display: none;\n          }\n          .component-field-selector {\n            .search-input {\n              width: 100%;\n            }\n            .field-list {\n              max-height: 300px;\n            }\n          }\n          .config-word-break {\n            word-break: break-all;\n          }\n        }\n      }\n    "])),s.polished.rem(58))},i.prototype.render=function(){var e=this,i=this.props,t=i.useDataSource,a=i.optionChange,n=i.theme,o=i.tableFields,I=i.searchFields,p=this.state.dataSource,u=p&&p.getLayerDefinition(),b=[];o&&o.length>0&&o.map((function(e){b.push(e.jimuName)}));var m=null==u?void 0:u.capabilities,f=!1;m&&(f=Array.isArray(m)?m.join().toLowerCase().includes("editing"):null==u?void 0:u.capabilities.toLowerCase().includes("editing"));var j=(null==p?void 0:p.url)&&(null==p?void 0:p.dataViewId)!==h&&f;return Object(s.jsx)("div",{className:"w-100 h-100",css:this.getStyle(n)},Object(s.jsx)("div",{className:"w-100 h-100 layer-config-panel"},Object(s.jsx)("div",{className:"w-100 jimu-widget-setting--header d-flex px-3 py-0"},Object(s.jsx)(l.PanelHeader,{level:1,className:"py-3 panel-inner",showClose:!!this.props.onClose,onClose:this.props.onClose,title:this.formatMessage("layerConfig")})),Object(s.jsx)("div",{className:"setting-container"},Object(s.jsx)(r.SettingSection,{title:this.formatMessage("data"),className:"pt-0"},Object(s.jsx)(r.SettingRow,null,Object(s.jsx)(c.DataSourceSelector,{types:this.supportedDsTypes,disableRemove:function(){return!0},useDataSources:t?Object(s.Immutable)([t]):Object(s.Immutable)([]),mustUseDataSource:!0,onChange:this.props.dataSourceChange,closeDataSourceListOnChange:!0}))),t&&Object(s.jsx)(s.React.Fragment,null,Object(s.jsx)(r.SettingSection,{title:this.formatMessage("label")},Object(s.jsx)(r.SettingRow,null,Object(s.jsx)(l.TextInput,{type:"text",className:"w-100",value:this.props.name?this.props.name:"",onChange:this.nameChange}))),Object(s.jsx)(r.SettingSection,{title:this.formatMessage("configFields")},Object(s.jsx)(r.SettingRow,null,this.formatMessage("configTips")),Object(s.jsx)(r.SettingRow,null,Object(s.jsx)(c.FieldSelector,{useDataSources:t?Object(s.Immutable)([t]):Object(s.Immutable)([]),onChange:this.onFieldChange,selectedFields:Object(s.Immutable)(b),isMultiple:!0,isSearchInputHidden:!1,isDataSourceDropDownHidden:!0})),j&&Object(s.jsx)(r.SettingRow,null,Object(s.jsx)("div",{className:"d-flex w-100"},Object(s.jsx)(l.Checkbox,{"data-field":"enableEdit",onClick:this.handleCheckboxChange,checked:this.props.enableEdit}),Object(s.jsx)("div",{className:"ml-2",title:this.formatMessage("enableEdit")},this.formatMessage("enableEdit"))))),Object(s.jsx)(r.SettingSection,{title:this.formatMessage("tools")},Object(s.jsx)("div",{className:"w-100 table-options"},Object(s.jsx)("div",{className:"table-options-item",key:"enableSearch"},Object(s.jsx)("span",{className:"text-break",style:{width:"80%"}},this.formatMessage("enableSearch")),Object(s.jsx)(l.Switch,{className:"can-x-switch",checked:this.props.enableSearch||!1,onChange:function(e){a("enableSearch",e.target.checked)}}))),Object(s.jsx)("div",{className:"ds-container"},Object(s.jsx)(s.DataSourceComponent,{useDataSource:Object(s.Immutable)(t),onDataSourceCreated:this.onDataSourceCreated})),this.props.enableSearch&&Object(s.jsx)(r.SettingRow,{flow:"wrap",label:this.formatMessage("searchFields")},Object(s.jsx)("div",{className:"d-flex w-100 search-container",style:{zIndex:3}},Object(s.jsx)(l.MultiSelect,{items:Object(s.Immutable)(this.getSearchingFields(!0)),values:I?Object(s.Immutable)(I.split(",")):Object(s.Immutable)([]),className:"search-multi-select",fluid:!0,onClickItem:this.handleChooseSearchingFieldsChange,displayByValues:this.displaySelectedFields})),Object(s.jsx)("div",{className:"d-flex w-100",style:{marginTop:"10px"}},Object(s.jsx)(l.Checkbox,{"data-field":"searchExact",onClick:this.handleCheckboxChange,checked:this.props.searchExact}),Object(s.jsx)("div",{className:"ml-2 config-word-break",title:this.formatMessage("fullMatch")},this.formatMessage("fullMatch")))),Object(s.jsx)(r.SettingRow,null,Object(s.jsx)("div",{className:"w-100 table-options"},["enableSelect","enableRefresh"].map((function(i,t){return Object(s.jsx)(g.Fragment,{key:t},Object(s.jsx)("div",{className:"table-options-item"},Object(s.jsx)("span",{className:"text-break",style:{width:"80%"}},e.formatMessage(i)),Object(s.jsx)(l.Switch,{className:"can-x-switch",checked:e.props[i]||!1,onChange:function(e){a(i,e.target.checked)}})),"enableSelect"===i&&e.props[i]&&Object(s.jsx)(r.SettingRow,{flow:"wrap",label:e.formatMessage("selectMode"),className:"select-option"},Object(s.jsx)(l.Select,{value:e.props.selectMode||d.a.Multiple,onChange:function(e){a("selectMode",e.target.value)}},e.getSelectModeOptions())))})))))))))},i}(s.React.PureComponent),m=t(8),f=function(){var e=function(i,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=i[t])})(i,t)};return function(i,t){function a(){this.constructor=i}e(i,t),i.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}(),j=function(e,i){return Object.defineProperty?Object.defineProperty(e,"raw",{value:i}):e.raw=i,e},D=function(){return(D=Object.assign||function(e){for(var i,t=1,a=arguments.length;t<a;t++)for(var n in i=arguments[t])Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);return e}).apply(this,arguments)},M=t(55),S=t(65),v=function(e){function i(i){var t=e.call(this,i)||this;return t.updateDsHash=function(e){t.dsHash={};var i=0;e.map((function(e){t.dsHash[i]=e.useDataSource,i++}))},t.getNewConfigId=function(e){var i;return e+"-"+(((null===(i=t.props.config)||void 0===i?void 0:i.layersConfig.length)>0?t.getArrayMaxId(t.props.config.layersConfig):0)+1)},t.dataSourceChangeSave=function(e){if(e){var i=Object(s.Immutable)(e[0]),a=t.dsManager.getDataSource(i.dataSourceId),n=a&&a.getSchema(),o=["CreationDate","Creator","EditDate","Editor","GlobalID"],l=(null==n?void 0:n.fields)?Object.values(null==n?void 0:n.fields):[],r=l.filter((function(e){return!o.includes(e.jimuName)}));(null==r?void 0:r.length)>50&&(r=r.slice(0,50)),t.dsManager.createDataSourceByUseDataSource(Object(s.Immutable)(e[0])).then((function(e){var a,n={id:t.getNewConfigId(e.id),name:e.getLabel(),useDataSource:i,allFields:l,tableFields:r,enableAttachements:!1,enableEdit:!1,allowCsv:!1,enableSearch:!1,searchFields:"",enableRefresh:!0,enableSelect:!0,selectMode:d.a.Single};if(t.props.config.layersConfig[t.index]){var o=t.props.config.layersConfig.asMutable({deep:!0});o.splice(t.index,1,n),a=Object(s.Immutable)(o)}else a=t.props.config.layersConfig.concat([Object(s.Immutable)(n)]);t.dsHash[t.index]=i,t.updateDsHash(a);var c={id:t.props.id,config:t.props.config.set("layersConfig",a),useDataSources:t.getUseDataSourcesByDsHash()};t.props.onSettingChange(c)}))}},t.onCloseLayerPanel=function(){t.setState({showLayerPanel:!1}),t.index=0},t.getUniqueValues=function(e,i){return void 0===e&&(e=[]),void 0===i&&(i=[]),e.concat(i).filter((function(e,i,t){return t.indexOf(e)===i}))},t.getUseDataSourcesByDsHash=function(){var e={};Object.keys(t.dsHash).map((function(i){var a,n=t.dsHash[i].dataSourceId;a=e[n]?Object(s.Immutable)({dataSourceId:t.dsHash[i].dataSourceId,mainDataSourceId:t.dsHash[i].mainDataSourceId,dataViewId:t.dsHash[i].dataViewId,rootDataSourceId:t.dsHash[i].rootDataSourceId,fields:t.getUniqueValues(e[n].fields,t.dsHash[i].fields)}):t.dsHash[i],e[n]=a}));var i=[];return Object.keys(e).map((function(t){i.push(e[t])})),i},t.removeLayer=function(e){t.index===e&&t.onCloseLayerPanel();var i=t.props.config.layersConfig.asMutable({deep:!0});i.splice(e,1);var a=t.props.config.set("layersConfig",i);delete t.dsHash[e],t.updateDsHash(i);var n={id:t.props.id,config:a,useDataSources:t.getUseDataSourcesByDsHash()};t.props.onSettingChange(n),t.index>e&&t.index--,m.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:t.props.id,propKey:"removeLayerFlag",value:!0})},t.optionChangeSave=function(e,i){if(t.props.config.layersConfig[t.index]){var a=t.props.config.layersConfig.asMutable({deep:!0}),n=Object(s.Immutable)(a[t.index]).set(e,i);a.splice(t.index,1,n.asMutable({deep:!0}));var o={id:t.props.id,config:t.props.config.set("layersConfig",a)};t.props.onSettingChange(o)}m.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:t.props.id,propKey:"removeLayerFlag",value:!0})},t.getStyle=function(e){return Object(s.css)(o||(o=j(["\n      .widget-setting-table {\n        .filter-item {\n          display: flex;\n          padding: 0.5rem 0.75rem;\n          margin-bottom: 0.25rem;\n          line-height: 23px;\n          cursor: pointer;\n          background-color: ",";\n\n          .filter-item-icon {\n            width: 14px;\n            margin-right: 0.5rem;\n          }\n          .filter-item-name {\n            word-break: break-all;\n          }\n        }\n\n        .filter-item-active {\n          border-left: 2px solid ",";\n        }\n\n        .arrange-style-container {\n          .arrange_container {\n            margin-top: 10px;\n            display: flex;\n            .jimu-btn {\n              padding: 0;\n              background: ",";\n              &.active {\n                border: 2px solid ",";\n              }\n            }\n          }\n        }\n        .table-blank-placeholder {\n          .placeholder-icon {\n            color: ",";\n          }\n          & > div {\n            top: 50%;\n            transform: translateY(-50%);\n            padding: 1rem;\n          }\n          p {\n            font-size: ",";\n            margin-top: ",";\n            line-height: ",";\n            color: ",";\n          }\n        }\n      }\n    "],["\n      .widget-setting-table {\n        .filter-item {\n          display: flex;\n          padding: 0.5rem 0.75rem;\n          margin-bottom: 0.25rem;\n          line-height: 23px;\n          cursor: pointer;\n          background-color: ",";\n\n          .filter-item-icon {\n            width: 14px;\n            margin-right: 0.5rem;\n          }\n          .filter-item-name {\n            word-break: break-all;\n          }\n        }\n\n        .filter-item-active {\n          border-left: 2px solid ",";\n        }\n\n        .arrange-style-container {\n          .arrange_container {\n            margin-top: 10px;\n            display: flex;\n            .jimu-btn {\n              padding: 0;\n              background: ",";\n              &.active {\n                border: 2px solid ",";\n              }\n            }\n          }\n        }\n        .table-blank-placeholder {\n          .placeholder-icon {\n            color: ",";\n          }\n          & > div {\n            top: 50%;\n            transform: translateY(-50%);\n            padding: 1rem;\n          }\n          p {\n            font-size: ",";\n            margin-top: ",";\n            line-height: ",";\n            color: ",";\n          }\n        }\n      }\n    "])),e.colors.secondary,e.colors.palette.primary[600],e.colors.palette.light[200],e.colors.palette.primary[600],e.colors.palette.dark[200],s.polished.rem(14),s.polished.rem(16),s.polished.rem(19),e.colors.palette.dark[500])},t.formatMessage=function(e,i){var a=Object.assign({},I,l.defaultMessages);return t.props.intl.formatMessage({id:e,defaultMessage:a[e]},i)},t.onShowLayerPanel=function(e){var i=t.state.showLayerPanel;e===t.index?t.setState({showLayerPanel:!i}):(t.setState({showLayerPanel:!0,refreshPanel:!t.state.refreshPanel}),t.index=e)},t.switchTableType=function(e){if(e!==t.props.config.arrangeType){var i={id:t.props.id,config:t.props.config.set("arrangeType",e)};t.props.onSettingChange(i)}},t.index=0,t.dsManager=s.DataSourceManager.getInstance(),t.updateDsHash(t.props.config.layersConfig?t.props.config.layersConfig:[]),t.state={showLayerPanel:!1,refreshPanel:!1},t}return f(i,e),i.prototype.getArrayMaxId=function(e){var i=e.map((function(e){return e.id.split("-").reverse()[0]}));return i.length>0?Math.max.apply(null,i):0},i.prototype.render=function(){var e=this,i=this.state.showLayerPanel,a=this.props,n=a.theme,o=a.config,c=this.formatMessage("newSheet");return Object(s.jsx)("div",{css:this.getStyle(n)},Object(s.jsx)("div",{className:"widget-setting-table"},Object(s.jsx)(r.SettingSection,{className:"border-0"},Object(s.jsx)(r.SettingRow,null,Object(s.jsx)(l.Button,{className:"w-100 text-dark set-link-btn",type:"primary",onClick:function(){e.onShowLayerPanel(o.layersConfig.length)}},Object(s.jsx)("div",{className:"w-100 px-2 text-truncate"},c)))),0!==o.layersConfig.length&&Object(s.jsx)(r.SettingSection,{className:"pt-0"},Object(s.jsx)("div",{className:"filter-items-container mt-2"},o.layersConfig.asMutable().map((function(t,a){return Object(s.jsx)("div",{key:a,className:Object(s.classNames)("filter-item",i&&e.index===a?"filter-item-active":"")},Object(s.jsx)("div",{className:"filter-item-name flex-grow-1",onClick:function(){e.onShowLayerPanel(a)}},t.name),Object(s.jsx)(l.Button,{size:"sm",icon:!0,type:"tertiary",onClick:function(){return e.removeLayer(a)}},Object(s.jsx)(l.Icon,{icon:M,size:12})))})),o.layersConfig.length===this.index&&i?Object(s.jsx)("div",{className:"d-flex pt-2 pb-2 mb-1 filter-item filter-item-active"},Object(s.jsx)("div",{className:"filter-item-name flex-grow-1"},"......")):null)),0==o.layersConfig.length&&Object(s.jsx)("div",{className:"w-100 text-center table-blank-placeholder"},Object(s.jsx)("div",{className:"position-absolute"},Object(s.jsx)(l.Icon,{size:48,icon:S,className:"placeholder-icon"}),Object(s.jsx)("p",null,this.formatMessage("tableBlankStatus",{SheetString:c})))),o.layersConfig.length>0&&Object(s.jsx)(r.SettingSection,{className:"arrange-style-container",title:this.formatMessage("sheetStyle")},Object(s.jsx)(r.SettingRow,{className:"arrange_container"},Object(s.jsx)(l.Tooltip,{title:this.formatMessage("tabs"),placement:"bottom"},Object(s.jsx)(l.Button,{onClick:function(){return e.switchTableType(d.b.Tabs)},icon:!0,size:"sm",type:"tertiary",active:o.arrangeType===d.b.Tabs},Object(s.jsx)(l.Icon,{autoFlip:!0,width:109,height:70,icon:t(390)}))),Object(s.jsx)(l.Tooltip,{title:this.formatMessage("dropdown"),placement:"bottom"},Object(s.jsx)(l.Button,{onClick:function(){return e.switchTableType(d.b.Dropdown)},className:"ml-2",icon:!0,size:"sm",type:"tertiary",active:o.arrangeType===d.b.Dropdown},Object(s.jsx)(l.Icon,{autoFlip:!0,width:109,height:70,icon:t(391)}))))),Object(s.jsx)(r.SidePopper,{isOpen:i&&!s.urlUtils.getAppIdPageIdFromUrl().pageId,position:"right"},Object(s.jsx)(b,D({},o.layersConfig.asMutable({deep:!0})[this.index],{intl:this.props.intl,theme:n,useDataSource:this.dsHash[this.index]?this.dsHash[this.index]:null,dataSourceChange:this.dataSourceChangeSave,optionChange:this.optionChangeSave,onClose:this.onCloseLayerPanel})))))},i.mapExtraStateProps=function(e,i){var t,a;return{dsJsons:e.appStateInBuilder.appConfig.dataSources,activeTabId:e&&(null===(a=null===(t=e.appStateInBuilder)||void 0===t?void 0:t.widgetsState[i.id])||void 0===a?void 0:a.activeTabId)}},i}(s.React.PureComponent);i.default=v},55:function(e,i){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19.637 15.866L30.951 27.18a2.667 2.667 0 01-3.771 3.771L15.866 19.637 4.552 30.951A2.667 2.667 0 01.781 27.18l11.314-11.314L.781 4.552A2.667 2.667 0 014.552.781l11.314 11.314L27.18.781a2.667 2.667 0 013.771 3.771L19.637 15.866z"></path></svg>'},65:function(e,i){e.exports='<svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M35.477 22.045c-.53-.142-.844-.686-.74-1.226.653-3.414.13-7.07-1.744-10.316-4.142-7.175-13.316-9.633-20.49-5.49-7.175 4.142-9.633 13.315-5.49 20.49a14.944 14.944 0 008.24 6.728c.526.176.848.723.704 1.258-.142.531-.688.85-1.21.681a16.938 16.938 0 01-9.467-7.667C.586 18.372 3.372 7.975 11.503 3.28c8.13-4.694 18.528-1.908 23.222 6.223a16.936 16.936 0 011.95 11.823c-.108.543-.662.863-1.198.72zm-5.8-1.554c-.529-.142-.84-.683-.763-1.225a8.961 8.961 0 00-1.117-5.763 9 9 0 10-10.989 12.914c.52.197.845.743.701 1.28-.142.53-.686.85-1.202.667a10.957 10.957 0 01-5.83-4.861c-3.038-5.261-1.235-11.989 4.026-15.026 5.261-3.038 11.988-1.235 15.026 4.026a10.954 10.954 0 011.332 7.262c-.09.55-.646.87-1.183.726zM43.78 35.583l-12.512 1.648-7.682 10.011c-.564.736-1.738.375-1.792-.55L20.24 19.918a1 1 0 011.548-.893l22.41 14.731c.774.51.5 1.706-.42 1.827zm-14.099.43l-6.046 7.88-1.282-22.104 18.501 12.162-9.847 1.297a2 2 0 00-1.326.765z" fill="#000"></path></svg>'},8:function(e,i){e.exports=n}}))}}}));